<!DOCTYPE html><html lang="ja"><head><title>Posts | サイボウズ フロントエンドエキスパートチーム</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><link rel="icon" type="image/png" sizes="32x32" href="/frontend-expert/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/frontend-expert/icons/favicon-16x16.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Posts | サイボウズ フロントエンドエキスパートチーム"/><meta name="twitter:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta name="twitter:image " content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><meta property="og:type" content="article"/><meta property="og:title" content="Posts | サイボウズ フロントエンドエキスパートチーム"/><meta property="og:site_name" content="サイボウズ フロントエンドエキスパートチーム"/><meta property="og:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta property="og:image" content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/frontend-expert/feeds/atom.xml"/><meta name="next-head-count" content="16"/><link rel="preload" href="/frontend-expert/_next/static/css/76ea63cd4865a048.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/76ea63cd4865a048.css" data-n-g=""/><link rel="preload" href="/frontend-expert/_next/static/css/7d6521f8c702ac2b.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/7d6521f8c702ac2b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend-expert/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/frontend-expert/_next/static/chunks/webpack-729603c643508a46.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/framework-46c1838cec3c6950.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/main-d8805e7f2054e339.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/_app-ab65071b83dd12b3.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/247-11af9d0831f37191.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/posts-3dce8815d7c16508.js" defer=""></script><script src="/frontend-expert/_next/static/EaewsNgYRXzvpGat1fleA/_buildManifest.js" defer=""></script><script src="/frontend-expert/_next/static/EaewsNgYRXzvpGat1fleA/_ssgManifest.js" defer=""></script><script src="/frontend-expert/_next/static/EaewsNgYRXzvpGat1fleA/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_layout__3Ma1v"><header class="Header_header__91Nua"><div class="Header_content__JIbnm"><h1><a href="/frontend-expert"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9Ijc4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="Frontend Expert Team Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Frontend Expert Team Logo" src="/frontend-expert/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></h1><nav class="Header_navigation__2pqVF"><ul><li><a href="/frontend-expert/members">Members</a></li><li><a href="/frontend-expert/posts">Posts</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/list/front_end_expert.html" target="_blank" rel="noopener noreferrer">Recruiting</a></li></ul></nav></div></header><main class="Layout_main__3t9q9"><div class="Layout_content__2clJn"><div class="PageLayout_pageLayout__1NUaZ"><h2>Posts</h2><div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/css-cascade-layers">2022-03-22 主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-chrome-99">2022-03-18 CSS Cascasde Layersの追加など、Chrome 99 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/tc39-meeting-2022-01">2022-03-09 ECMAScriptの最新動向 2022年01月版</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-chrome-98">2022-02-18 COLRv1 fontのサポートなど、Chrome 98 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/considerations-for-monorepo">2022-01-31 フロントエンドのモノレポ構成はスケーリングの夢を見るか</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/tc39-meeting-2021-12">2022-01-24 ECMAScriptの最新動向 2021年12月版</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-chrome-97">2022-01-21 Web Transportのサポートなど、Chrome 97 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-firefox-96">2022-01-20 CSS color-scheme サポート追加等 Firefox 96.0 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/turborepo">2022-01-17 workspaceを使ったコマンドを最適化して実行するTurborepoについて</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-firefox-95">2021-12-20 新しいコードサンドボックス機能 RLBox の追加など Firefox 95.0 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/team-activity-logs-2021">2021-12-18 長期運用プロダクトを抱える組織で横断的なフロントエンド支援チームが1年で行なったこと</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/frontendWeekly-And-Monthly">2021-12-09 Frontend Weekly5周年&amp;Cybozu Frontend Monthly1周年🎉 〜続けてみてのアレコレ〜</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/strings-as-import-export">2021-12-06 なぜ ES2022 で文字列リテラルを使った import/export ができるようになるのか</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-chrome-96">2021-12-02 Chrome 96 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/storybook-interactive-stories">2021-11-29 Interactive storiesを使ってStorybook上でユーザー操作の状態を確認する</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-chrome-95">2021-11-17 Chrome 95 リリースノートまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-safari-15">2021-11-16 Safari 15 の新機能とかまとめ</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/ergonomic-brand-checks-for-private-fields">2021-11-11 ES2022 と TypeScript 4.5 に入るプライベートフィールドのための in 演算子について</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/eyedropper-api">2021-11-02 Chrome 95 で追加された画面上の色を取得するEyeDropper APIについて</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/tc39-meeting-2021-10">2021-11-02 ECMAScriptの最新動向 2021年11月版</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/release-firefox-93">2021-10-21 Firefox 93.0 リリースノート要約</a></div><div class="Posts_postItem__3hs9O"><a href="/frontend-expert/posts/first-post">2021-10-14 サイボウズフロントエンドエキスパートチームのウェブサイトを作りました</a></div></div></div></div></main><footer class="Footer_footer__2epqf"><div class="Footer_content__3ovcH"><ul><li><a href="https://cybozu.co.jp/">サイボウズ 企業情報</a></li><li><a href="https://www.cybozu.com/jp/">cybozu.com</a></li><li><a href="https://blog.cybozu.io/">サイボウズエンジニアのブログ Cybozu Inside Out</a></li><li><a href="https://tech.cybozu.io/">Cybozu Tech</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/">採用情報</a></li></ul><small>Copyright © Cybozu, Inc.</small></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"slug":"css-cascade-layers","content":"\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/\"\u003eChrome99\u003c/a\u003eに新機能として CSS Cascade Layers が実装され、Firefox、Edge、Safari といった主要ブラウザで CSS Cascade Layers が使えるようになりました。\u003c/p\u003e\n\u003ch2\u003eCSS Cascade Layers とは\u003c/h2\u003e\n\u003cp\u003eCSS の仕様において、要素にどのスタイルを適用するかはざっくりと次のような優先順位で決定されていました。(カスケード順を省いて簡略的に記述しています)\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここに CSS Cascade Layers が導入されると次のように変わります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCascade Layers\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e従来の CSS が抱える複雑な詳細度の管理\u003c/h2\u003e\n\u003cp\u003eどのスタイルを適用するか判断するのにセレクターの詳細度を用いる場合は、詳細度がより高いものが適用されます。\u003c/p\u003e\n\u003cp\u003eセレクターの詳細度は、高い順に次のような順番になります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eID セレクター: \u003ccode\u003e#example\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eクラスセレクター: \u003ccode\u003e.example\u003c/code\u003e, 属性セレクター: \u003ccode\u003e[type=\"radio\"]\u003c/code\u003e, 疑似クラス: \u003ccode\u003e:hover\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e要素型セレクター: \u003ccode\u003eh1\u003c/code\u003e, 擬似要素: \u003ccode\u003e::before\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eまた、単純にセレクターの種類だけでなく、セレクターの数も詳細度に影響します。\u003c/p\u003e\n\u003cp\u003e参考: \u003ca href=\"https://specifishity.com/\"\u003ehttps://specifishity.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCSS の記述量が増えていくにつれ、この詳細度をうまく管理できず意図しないスタイルが適用されることがままあります。意図しないスタイルが適用されないために、セレクターの命名規則を厳格にする\u003ca href=\"http://getbem.com/naming/\"\u003eBEM\u003c/a\u003eなどの設計手法を取り入れて対応することもあります。\u003c/p\u003e\n\u003cp\u003eしかし、命名規則をベースとした設計手法では、サードパーティの CSS ライブラリを使用する場合や、コントロールが難しいくらい多い記述量の CSS になってしまった場合、全体の詳細度を把握して管理することはなかなか大変です。\u003c/p\u003e\n\u003ch2\u003eCascade Layers によってどう変わるか\u003c/h2\u003e\n\u003cp\u003eCascade Layers を使うと、セレクターの詳細度よりも優先してスタイルが適用されるレイヤーを定義できるようになります。\u003c/p\u003e\n\u003cp\u003e実際にコードで見てみましょう。\u003c/p\u003e\n\u003ch3\u003e通常の詳細度を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers を使わない場合、同じ詳細度のセレクターは属性値での記述順に関わらず、スタイルシート内で最後に宣言されたスタイルが適用されます。\u003c/p\u003e\n\u003cp\u003e次の場合、\u003ccode\u003e.base\u003c/code\u003e と \u003ccode\u003e.nus3\u003c/code\u003e は同一の詳細度です。また、1 つ目の \u003ccode\u003e.base\u003c/code\u003e は最後に記述されている \u003ccode\u003e.base\u003c/code\u003e によって上書きされます。このボタンには\u003ccode\u003estyle\u003c/code\u003e内で一番最後に記述されている \u003ccode\u003e.base\u003c/code\u003e のスタイルが適用され、背景色が \u003ccode\u003eroyalblue\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eroyalblue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebase nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eroyalblueになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた、セレクターの詳細度は種類によって異なり、要素セレクター \u0026#x3C; クラスセレクター \u0026#x3C; ID セレクター の順に高くなります。\u003c/p\u003e\n\u003cp\u003e次の場合、ID セレクター(\u003ccode\u003e#btn\u003c/code\u003e)のほうがクラスセレクター(\u003ccode\u003e.nus3\u003c/code\u003e) や要素セレクター(\u003ccode\u003ebutton\u003c/code\u003e)よりも詳細度が高いので、\u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecoral\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eblack\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ecrimsonになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eCascade Layers を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers では、まず\u003ccode\u003e@layer\u003c/code\u003e構文を使ってレイヤーを定義します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e`\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e`\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのとき、base、page、utilities の 3 つのレイヤーを定義するとともに、レイヤーの優先順位を定義しています。\u003c/p\u003e\n\u003cp\u003eこの場合、各レイヤーのスタイルは後ろに定義したものほど優先度が高く、次のような優先度でスタイルが適用されます。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eutilities\u003c/li\u003e\n\u003cli\u003epage\u003c/li\u003e\n\u003cli\u003ebase\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここではレイヤーの定義と優先度を同時に定義していますが、この記述を省略した場合、あとに定義したレイヤーの優先度が高くなります。\u003c/p\u003e\n\u003cp\u003eレイヤーの動作についてサンプルコードで詳しく見てみましょう。\u003c/p\u003e\n\u003cp\u003e次のコードは、前述したコードをベースに \u003ccode\u003e@layer\u003c/code\u003e を追加したものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e utilities\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.shiny\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e page\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny base nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e１つ目のボタンはレイヤーがない場合には最後に宣言されている \u003ccode\u003e.nus3\u003c/code\u003e の \u003ccode\u003ewhite\u003c/code\u003e が適用されていましたが、優先度の高い utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e の \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e２つ目のボタンはレイヤーがない場合には ID セレクターの \u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されていましたが、この場合も utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e のほうが優先度が高いため、 \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e次のサンプルページを開いて、DevTools で対象の要素をみると Cascade Layers が適用されているのがわかります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://c1r38o.csb.app/\"\u003eサンプルページ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/css-cascade-layers/devtools.png\" alt=\"DevToolsで確認すると実際にCascade Layersが適用されている\" width=\"337\" height=\"400\" \u003e\u003c/p\u003e\n\u003cp\u003eレイヤーの適用順が utilities \u003e page \u003e base になってるのがわかります。\u003c/p\u003e\n\u003cp\u003eこのように、Cascade Layers を使うことで、詳細度ではなくレイヤーでスタイルをコントロールできるようになります。\u003c/p\u003e\n\u003ch3\u003eCascade Layers 内で\u003ccode\u003e!important\u003c/code\u003eを使った際のスタイルの優先順位\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e!important\u003c/code\u003eを使っていない場合、Cascade Layers で定義したレイヤー外のスタイルが優先して適用されます。\u003c/p\u003e\n\u003cp\u003eこれはカスケード順が、レイヤー内 \u0026#x3C; レイヤー外 の順に高くなっているからです。\u003c/p\u003e\n\u003cp\u003e次のコードでは、レイヤー外のスタイルが適用され、ボタンの背景色が\u003ccode\u003ewhite\u003c/code\u003eになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ewhiteになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、\u003ccode\u003e!important\u003c/code\u003eを使ったスタイルの場合、このカスケード順が変わるので注意が必要です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eCSS フレームワークにも Cascade Layers は使える\u003c/h2\u003e\n\u003cp\u003eBootstrap や Materialize CSS、Bulma といった CSS フレームワークにも Cascade Layers を使ってレイヤーを定義できます。\u003c/p\u003e\n\u003cp\u003eCSS フレームワークの一つである\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eを使って試してみましょう。\u003c/p\u003e\n\u003cp\u003e本来、次のようなクラスをボタンに付与すると、Bulma で元から定義されている\u003ccode\u003e.button.is-primary\u003c/code\u003eが、後に追加した\u003ccode\u003e.button-nus3\u003c/code\u003eより詳細度が高くなり、\u003ccode\u003e.button-nus3\u003c/code\u003eのスタイルは適用されません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebutton is-primary button-nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eボタン\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* styles/page.cssで定義されているスタイル */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.button-nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし次のように Cascade Layers を使い、\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eの CSS を\u003ccode\u003ebase\u003c/code\u003eのレイヤーにしつつ、画面特有のスタイルを\u003ccode\u003estyles/page.css\u003c/code\u003eに定義することで、詳細度の影響を気にすることなく Bulma のスタイルを上書きすることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e対象ブラウザのサポート状況は考慮する必要がありますが、CSS の記述量が増えることが想定されるプロジェクトには、Cascade Layers をベースにした設計を検討してみてはいかがでしょうか。\u003c/p\u003e\n\u003ch2\u003e参考リンクなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.w3.org/TR/css-cascade-5/\"\u003ehttps://www.w3.org/TR/css-cascade-5/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@layer\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/@layer\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/cascade-layers/\"\u003ehttps://developer.chrome.com/blog/cascade-layers/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nus3/p-css-cascade-layers\"\u003eサンプル実装したリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える","author":"nus3","editor":["nakajmg"],"createdAt":"2022-03-22","summary":"CSS Cascade Layersを使ったスタイルの管理方法について紹介します","tags":["CSS"],"updatedAt":"2022-03-22"}},{"slug":"release-chrome-99","content":"\u003cp\u003eChrome 99 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-99/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-99/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-99/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-99/\"\u003ehttps://developer.chrome.com/blog/deps-rems-99/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D99\"\u003ehttps://www.chromestatus.com/features#milestone%3D99\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://v8.dev/blog/v8-release-99\"\u003ehttps://v8.dev/blog/v8-release-99\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 99)\u003c/h2\u003e\n\u003cp\u003eChrome99 で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eChrome 100 and Firefox 100\u003c/h3\u003e\n\u003cp\u003eChrome 100 は今年の 3 月下旬、Firefox100 は 5 月上旬にリリースされます。 これらは両方ともメジャーバージョン番号が 3 桁にロールオーバーするアップデートです。 UserAgent をパースしたバージョン番号を２桁として解釈しているコードがある場合、新しいバージョン番号によって問題が発生する可能性があります。\u003c/p\u003e\n\u003cp\u003eChrome では、\u003ccode\u003e＃force-major-version-to-100\u003c/code\u003e フラグを有効にすることで現在のバージョンを 100 に上書きし、挙動を確認することができます。\u003c/p\u003e\n\u003cp\u003eまた、Firefox Nightly では「設定」メニューで、「Firefox100 ユーザーエージェント文字列」オプションを有効にすることで同様の確認が可能です。 両ブラウザでバージョン番号の解釈が期待どおりに機能することを確認できるように、サイトをテストすることをお勧めします。\u003c/p\u003e\n\u003ch3\u003eCSS Cascasde Layers\u003c/h3\u003e\n\u003cp\u003eCSS Cascade Layers が Chrome99、Firefox 97、Safari 15.4 Beta でサポートされました！\u003c/p\u003e\n\u003cp\u003eCSS セレクタの詳細度を上回るルールを\u003ccode\u003e@layer\u003c/code\u003eで定義することができるようになります。\u003c/p\u003e\n\u003cp\u003e詳細は \u003ca href=\"https://twitter.com/nus3_\"\u003e@nus3\u003c/a\u003e が別途記事を書いたので次のリンクをご参考ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/css-cascade-layers\"\u003ehttps://cybozu.github.io/frontend-expert/posts/css-cascade-layers\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eshowPicker() for input elements\u003c/h3\u003e\n\u003cp\u003eHTML InputElements に新しく\u003ccode\u003eshowPicker（）\u003c/code\u003eメソッドが実装されました。\u003c/p\u003e\n\u003cp\u003eこれにより、日付だけでなく、時間、色、その他の\u003ccode\u003e\u0026#x3C;input\u003e\u003c/code\u003e要素でブラウザーピッカーを表示するための標準的な方法が整備されました。\u003c/p\u003e\n\u003cp\u003e利用する場合は、以下のように\u003ccode\u003e\u0026#x3C;input\u003e\u003c/code\u003e要素で\u003ccode\u003eshowPicker（）\u003c/code\u003eを呼び出します。また\u003ccode\u003etry…catch\u003c/code\u003eブロックでこれらの処理を囲う事で、ブラウザーが\u003ccode\u003eshowPicker()\u003c/code\u003eの API をサポートしていない場合、またはピッカーを表示できない場合のフォールバックを提供できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e button \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dateInput \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"input\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\nbutton\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"click\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    dateInput\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eshowPicker\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Dateピッカーの表示.\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// ピッカーを表示できない場合のフォールバック\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/#:~:text=Show%20a%20browser%20picker%20for%20date%2C%20time%2C%20color%2C%20and%20files\"\u003eShow a browser picker for date, time, color, and files\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eAnd more!\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eCanvasRenderingContext2D\u003c/code\u003eに次の機能が追加されました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eContext がロストした時や復元した時のイベントハンドリングができるように(\u003ccode\u003eContextLost\u003c/code\u003e, \u003ccode\u003eContextRestored\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewillReadFrequently\u003c/code\u003eオプションの追加\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eletter-spacing\u003c/code\u003eなど Canvas でサポートされていなかったテキストを修飾するプロパティの追加\u003c/li\u003e\n\u003cli\u003eCanvas の状態をリセットする\u003ccode\u003ereset()\u003c/code\u003eなど\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePWA のマニフェストにダークテーマに対応する設定が追加できる\u003ca href=\"https://developer.chrome.com/origintrials/#/view_trial/4239013149262479361\"\u003eオリジントライアル\u003c/a\u003eが開始されたました。\u003c/p\u003e\n\u003cp\u003eまた詳細はこの記事の後半に記載しますが、Handwriting Recognition API が使えるようになります。\u003c/p\u003e\n\u003ch2\u003eWhat's New In DevTools (Chrome 98)\u003c/h2\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-99/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-99/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e書いてるうちにでなかったら、気になるものがあれば記載する\u003c/p\u003e\n\u003ch2\u003eDeprecations and removals in Chrome 99\u003c/h2\u003e\n\u003ch3\u003eRemove Battery Status API on insecure origins\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eBattery Status API\u003c/code\u003eは、HTTP ページや HTTP ページに埋め込まれた HTTPS の iframe などの安全でないオリジンでサポートされなくなりました。\u003c/p\u003e\n\u003ch3\u003eRemove font-family -webkit-standard\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003efont-family\u003c/code\u003eの値として\u003ccode\u003e-webkit-standard\u003c/code\u003eが削除されました。\u003c/p\u003e\n\u003ch3\u003eRemove GamepadList\u003c/h3\u003e\n\u003cp\u003e接続しているゲームパッドを取得できる\u003ccode\u003enavigator.getGamepads()\u003c/code\u003eの返り値が\u003ccode\u003eGamepadlList\u003c/code\u003eから\u003ccode\u003eGamepad\u003c/code\u003eのオブジェクトの配列を返すようになりました。\u003c/p\u003e\n\u003cp\u003eこの変更により、Gecko と Webkit と同じく仕様と一致するようになります。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://web.dev/gamepad/\"\u003eChrome でゲームパッドを使う方法\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eUpdate WebCodecs to match the specification\u003c/h3\u003e\n\u003cp\u003eWebCodecs 仕様変更により、仕様に反していた以下の 2 つの部分について修正しました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eEncodeVideoChunkMetadata\u003c/code\u003eオブジェクト内の\u003ccode\u003etemporalLayerId\u003c/code\u003eの場所\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eVideoFrame()\u003c/code\u003e コンストラクタでタイムスタンプ引数を指定しなかった際の挙動変更\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e詳しくは\u003ca href=\"https://chromestatus.com/feature/5667793157488640\"\u003eこちら\u003c/a\u003eを参照してください。\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003ch3\u003eFeature: \"paintworklet\" destination for PaintWorklet\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/Guide/Houdini\"\u003eCSS Houdini\u003c/a\u003eの一部である\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/CSS_Painting_API\"\u003eCSS Painting API\u003c/a\u003eで使われる PaintWorklet のリクエストの送り先が\u003ccode\u003escript\u003c/code\u003eから\u003ccode\u003epaintworklet\u003c/code\u003eになりました。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eSec-Fetch-Dest\u003c/code\u003eHTTP リクエストヘッダと\u003ccode\u003eFetchEvent.request.destination\u003c/code\u003eで適用されます。\u003c/p\u003e\n\u003ch3\u003eFeature: \"audioworklet\" destination for AudioWorklet\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eWeb Audio API\u003c/code\u003eのオーディオ処理を別スレッドで実行する仕組みである、\u003ccode\u003eAudioWorklet\u003c/code\u003eのリクエストの送り先が\u003ccode\u003escript\u003c/code\u003eから\u003ccode\u003eaudioworklet\u003c/code\u003eになりました。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eSec-Fetch-Dest\u003c/code\u003eHTTP リクエストヘッダと\u003ccode\u003eFetchEvent.request.destination\u003c/code\u003eで適用されます。\u003c/p\u003e\n\u003ch3\u003eFeature: Allow infinity, -infinity and NaN in CSS calc()\u003c/h3\u003e\n\u003cp\u003eCSS の\u003ccode\u003ecalc()\u003c/code\u003e関数で\u003ccode\u003einfinity\u003c/code\u003e, \u003ccode\u003e-infinity\u003c/code\u003e, \u003ccode\u003eNaN\u003c/code\u003e などのキーワード、及び\u003ccode\u003ecalc(1/0)\u003c/code\u003e のように\u003ccode\u003einfinity\u003c/code\u003eや\u003ccode\u003eNaN\u003c/code\u003eに評価される式による値を許容するようになりました。\u003c/p\u003e\n\u003ch3\u003eAutofill in ShadowDOM\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eautofill\u003c/code\u003eが\u003ccode\u003eform\u003c/code\u003e 要素内のフォームコントロールを収集する際に、\u003ccode\u003eShadowDOM\u003c/code\u003eも参照するようになります。これにより\u003ccode\u003eShadow DOM\u003c/code\u003e内部の入力フォームでも\u003ccode\u003eautofill\u003c/code\u003eが効くようになります。\u003c/p\u003e\n\u003cp\u003eWeb コンポーネントを採用する際、\u003ccode\u003einput\u003c/code\u003e要素のようなフォームコントロールを\u003ccode\u003eShadowDOM\u003c/code\u003eで包むことが一般的になっていることを受けての改善となります。\u003c/p\u003e\n\u003ch3\u003eConvert adoptedStyleSheets to use ObservableArray\u003c/h3\u003e\n\u003cp\u003edocument や shadowRoot に\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/CSSStyleSheet\"\u003eCSSStyleSheet\u003c/a\u003eを追加できる\u003ccode\u003eadoptedStyleShetts\u003c/code\u003eで ObservableArray が使えるようになります。\u003c/p\u003e\n\u003cp\u003e今回から push などの通常の配列操作ができるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eadoptedStyleSheets\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003eadoptedStyleSheets\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e newSheet\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// これまで\u003c/span\u003e\n\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eadoptedStyleSheets\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enewSheet\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// これから\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eHandwriting Recognition API\u003c/h3\u003e\n\u003cp\u003eOS などにある既存の手書きの文字認識機能を web 上で扱えるようにするための API が追加されました。\u003c/p\u003e\n\u003cp\u003e※現状この API が利用できるのは ChromeOS のみで対応言語も英語に限られています。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/feature/5263213807534080\"\u003eFeature: Handwriting Recognition API\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eUnprefixed text-emphasis properties\u003c/h3\u003e\n\u003cp\u003eCSS の text-emphasis プロパティが\u003ccode\u003e-webkit\u003c/code\u003eなしで使えるようになります。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/text-emphasis\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/text-emphasis\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eV8 release v9.9\u003c/h2\u003e\n\u003ch3\u003eIntl.Locale extensions\u003c/h3\u003e\n\u003cp\u003eIntl.Local オブジェクトに 7 つの新しいプロパティが追加されました。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ecalendars\u003c/code\u003e, \u003ccode\u003ecollations\u003c/code\u003e, \u003ccode\u003ehourCycles\u003c/code\u003e, \u003ccode\u003enumberingSystems\u003c/code\u003e, \u003ccode\u003etimeZones\u003c/code\u003eでは他の Intl API で使用する好ましい識別子を返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e jaLocal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntl\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eLocale\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"ja\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejaLocal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecalendars\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// ['gregory', 'japanese']\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejaLocal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecollations\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// ['unihan', 'emoji', 'eor']\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejaLocal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehourCycles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// ['h23']\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejaLocal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003enumberingSystems\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// ['latn']\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003etextInfo\u003c/code\u003eはテキストに関連する情報をオブジェクトで返します。現状では CSS の direction プロパティで使用するような文字の並び順の値を返します。\n(rtl が右から左へ、ltr が左から右へ)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003earabicEgyptLocale\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etextInfo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// { direction: 'rtl' }\u003c/span\u003e\njapaneseLocale\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etextInfo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// { direction: 'ltr' }\u003c/span\u003e\nchineseTaiwanLocale\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etextInfo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// { direction: 'ltr' }\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eweekInfo\u003c/code\u003eは週に関連する情報を返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e jaLocal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntl\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eLocal\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"ja\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejaLocal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eweekInfo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 返される数字は 1 が月曜日、7 が日曜日\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// {\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e//   firstDay: 7,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e//   weekend: [6, 7],\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e//   minimalDays: 1,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// }\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eIntl Enumeration\u003c/h3\u003e\n\u003cp\u003ev8 でサポートされている識別子の配列を返す\u003ccode\u003eIntl.supportedValuesOf(code)\u003c/code\u003eという新しい関数が追加されました。\nサポートされるコード値は以下の 6 つです。\u003c/p\u003e\n\u003cp\u003ecalendar\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"calendar\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['buddhist', 'chinese', 'coptic', 'dangi', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ecollation\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"collation\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['big5han', 'compat', 'dict', 'emoji', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ecurrency\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"currency\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['ADP', 'AED', 'AFA', 'AFN', 'ALK', 'ALL', 'AMD', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003enumberingSystem\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"numberingSystem\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['adlm', 'ahom', 'arab', 'arabext', 'bali', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003etimeZone\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"timeZone\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['Africa/Abidjan', 'Africa/Accra', 'Africa/Addis_Ababa', 'Africa/Algiers', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eunit\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eIntl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupportedValuesOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"unit\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// ['acre', 'bit', 'byte', 'celsius', 'centimeter', ...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこの新しいメソッドによって、Web 開発者はどの値が実装でサポートされているかを簡単に発見できるようになります。\u003c/p\u003e\n","metaData":{"title":"CSS Cascasde Layersの追加など、Chrome 99 リリースノートまとめ","author":"Saji","editor":"nus3","createdAt":"2022-03-18","summary":"Chrome 99 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2022-03-18"}},{"slug":"tc39-meeting-2022-01","content":"\u003cp\u003eこの記事では2021年01月24日~27日に開催された TC39 meeting 88th で議題に上がったプロポーザルについて紹介します。\u003c/p\u003e\n\u003ch2\u003eFor Stage 4\u003c/h2\u003e\n\u003cp\u003eFor Stage 4 の提案はありませんでした。\u003c/p\u003e\n\u003ch2\u003eFor Stage 3\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eArray.fromAsync\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 3 にはなりませんでした。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eArray.fromAsync\u003c/code\u003e は次のようにして非同期イテラブルから配列を生成するスタティックメソッドを追加するプロポーザルです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003en\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eyield\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e arr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eArray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efromAsync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/issues/19\"\u003ehttps://github.com/tc39/proposal-array-from-async/issues/19\u003c/a\u003e で指摘された問題のため、Stage 3 にはなりませんでした。\u003c/p\u003e\n\u003ch2\u003eFor Stage 2\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-class-brand-check\"\u003eClass brand checks\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 にはなりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eClass brand checks は brand check のための新しい構文を導入するプロポーザルです。\u003c/p\u003e\n\u003cp\u003ebrand check は TC39 内で使われる用語で、\u003ca href=\"https://github.com/tc39/how-we-work/blob/master/terminology.md#brand-check\"\u003ehttps://github.com/tc39/how-we-work/blob/master/terminology.md#brand-check\u003c/a\u003e で説明されています。\u003c/p\u003e\n\u003cp\u003ebrand check とは、雑に言えば「ある値があるデータ型であることを検証すること」です。たとえば \u003ccode\u003eArray.isArray\u003c/code\u003e は brand check です(\u003ca href=\"https://zenn.dev/sosukesuzuki/articles/e0516a3d4c424e\"\u003e\u003ccode\u003einstanceof\u003c/code\u003e は厳密ではない\u003c/a\u003eため brand check ではありません)。\u003c/p\u003e\n\u003cp\u003e以前 brand check の方法の一つである \u003ca href=\"https://github.com/tc39/proposal-private-fields-in-in\"\u003eErgonomic brand checks for private fields\u003c/a\u003e についての記事を書いたので興味のある方はそちらもご覧ください。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.github.io/frontend-expert/posts/ergonomic-brand-checks-for-private-fields\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eClass branc check プロポーザルでは \u003ccode\u003eclass.hasInstance(x)\u003c/code\u003e という新しい Meta Property を追加します。これはクラスの中でのみ使うことができ、引数として渡された値が今いるクラスのインスタンスかどうかをチェックします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehasInstance\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e obj \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eobj\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 1\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/rbuckton/proposal-enum\"\u003eenum\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 にはなりませんでした。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eenum は列挙型を実現するためのプロポーザルです。このプロポーザルは 4 年ほど前から存在していましたがまた動き出したようです。\u003c/p\u003e\n\u003cp\u003eenum プロポーザルでは次のような構文を導入します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eenum\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eSyntaxKind\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eC\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e他のプログラミング言語の enum と構文上は似ています。\u003c/p\u003e\n\u003cp\u003eしかし細部の仕様について検討すべき事項が多く、今回のミーティングでは Stage 1 に到達することはありませんでした。\u003ca href=\"https://docs.google.com/presentation/d/14WtGmdWjEYXIXZVWJWpERF98D90_BytceAu7b7DKr5Q/edit#slide=id.g10effb28f4f_0_273\"\u003eこのスライド\u003c/a\u003eに詳しくまとまっているので興味のある方はご覧ください。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-reversible-string-split\"\u003eReversible string split\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eReversible string split は可逆(Reversible)の文字列分割のための方法を導入するプロポーザルです。\u003c/p\u003e\n\u003cp\u003eJavaScript では \u003ccode\u003eString.prototype.split\u003c/code\u003e を使って文字列を分割できます。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/split\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B', 'C', 'D', 'E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eString.prototype.split\u003c/code\u003e は第2引数として非負の整数を渡すことで、分割する数を制限できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A' ]\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B' ]\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted3 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B', 'C' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eJavaScript 以外のいくつかの言語(Perl、PHP、Ruby、Go、Rust、Java など)では第2引数を受け取った \u003ccode\u003eString.prototype.split\u003c/code\u003e に相当する機能は、次のように文字列の分割を行います。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B,C,D,E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eN-1 回分割され、残りの部分が戻り値の配列の末尾に含まれています(戻り値の配列の要素数が N)。\u003c/p\u003e\n\u003cp\u003eReversible string split プロポーザルでは、このような振る舞いを持つ新しいメソッド \u003ccode\u003eString.prototype.splitN\u003c/code\u003e を導入します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplitN\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B,C,D,E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのような文字列分割メソッドを使うと、次のようにして分割する前の文字列を取得できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e separator \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e n \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplitN\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eseparator\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejoin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eseparator\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e提案の名前に含まれている Reversible というのはこのような可逆性のことを指しているようです。\u003c/p\u003e\n\u003ch2\u003eUpdates\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-symbols-as-weakmap-keys\"\u003eSymbols as WeakMap keys\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSymbols as WeakMap keys は Symbol を WeakMap のキーとして使えるようにするためのプロポーザルです。\u003c/p\u003e\n\u003cp\u003e現在では一部情報が古くなっていますが以前このプロポーザルについて解説する記事を書いたので興味がある方はそちらもご覧ください。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://sosukesuzuki.dev/posts/symbols-as-weakmap-keys\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e以前から Symbols as WeakMap keys プロポーザルのモチベーションや基本的な振る舞いについては概ね合意がとれていました。しかし、Well-knwon Symbols やグローバルシンボルレジストリに登録された Symbol (Eternal Symbol と呼ばれている)についてはどのように扱うべきかという点で TC39 メンバー内でも意見が分かれていました。\u003c/p\u003e\n\u003cp\u003e今回のミーティングで Symbols as WeakMap keys チャンピョングループは、Eternal Symbol を WeakMap のキーとして使おうとするとエラーが throw されるという振る舞いを選択したことを発表しました。それにともなって、\u003ccode\u003eWeakMap.isValidKey(x)\u003c/code\u003e、\u003ccode\u003eWeakSet.isValidValue(x)\u003c/code\u003e、\u003ccode\u003eWeakRef.isValidTarget(x)\u003c/code\u003e、\u003ccode\u003eFinalizationRegistry.isValidTarget(x)\u003c/code\u003e などのいくつかのスタティックメソッドが追加される可能性があります。\u003c/p\u003e\n\u003cp\u003eしかし議事録によればまだ TC39 メンバーの中で意見が分かれているため仕様の決定には時間がかかりそうです。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/agendas/blob/main/2022/01.md\"\u003eagendas/01.md at main · tc39/agendas\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-24.md\"\u003enotes/jan-24.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-25.md\"\u003enotes/jan-25.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-26.md\"\u003enotes/jan-26.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eProposal Array.fromAsync\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-symbols-as-weakmap-keys\"\u003eProposal Symbols as WeakMap keys\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-class-brand-check\"\u003eProposal \u003ccode\u003eclass.hasInstance()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/rbuckton/proposal-enum\"\u003eProposal enum\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-reversible-string-split\"\u003eProposal Reversible string split\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eBabel\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/proposals/issues/80\"\u003eJan 2022 · Issue #80 · babel/proposals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"ECMAScriptの最新動向 2022年01月版","author":"sosukesuzuki","createdAt":"2022-03-09","summary":"2021年01月24日~27日に開催された TC39 meeting 88th の内容を紹介します","tags":["TC39","ECMAScript"],"updatedAt":"2022-03-09"}},{"slug":"release-chrome-98","content":"\u003cp\u003eChrome 98 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-98/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-98/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-98/\"\u003ehttps://developer.chrome.com/blog/deps-rems-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D98\"\u003ehttps://www.chromestatus.com/features#milestone%3D98\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 98)\u003c/h2\u003e\n\u003cp\u003eChrome98 で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eOpting out of auto-dark themes on Android\u003c/h3\u003e\n\u003cp\u003eChrome96 から、Android では OriginTrial として「\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/\"\u003eAuto Dark Themes\u003c/a\u003e」という機能を追加しています。\u003c/p\u003e\n\u003cp\u003eこの機能はユーザーの OS がダークモードである場合、明るいテーマのサイトに対しブラウザが自動的に生成したダークテーマを適用するものです。\u003c/p\u003e\n\u003cp\u003e今回のアップデートでは OriginTrial に登録したサイトのうち、特定のページで自動生成されるダークテーマを無効にする方法が追加されました。\u003c/p\u003e\n\u003cp\u003e具体的には以下のように\u003ccode\u003emeta\u003c/code\u003eタグを利用して無効化することが出来ます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003emeta\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ename\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ecolor-scheme\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003econtent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eonly light\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた以下のように\u003ccode\u003ecolor-scheme: only light\u003c/code\u003eというスタイルを\u003ccode\u003e:root\u003c/code\u003e要素にあてることでも無効化できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token pseudo-class\"\u003e:root\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolor-scheme\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e only light\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCSS スタイルを利用する方法の優れた点として、以下のように要素ごとに自動生成されるダークテーマを無効にできる点が挙げられます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.only-light\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token id\"\u003e#my-element\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolor-scheme\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e only light\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e詳しくは\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/\"\u003eAuto Dark Themes on Android\u003c/a\u003eにおける\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/#per-element-opt-out\"\u003eHow to opt-out of Auto Dark Theme\u003c/a\u003eの章を参照してください。\u003c/p\u003e\n\u003ch3\u003eCOLRv1 font support\u003c/h3\u003e\n\u003cp\u003eCOLRv1 フォントがサポートされました。\u003c/p\u003e\n\u003cp\u003eCOLRv1 では COLRv0 と比べて、新たにフォントのグラデーションや合成などに対応しています。また、フォントが鮮明なまま圧縮率が高いのも特徴の一つです。\u003c/p\u003e\n\u003cp\u003e次の参考記事では実際にグラデーションを導入したカラーフォントや COLRv1 と Bitmap を比較してどれほど鮮明なのかを確認することができます。\u003c/p\u003e\n\u003cp\u003eお使いの Chrome のバージョンを 98 にアップデートした上で、ぜひ見てみてください！\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/colrv1-fonts/\"\u003ehttps://developer.chrome.com/blog/colrv1-fonts/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eEmulate Chrome 100 in the UA string\u003c/h3\u003e\n\u003cp\u003eここ何回かのリリースには必ず含まれている内容ですね。\u003c/p\u003e\n\u003cp\u003eChrome のバージョンがもうすぐ 100 になるので、Chrome のバージョンを使っているような実装がある場合はバージョン番号が 3 桁になっても正しく動くかどうか確認しましょう。現在のバージョンを 100 にする\u003ca href=\"https://developer.chrome.com/blog/force-major-version-to-100/\"\u003e#force-major-version-to-100\u003c/a\u003eフラグを使って、既存のコードが正しく動くか確認することができます。\u003c/p\u003e\n\u003ch3\u003eAnd more!\u003c/h3\u003e\n\u003ch2\u003eWhat's New In DevTools (Chrome 98)\u003c/h2\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eDeprecations and removals in Chrome 98\u003c/h2\u003e\n\u003ch3\u003eRemove SDES key exchange for WebRTC\u003c/h3\u003e\n\u003cp\u003eChrome97 で記載があったものですが、98 で Shipping になりました。\u003c/p\u003e\n\u003cp\u003e詳細は\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/release-chrome-97\"\u003e前回のリリースノートのまとめ\u003c/a\u003eでも記載したので、そちらをご覧ください。\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003ch3\u003eAdd support for Promise to Blobs in clipboard item\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eClipboardItem\u003c/code\u003eオブジェクトに対して Promise をサポートしました。\u003c/p\u003e\n\u003cp\u003e今まで、Chrome では\u003ccode\u003eClipboardItem\u003c/code\u003eコンストラクターの引数として「文字列または blob に解決される Promise」を受け取ることが出来ませんでした。\u003c/p\u003e\n\u003cp\u003e今回のアップデートにより\u003ccode\u003eclipboard.write\u003c/code\u003eAPI が呼ばれた時に、一旦クリップボードに書き込む Blob データを同期的に取得する必要がなくなり、ブロックすることなく非同期的に write メソッドを呼び出すことができるようになります。\u003c/p\u003e\n\u003ch3\u003eCSS Color Adjust: 'only' keyword for color-scheme\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecolor-scheme\u003c/code\u003eプロパティの\u003ccode\u003eonly\u003c/code\u003eキーワードがサポートされました。only を指定することでユーザーエージェント(ブラウザ)が要素のカラースキーマを上書きすることを禁止します。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\"\u003ehttps://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://drafts.csswg.org/css-color-adjust/#color-scheme-prop\"\u003ehttps://drafts.csswg.org/css-color-adjust/#color-scheme-prop\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFileSystemHandle::Remove() method\u003c/h3\u003e\n\u003cp\u003eFileSystemHandle に\u003ccode\u003eRemove()\u003c/code\u003eメソッドを追加しました。\u003c/p\u003e\n\u003cp\u003e今ままで\u003ccode\u003eFileSystemHandle\u003c/code\u003eから直接ファイルやディレクトリを削除することは不可能で、親ディレクトリの\u003ccode\u003eFileSystemDirectoryHandle\u003c/code\u003eから\u003ccode\u003eRemoveEntry\u003c/code\u003eを呼ぶ必要がありました。\u003c/p\u003e\n\u003cp\u003e今回のアップデートにより「\u003ccode\u003eshowSaveFilePicker\u003c/code\u003eから\u003ccode\u003eFileHandle\u003c/code\u003eを取得したが、結局保存したくなくなったのでファイルを削除したい」というような、よくあるユースケースに対応できるようになりました。\u003c/p\u003e\n\u003ch3\u003eHDR CSS Media Queries: dynamic-range\u003c/h3\u003e\n\u003cp\u003eCSS のメディアクエリーに\u003ccode\u003edynamic-range\u003c/code\u003eが追加されました。\u003c/p\u003e\n\u003cp\u003e次のサンプルコードのように、ディスプレイが HDR をサポートしてるかしていないかを\u003ccode\u003edynamic-range\u003c/code\u003eで判別できるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token comment\"\u003e/* HDRをサポートしていない */\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003edynamic-range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e standard\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ered\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* ディスプレイがHDRをサポートしている */\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003edynamic-range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e high\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egreen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.w3.org/TR/mediaqueries-5/#dynamic-range\"\u003ehttps://www.w3.org/TR/mediaqueries-5/#dynamic-range\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eNew window.open() popup vs. window behavior\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ewindow.open()\u003c/code\u003eでは第 3 引数として\u003ccode\u003ewindowFeatures\u003c/code\u003eという option を DOMString で指定できますが、今バージョンから\u003ccode\u003epopup\u003c/code\u003eという機能に対応するようになりました。\u003ccode\u003e popup=yes\u003c/code\u003eまたは\u003ccode\u003epopup=1\u003c/code\u003eのように指定することで、ポップアップウィンドウを利用して開くことをブラウザに要求することが出来ます。\u003c/p\u003e\n\u003cp\u003eこの変更は window.open の新しくリリースされた仕様に合わせて、相互運用性のために行われた変更です。 広報互換性のため、ポップアップやタブ/ウィンドウを開く既存の動作に変更はありません。\u003c/p\u003e\n\u003ch3\u003ePrivate Network Access preflight requests for subresources\u003c/h3\u003e\n\u003cp\u003eサブリソースに対するプライベートネットワークリクエストの前に CORS プリフライトリクエストを送信し、ターゲットサーバーからの明示的な許可を求めるようになります。\u003c/p\u003e\n\u003cp\u003eプライベートネットワークリクエストとは以下のようなリクエストとのことです。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eパブリック Web サイトからプライベート IP アドレスまたはローカルホストへのリクエスト\u003c/li\u003e\n\u003cli\u003eプライベートな Web サイト（イントラネットなど）からローカルホストへのリクエスト\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eプライベートネットワーク上のサービスや機器(ネットワーク機器やプリンタなど)は CSRF 対策が不十分なものが多く、今回のアップデートはこれらの攻撃リスクを軽減させるための対策になります。\u003c/p\u003e\n\u003ch3\u003eWritableStream controller AbortSignal\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/WritableStream/abort\"\u003eWritableStream.abort()\u003c/a\u003eを実行した際に、ストリームへの進行中の書き込みの中止や終了がすぐに実行されるようになりました。\u003c/p\u003e\n\u003ch3\u003eself.structuredClone()\u003c/h3\u003e\n\u003cp\u003eディープコピーができる\u003ccode\u003estructuredClone()\u003c/code\u003eがついに 98 で実装されました。\u003c/p\u003e\n\u003cp\u003eお使いの Chrome を 98 にアップデートした上で、DevTools の Console で次のサンプルコードを試しに実行してみると\u003ccode\u003estructuredClone()\u003c/code\u003eで実際にディープコピーが実行されていることが確認できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myOriginal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  someProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"with a string value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  anotherProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    withAnotherProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myShallowCopy \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003emyOriginal \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmyShallowCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"a new value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  myOriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  myShallowCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myOriginal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  someProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"with a string value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  anotherProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    withAnotherProp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myDeepCopy \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003estructuredClone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emyOriginal\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmyDeepCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"a new value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  myOriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  myDeepCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://web.dev/structured-clone/\"\u003ehttps://web.dev/structured-clone/\u003c/a\u003e\u003c/p\u003e\n","metaData":{"title":"COLRv1 fontのサポートなど、Chrome 98 リリースノートまとめ","author":"nus3","editor":"Saji","createdAt":"2022-02-18","summary":"Chrome 98 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2022-02-18"}},{"slug":"considerations-for-monorepo","content":"\u003cp\u003eそれっぽいタイトルを付けましたが特に意味はないです。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/turborepo\"\u003eworkspace を使ったコマンドを最適化して実行する Turborepo について\u003c/a\u003eのお話で Turborepo を軽く触ってみた際に\u003ccode\u003enpx create-turbo@latest\u003c/code\u003eで作られる構成がとてもわかりやすく、プロダクトの初期段階からモノレポを採用するのは選択肢の 1 つとしていいのでは、と思い続編を書きました。\u003c/p\u003e\n\u003cp\u003e前回と同じくサンプルのリポジトリはこちらになります。\u003cbr\u003e\n\u003ca href=\"https://github.com/nus3/p-turborepo/tree/main/yarn\"\u003ehttps://github.com/nus3/p-turborepo/tree/main/yarn\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eモノレポを採用することで、同一リポジトリ内で自作した汎用的なライブラリやコンポーネントを複数のアプリケーションで使いまわせる\u003c/li\u003e\n\u003cli\u003eモノレポの規模が大きくなってきた場合には、モノレポ内のパッケージを npm に公開することでアプリケーションとパッケージを非同期に開発できる\u003c/li\u003e\n\u003cli\u003eYarn や npm の workspace はイイゾ！\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eモノレポとは\u003c/h2\u003e\n\u003cp\u003eモノレポとは本記事では npm や Yarn の workspaces 機能を使い、1 つのリポジトリ内で複数の npm パッケージを管理している構成のこととします。\u003c/p\u003e\n\u003ch3\u003enpm や Yarn の workspaces\u003c/h3\u003e\n\u003cp\u003enpm や Yarn の workspaces は 1 つのリポジトリ内で複数の npm パッケージを管理するための機能です。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://classic.yarnpkg.com/lang/en/docs/workspaces/\"\u003eYarn(v1)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://yarnpkg.com/features/workspaces\"\u003eYarn(v2 以降)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.npmjs.com/cli/v8/using-npm/workspaces\"\u003enpm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eworkspaces を使うにはリポジトリのルート直下にある\u003ccode\u003epackage.json\u003c/code\u003eに\u003ccode\u003eworkspaces\u003c/code\u003eを追加します。\u003c/p\u003e\n\u003cp\u003e例えば\u003ccode\u003eapps\u003c/code\u003e配下にアプリケーションの npm パッケージを、\u003ccode\u003epackages\u003c/code\u003e配下に汎用的なコンポーネント、ライブラリなどの npm パッケージを入れる場合、次のようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"workspaces\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"apps/*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"packages/*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps\u003c/code\u003e 配下にある\u003ccode\u003enus3-a\u003c/code\u003eというアプリケーションから \u003ccode\u003epackages\u003c/code\u003e 配下にある\u003ccode\u003enus3-ui\u003c/code\u003eという名前の npm パッケージを使う場合、それぞれ次のような\u003ccode\u003epackage.json\u003c/code\u003eになります。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Yarnのv2以降であれば`workspace:`構文が使えるようになる\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// REF: (nus3) https://yarnpkg.com/features/workspaces#workspace-ranges-workspace\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// \"nus3-ui\": \"workspace:*\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eworkspaces 内にある npm パッケージの名前が npm に公開されているパッケージ名と同じ場合は、 workspace 内の npm パッケージが優先してインストールされます。後々 workspaces 内の npm パッケージを公開する可能性がある場合、パッケージ名は npm で公開されているパッケージ名と被らない名前にした方が良いかもしれません。\u003c/p\u003e\n\u003cp\u003eworkspace 内の npm パッケージを依存関係に追加すると node_modules にシンボリックリンクが作成されます。次の画像のように node_modules 配下に\u003ccode\u003enus3-ui\u003c/code\u003eと\u003ccode\u003enus3-a\u003c/code\u003eのシンボリックリンクが追加されていることが確認できます。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/considerations-for-monorepo/symlink.png\" alt=\"node_modulesに作成されたシンボリックリンク\" width=\"340\" height=\"101\" \u003e\u003c/p\u003e\n\u003cp\u003eシンボリックリンクにより依存する npm パッケージのコードを直接参照するので、npm に公開しバージョン管理するまでは、version は\u003ccode\u003e0.0.0\u003c/code\u003e、かつ、使う側は\u003ccode\u003e\"nus3-ui\": \"*\"\u003c/code\u003eのようにワイルドカードを指定するとバージョンのことを意識せずに管理できます。\u003c/p\u003e\n\u003ch3\u003ecreate-turbo で作られるモノレポ構成\u003c/h3\u003e\n\u003cp\u003ecreate-turbo(\u003ccode\u003enpx create-turbo@latest\u003c/code\u003e) では作られるモノレポ構成に次のようなものが含まれます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enpm に公開せずに config をモノレポ内の別パッケージに分けて、複数のパッケージから使用する\u003c/li\u003e\n\u003cli\u003eReact を使った汎用的なコンポーネント(tsx)を別パッケージに分けて アプリケーション(Next.js)で使用する\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eそれぞれ見ていきましょう。\u003c/p\u003e\n\u003ch4\u003enpm に公開せずに config をモノレポ内の別パッケージに分けて、複数のパッケージから使用する\u003c/h4\u003e\n\u003cp\u003eESLint や Stylelint の config は npm に公開することで、異なるプロジェクトで共通の設定を使えます。サイボウズでは\u003ca href=\"https://github.com/cybozu/eslint-config\"\u003e@cybozu/eslint-config\u003c/a\u003eや\u003ca href=\"https://github.com/cybozu/stylelint-config\"\u003e@cybozu/stylelint-config\u003c/a\u003eとして npm に公開しています。\u003c/p\u003e\n\u003cp\u003eモノレポ内であれば ESLint や Stylelint の設定を npm に公開・管理せずに共有することもできます。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-config\u003c/code\u003e\u003cbr\u003e\nで共通の ESLint や TSConfig を定義して、\u003ccode\u003epackage.json\u003c/code\u003e の\u003ccode\u003efiles\u003c/code\u003e に指定します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-config\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"files\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"eslint-preset.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.base.json\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.nextjs.json\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.react-library.json\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\nで\u003ccode\u003enus3-config\u003c/code\u003eを追加し、\u003ccode\u003enus3-config\u003c/code\u003eから TSConfig や ESLint のルールを適用します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"eslint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"8.6.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nus3-config\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/tsconfig.json\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"extends\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-config/tsconfig.nextjs.json\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/.eslintrc\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003emodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"nus3-config/eslint-preset\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4\u003eReact を使った汎用的なコンポーネント(tsx)を別パッケージに分けて アプリケーション(Next.js)で使用する\u003c/h4\u003e\n\u003cp\u003ecreate-turbo では汎用的な React コンポーネントを tsx ファイルのまま \u003ccode\u003epackages\u003c/code\u003e 配下の npm パッケージで管理し、Next.js の\u003ca href=\"https://github.com/martpie/next-transpile-modules\"\u003eplugin\u003c/a\u003eを使って アプリケーション 側でトランスパイルしています。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui\u003c/code\u003e\u003cbr\u003e\nで React(tsx)のコンポーネントを実装します。実装した tsx ファイルのパスをそのまま\u003ccode\u003emain\u003c/code\u003eと\u003ccode\u003etypes\u003c/code\u003eに追加します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"main\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./index.tsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"types\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./index.tsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/react\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"17.0.37\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/react-dom\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"17.0.11\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"typescript\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"4.5.4\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui/index.tsx\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-tsx\"\u003e\u003ccode class=\"language-tsx\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eVFC\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"react\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eButton\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eVFC\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token plain-text\"\u003eボタン\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003enus3-ui\u003c/code\u003eの tsx ファイルを\u003ccode\u003enus3-a\u003c/code\u003eで\u003ccode\u003enext-transpile-modules\u003c/code\u003eを使ってトランスパイルします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"next-transpile-modules\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"9.0.0\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/next.config.js\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e withTM \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"next-transpile-modules\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ewithTM\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eフロントエンドのモノレポ戦略\u003c/h2\u003e\n\u003cp\u003e筆者のこれまでの経験では、創業して間もない会社やプロダクトの初期フェーズで、複数のアプリケーションの開発が並列して始まることが多くありました。そういった状況では、モノレポを採用しておくと複数のアプリケーションで共通したコンポーネントやライブラリを少ないコストで使用できます。\u003c/p\u003e\n\u003cp\u003eまた、モノレポ内で共通して使っているパッケージに変更を加える際に、その影響範囲が把握できないくらいモノレポの規模が大きくなった場合には、パッケージを npm に公開してバージョン管理することで、バージョンの変更タイミングを各々のアプリケーションに任せることができ、アプリケーションとパッケージの開発を非同期に行うことができます。\u003c/p\u003e\n\u003cp\u003eこのように、初期段階では汎用的な npm パッケージをアセットとして複数のアプリケーションに提供することで開発スピードを上げられ、また、規模が大きくなってきた場合はパッケージを npm に公開するといった方針をとることもできます。\u003c/p\u003e\n\u003cp\u003eもちろん、1 つのリポジトリですべてのパッケージを管理することやコードベースが大きく複雑になることなどデメリットもあり、モノレポを採用することが適切ではない場合もあります。メリット・デメリットを踏まえつつ、フロントエンドの技術選定の中にモノレポの採用を選択肢の 1 つとして入れてもいいかもしれません。\u003c/p\u003e\n","metaData":{"title":"フロントエンドのモノレポ構成はスケーリングの夢を見るか","author":"nus3","editor":["nakajmg"],"createdAt":"2022-01-31","summary":"Turborepoのstarterでできるモノレポ構成からスケーリングするフロントエンドの構成について考える","tags":["Monorepo","Turborepo"],"updatedAt":"2022-01-31"}},{"slug":"tc39-meeting-2021-12","content":"\u003cp\u003eTC39 の 87 回目のミーティングが 12月14日 ~ 12月15日に開催されました。このミーティングで議題に上がった提案とそのステージの移動について紹介します。\u003c/p\u003e\n\u003ch2\u003eFor Stage 4\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eFor Stage 4 の提案はありませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003eFor Stage 3\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-grouping\"\u003eArray Grouping\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 3 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eArray Grouping は \u003ccode\u003eArray.prototype.groupBy\u003c/code\u003e と \u003ccode\u003eArray.prototype.groupByToMap\u003c/code\u003e を追加するプロポーザルです。\u003c/p\u003e\n\u003cp\u003e2021 年 10 月のミーティングで Stage 2 になったばかりですが、今回のミーティングで Stage 3 になりました。\u003c/p\u003e\n\u003cp\u003eまた、今回から \u003ccode\u003eArray.prototype.groupByToMap\u003c/code\u003e が追加されています。\u003c/p\u003e\n\u003cp\u003eこれは \u003ccode\u003egroupBy\u003c/code\u003e の結果が \u003ccode\u003eMap\u003c/code\u003e になったものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e array \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e odd  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e odd\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e even \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e even\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e map \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egroupByToMap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003enum\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e num \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e even\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e odd\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emap\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Map { {odd: true}: [1, 3, 5], {even: true}: [2, 4] }\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 2\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eArray.fromAsync\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eArray.fromAsync\u003c/code\u003e は非同期イテラブルから配列を生成するためのスタティックメソッドを追加するプロポーザルです。\u003c/p\u003e\n\u003cp\u003eJavaScript では \u003ccode\u003eArray.from\u003c/code\u003e を使ってイテラブルから配列を生成できます。しかし、非同期イテラブルから配列を生成することはできません。\u003c/p\u003e\n\u003cp\u003eこのプロポーザルによって追加される \u003ccode\u003eArray.fromAsync\u003c/code\u003e メソッドを使うと次のようにして非同期イテラブルから配列を生成できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003en\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eyield\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e arr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eArray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efromAsync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-r-escape\"\u003eRegExp \u003ccode\u003e\\R\u003c/code\u003e escape\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp \u003ccode\u003e\\R\u003c/code\u003e escape は以前 \u003ca href=\"https://github.com/rbuckton/proposal-regexp-features\"\u003eRegExp Language Features\u003c/a\u003e として提案されていた正規表現の機能群の１つで、正規表現内で line terminator とシンプルにマッチングさせるために新しく \u003ccode\u003e\\R\u003c/code\u003e を導入する提案です。\u003c/p\u003e\n\u003cp\u003eこの機能は \u003ccode\u003eu\u003c/code\u003e もしくは \u003ccode\u003ev\u003c/code\u003e フラグが有効になっているときのみ有効になります。そして、大まかには次のパターンと等価です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\\r\\n\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e|\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\\x0A\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\\x0C\\x85\\u\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2028\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\\u\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2029\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこの正規表現の機能は Perl をはじめとする多くの正規表現エンジンに実装されていて、TC39 においてもそのユースケースは認められているようです。\u003c/p\u003e\n\u003cp\u003eしかし、\u003ca href=\"https://github.com/tc39/proposal-regexp-set-notation\"\u003eRegExp Set Notation Proposal\u003c/a\u003e の sequece properties によって同等の機能が実現できる可能性があるためその方向で調査しなおすべきだという結論になり Stage 2 には到達しませんでした。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-modifiers\"\u003eRegExp Modifiers\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp Modifiers は \u003ccode\u003e\\R\u003c/code\u003e escape と同じようにもともと RegExp Language Features の機能の１つでした。\u003c/p\u003e\n\u003cp\u003eこの提案は正規表現パターン内でのフラグの変更を可能にします。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cp\u003e次の例中の正規表現パターン全体には \u003ccode\u003ei\u003c/code\u003e フラグが適用されてます。しかし２つめの \u003ccode\u003e[a-z]\u003c/code\u003e は \u003ccode\u003e?-i:\u003c/code\u003e という RegExp Modifiers の構文を使って \u003ccode\u003ei\u003c/code\u003e フラグを無効にしてます。このとき一文字目では大文字小文字が無視されるものの、二文字目では大文字小文字が無視されません。\u003c/p\u003e\n\u003cp\u003eしたがってこのパターンは \u003ccode\u003e\"ab\"\u003c/code\u003e や \u003ccode\u003e\"Ab\"\u003c/code\u003e にはマッチし \u003ccode\u003e\"aB\"\u003c/code\u003e にはマッチしません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e re1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003e\u003cspan class=\"token anchor function\"\u003e^\u003c/span\u003e\u003cspan class=\"token charset\"\u003e\u003cspan class=\"token charset-punctuation punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token range\"\u003ea\u003cspan class=\"token range-punctuation operator\"\u003e-\u003c/span\u003ez\u003c/span\u003e\u003cspan class=\"token charset-punctuation punctuation\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token group punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e?\u003c/span\u003e-i:\u003cspan class=\"token charset\"\u003e\u003cspan class=\"token charset-punctuation punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token range\"\u003ea\u003cspan class=\"token range-punctuation operator\"\u003e-\u003c/span\u003ez\u003c/span\u003e\u003cspan class=\"token charset-punctuation punctuation\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token group punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token anchor function\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"ab\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Ab\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"aB\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-buffer-boundaries\"\u003eRegExp Buffer Boundaries\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp Buffer Boundaries も RegExp Language Features の機能の１つでした。\u003c/p\u003e\n\u003cp\u003eこの提案は、それぞれ入力の最初と最後にマッチする \u003ccode\u003e\\A\u003c/code\u003e と \u003ccode\u003e\\z\u003c/code\u003e を導入します。\u003ccode\u003em\u003c/code\u003e フラグの影響を受けないことを除けば \u003ccode\u003e^\u003c/code\u003e と \u003ccode\u003e$\u003c/code\u003e に似ています。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e^\u003c/code\u003e と \u003ccode\u003e$\u003c/code\u003e はそれぞれ最初と最後にマッチしますが、\u003ccode\u003em\u003c/code\u003e フラグが有効になっているときは行頭と行末にマッチします。しかし RegExp Buffer Boundaries が導入する \u003ccode\u003e\\A\u003c/code\u003e と \u003ccode\u003e\\z\u003c/code\u003e は、たとえ \u003ccode\u003em\u003c/code\u003e フラグが有効であっても入力の最初と最後にマッチします。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e re \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003e\u003cspan class=\"token anchor function\"\u003e\\A\u003c/span\u003efoo\u003cspan class=\"token alternation keyword\"\u003e|\u003c/span\u003e\u003cspan class=\"token anchor function\"\u003e^\u003c/span\u003ebar\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eum\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのパターンでは \u003ccode\u003efoo\u003c/code\u003e に \u003ccode\u003e\\A\u003c/code\u003e がついています。したがって入力の最初が \u003ccode\u003efoo\u003c/code\u003e の文字列にマッチします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"foo\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし入力の最初ではなく行頭が \u003ccode\u003efoo\u003c/code\u003e の文字列にはマッチしません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\nfoo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003ebar\u003c/code\u003e には \u003ccode\u003e^\u003c/code\u003e がついています。パターン全体で \u003ccode\u003em\u003c/code\u003e フラグが有効になっているので、入力の先頭と行頭が \u003ccode\u003ebar\u003c/code\u003e の文字列にマッチします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bar\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\nbar\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 1\u003c/h2\u003e\n\u003ch2\u003eUpdates\u003c/h2\u003e\n\u003cp\u003eステージの移動はないものの、アップデートがあった提案です。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-temporal\"\u003eTemporal\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eいくつかの仕様上の軽微な修正がありました。修正箇所について説明した\u003ca href=\"https://ptomato.name/talks/tc39-2021-12/#1\"\u003eスライド\u003c/a\u003eが公開されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-decimal\"\u003eDecimal\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eDecimal は現在 Stage 1 ですが、2022 年に Stage 2 に到達することを目指しているそうです。進捗を共有するための\u003ca href=\"https://drive.google.com/file/d/1qdieei11dZgDY_KnJhSBcFyHTMZOmCJr/view\"\u003eスライド\u003c/a\u003eが公開されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-destructuring-private\"\u003eDestructuring Private Fields\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eDestructuring Private Fields が提案された当初は小さな修正で十分だと考えられていました。しかし真剣に検討してみるといくつかの仕様上の難しい問題が明らかになったそうです。そこで再度レビュワーを募りレビューをやり直すことが決定しました。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eShadow Realms\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eいくつかの仕様上の重要な変更があったようです。詳しくは\u003ca href=\"https://docs.google.com/presentation/d/12PM5c4_yUnqXHjvACh8HEN5oJwgei-0T0hX_hlqjfDU/edit#slide=id.ge435a9058a_0_0\"\u003eスライド\u003c/a\u003eに記載されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-record-tuple/\"\u003eRecords and Tuples\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eRecord と Tuple の中で通常のオブジェクトを扱う方法について議論されました。その方法とその懸念についての Decision Tree が\u003ca href=\"https://drive.google.com/file/d/1lVYn8_sHecqxW08vN5Tu7rXZn7GemBqO/view\"\u003eスライド\u003c/a\u003eとして公開されています。\u003c/p\u003e\n\u003ch2\u003eNormative Changes\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/2106\"\u003e\u003ccode\u003eimport.meta[Symbol.toStringTag]\u003c/code\u003e の追加\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e合意は得られませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag\"\u003e\u003ccode\u003eSymbol.toStringTag\u003c/code\u003e\u003c/a\u003e という Well-known Symbol があります。\nこの Symbol は \u003ccode\u003eObject.prototype.toString()\u003c/code\u003e によって表示される文字列の決定に使われます。\u003c/p\u003e\n\u003cp\u003e具体的な例を示します。\u003c/p\u003e\n\u003cp\u003eオブジェクト \u003ccode\u003efoo\u003c/code\u003e の \u003ccode\u003e[Symbol.toStringTag]\u003c/code\u003e に \u003ccode\u003e\"I'm foo\"\u003c/code\u003e という文字列をセットしておくと、\u003ccode\u003efoo.toString()\u003c/code\u003e は \u003ccode\u003e[object I'm foo]\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token known-class-name class-name\"\u003eSymbol\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etoStringTag\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"I'm foo\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// \"[object I'm foo]\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回のミーティングでは \u003ccode\u003eimport.meta\u003c/code\u003e の \u003ccode\u003e[Symbol.toStringTag]\u003c/code\u003e に \u003ccode\u003e\"ImportMeta\"\u003c/code\u003e という文字列を設定するという修正について議論されました。\u003c/p\u003e\n\u003cp\u003eこの挙動についての Issue は \u003ccode\u003eimport.meta\u003c/code\u003e の策定時にも存在しましたが、そのときすでに \u003ccode\u003eimport.meta\u003c/code\u003e が Stage 4 を達成していたことからクローズされました。\u003c/p\u003e\n\u003cp\u003eそして今回のミーティングでもこの仕様の修正についての合意は得られませんでした。この修正のための Pull Request が作成された時点で以下のような懸念が公開されていました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eimport.meta\u003c/code\u003e は、ECMAScript の範囲では \u003ca href=\"https://tc39.es/ecma262/#sec-hostgetimportmetaproperties\"\u003e\u003ccode\u003eHostGetImportMetaProperties\u003c/code\u003e\u003c/a\u003e というホスト定義の abstract operation によって中身が決定されるオブジェクトであるということしか決まっておらず、ホストにとって必要であればホスト側で \u003ccode\u003eimport.meta\u003c/code\u003e の \u003ccode\u003eSymbol.toStringTag\u003c/code\u003e を定義できる。\u003c/li\u003e\n\u003cli\u003e仕様内で作成される他のオブジェクトとは異なり、\u003ccode\u003eimport.meta\u003c/code\u003e はホストのデータによって生成されるものであり、ECMAScript の範囲でプロパティを生成することを考慮したものではない。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/agendas/blob/main/2021/12.md\"\u003eAgenda for the 87th meeting of Ecma TC39\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/2106\"\u003eNormative: Add import.meta[Symbol.toStringTag]\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-grouping\"\u003eProposal Array Grouping\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eProposal Shadow Realms\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eProposal \u003ccode\u003eArray.fromAsync\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-features\"\u003eProposal RegExp Language Features\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-r-escape\"\u003eProposal RegExp \u003ccode\u003e\\R\u003c/code\u003e escape\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-set-notation\"\u003eProposal RegExp Set Notation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-buffer-boundaries\"\u003eProposal RegExp Buffer Boundaries\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-modifiers\"\u003eProposal RegExp Modifiers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-temporal\"\u003eProposal Temporal\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eProposal Shadow Realms\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-record-tuple/\"\u003eProposal Records and Tuples\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-destructuring-private\"\u003eProposal Destructuring Private Fields\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eBabel\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/proposals/issues/78\"\u003eDec 2021 · Issue #78 · babel/proposals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eECMA262\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-ImportMeta\"\u003e\u003ccode\u003eimport.meta\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#sec-hostgetimportmetaproperties\"\u003e\u003ccode\u003eHostGetImportMetaProperties\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"ECMAScriptの最新動向 2021年12月版","author":"sosukesuzuki","createdAt":"2022-01-24","summary":"2021年12月14日~15日に開催された TC39 meeting 87th の内容を紹介します","tags":["TC39","ECMAScript"],"updatedAt":"2022-01-24"}},{"slug":"release-chrome-97","content":"\u003cp\u003eChrome 97 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-97/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-97/\"\u003ehttps://developer.chrome.com/blog/deps-rems-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D97\"\u003ehttps://www.chromestatus.com/features#milestone%3D97\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://v8.dev/blog/v8-release-97\"\u003ehttps://v8.dev/blog/v8-release-97\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 97)\u003c/h2\u003e\n\u003cp\u003eChrome97 で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eWeb Transport\u003c/h3\u003e\n\u003cp\u003eサーバーとクライアントの双方向リアルタイム通信を実現する新しいフレームワークとして提案されている\u003ccode\u003eWeb Transport\u003c/code\u003eが正式にサポートされました。\u003c/p\u003e\n\u003cp\u003eWeb Transport は既存の代表的手法である\u003ccode\u003eWeb Sockets\u003c/code\u003eや\u003ccode\u003eWebRTC\u003c/code\u003eと比べ以下のような利点を持っています。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eWebSockets\u003c/code\u003eよりも低遅延な通信を実現する\u003c/li\u003e\n\u003cli\u003eP2P メッセージング用に設計された\u003ccode\u003eWebRTC\u003c/code\u003eと違い、クライアントサーバーメッセージングを前提として設計されているため扱いやすい\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWeb Transport では\u003ccode\u003estreams API\u003c/code\u003eと\u003ccode\u003edatagram API\u003c/code\u003eという２種類の通信 API がサポートされており、それぞれ以下のような特徴から使い分けることができます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estreams API : 信頼性の高い順序付けられたデータ送信に最適\u003c/li\u003e\n\u003cli\u003edatagram API : 信頼性や順序がそこまで求められず、より低遅延でベストエフォートなデータ送信に最適\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e注意点として、Web Transport を試すためには\u003ccode\u003eHTTP/3\u003c/code\u003eをサポートしたサーバーが必要となります。\u003c/p\u003e\n\u003cp\u003eWeb Transport は以下のような形で簡単に利用することができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e url \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'https://example.com:4999/foo/bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e transport \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eWebTransport\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eurl\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// WebTransportインスタンス生成\u003c/span\u003e\n\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e transport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eready\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 接続を待つ\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e writer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e transport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edatagrams\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewritable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetWriter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUint8Array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e65\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e66\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e67\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nwriter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewrite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e詳しくは\u003ca href=\"https://web.dev/webtransport/\"\u003eExperimenting with WebTransport\u003c/a\u003eを参照しててください。\u003c/p\u003e\n\u003ch3\u003eScript type feature detection\u003c/h3\u003e\n\u003cp\u003eブラウザ側で\u003ccode\u003eES Modules\u003c/code\u003eの対応状況を判別する方法として今まで\u003ccode\u003enomodule\u003c/code\u003e属性がありましたが、\u003ccode\u003eimport maps\u003c/code\u003e, \u003ccode\u003especulation rules\u003c/code\u003e,\u003ccode\u003ebundle preloading\u003c/code\u003eなどの新しく提案されている仕様には対応しきれていませんでした。\u003c/p\u003e\n\u003cp\u003e今回サポートされた\u003ccode\u003eHTMLScriptElement.supports()\u003c/code\u003eを利用することで以下のように JavaScript側でscriptがどの仕様に対応しているかのチェックをすることができるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eHTMLScriptElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'importmap'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use \u0026#x3C;script type=\"importmap\" ...\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eHTMLScriptElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'module'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use \u0026#x3C;script type=\"module\" ...\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use classic method...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eNew array prototypes\u003c/h3\u003e\n\u003cp\u003eArray と TypedArray で\u003ccode\u003efindLast()\u003c/code\u003eと\u003ccode\u003efindLastIndex()\u003c/code\u003eが使えるようになりました。\nこの二つの関数は引数で渡された条件に合致する配列内の\u003cstrong\u003e最後の要素\u003c/strong\u003eの値、位置をそれぞれ返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e array \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e12\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e8\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e130\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e44\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e last \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efindLast\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elast\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 44\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e lastIndex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efindLastIndex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elastIndex\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eEmulate Chrome 100 in the UA string\u003c/h3\u003e\n\u003cp\u003eあと数ヶ月で Chrome のバージョンは 3 桁となる 100 に到達します。\nバージョンや UA 文字列をパースするコードがある場合は 3 桁でも動くかどうか確認しましょう。\u003c/p\u003e\n\u003cp\u003e現在のバージョンを 100 にする\u003ca href=\"https://developer.chrome.com/blog/force-major-version-to-100/\"\u003e#force-major-version-to-100\u003c/a\u003eフラグを使って、既存のコードが正しく動くか確認することができます。\u003c/p\u003e\n\u003ch3\u003eAnd more!\u003c/h3\u003e\n\u003cp\u003e上記以外のようなアップデートがあります。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eフォーム入力の改行が Gecko や WebKit と同じ方法で正規化されるようになりました。\n\u003cul\u003e\n\u003cli\u003eこれによりブラウザ間の相互運用性が向上しました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eclient hint\u003c/code\u003eのプレフィクスを\u003ccode\u003esec-ch\u003c/code\u003eにするように標準化を進めています。\n\u003cul\u003e\n\u003cli\u003e例えば\u003ccode\u003edpr\u003c/code\u003eは\u003ccode\u003esec-ch-dpr\u003c/code\u003eのようになります。\u003c/li\u003e\n\u003cli\u003e以前の仕様も当分の間サポートを続けますが、いずれは非推奨となり削除されることを想定しましょう。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e閉じている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素が検索可能になり、閉じている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素内の element にスクロールしようとした際は閉じられている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素を自動的に開くようになりました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eWhat's New In DevTools (Chrome 97)\u003c/h3\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eDeprecations and removals in Chrome 97\u003c/h3\u003e\n\u003cp\u003eChrome97 で非推奨になったもの、もしくは削除されたものです\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-97/\"\u003ehttps://developer.chrome.com/blog/deps-rems-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eRemove SDES key exchange for WebRTC\u003c/h3\u003e\n\u003cp\u003eWebRTC の SDES 鍵交換の仕様は 2013 年以降、関連する IETF の標準仕様では MUST NOT となっており、近年では Chrome での使用率も大幅に低下しているので Chrome97 で廃止されました。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://webrtc-security.github.io/report_ja/\"\u003ehttps://webrtc-security.github.io/report_ja/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eRemove WebSQL in third-party contexts\u003c/h3\u003e\n\u003cp\u003eサードパーティ製の WebSQL が廃止されました。W3C では代わりに Web Storage と Indexed Database を推奨しています。\u003c/p\u003e\n\u003ch3\u003eRemove SDP Plan B\u003c/h3\u003e\n\u003cp\u003eWebRTC でセッションを確立するために使用される SDP に非標準の実装であった\u003ccode\u003ePlan B\u003c/code\u003eが削除されました。\u003c/p\u003e\n\u003cp\u003e参考: SDP の Unified Plan と Plan B\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.jxck.io/entries/2018-01-05/sdp-unified-plan.html\"\u003ehttps://blog.jxck.io/entries/2018-01-05/sdp-unified-plan.html\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D97\"\u003ehttps://www.chromestatus.com/features#milestone%3D97\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eFeature policy for Keyboard API\u003c/h3\u003e\n\u003cp\u003e各言語に対応した keybord レイアウト情報を返す\u003ccode\u003egetLayoutMap()\u003c/code\u003eメソッドは全てのコンテキスト(iframe 内など)では利用できないという問題点がありました。今回のアップデートで iframe の allow 属性に\u003ccode\u003ekeyboard-map\u003c/code\u003eを追加することでこの問題を解決することができるようになりました。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5657965899022336\"\u003ehttps://chromestatus.com/features/5657965899022336\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003e\u003ccode\u003ePermissionStatus.prototype.name\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ePermissionStatus\u003c/code\u003e インターフェースに読み取り専用の属性 \u003ccode\u003e\"name\"\u003c/code\u003e を追加し、\u003ccode\u003ePermissionStatus\u003c/code\u003e が作成された後、パーミッションの名前が取得できるようになりました。\u003c/p\u003e\n\u003cp\u003e今までは\u003ccode\u003ePermissions API\u003c/code\u003e を使って複数のパーミッションを同時に問い合わせた際、どの PermissionStatus がどのパーミッションに対応しているのかを識別する方法がありませんでした。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5651653697994752\"\u003ehttps://chromestatus.com/features/5651653697994752\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003ePropagate request origin and redirect chain in passthrough service workers.\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003efetch(evt.request)\u003c/code\u003eメソッドで navigation requests を発行する ServiceWorker が\u003ccode\u003eFetchEvent.request\u003c/code\u003e からのオリジンとリダイレクトチェーンを使用するようになります。\u003c/p\u003e\n\u003cp\u003e今までは常に ServiceWorker のオリジンが設定され、リダイレクトチェーンを使用することはありませんでした。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5752539724120064\"\u003ehttps://chromestatus.com/features/5752539724120064\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eSupport calc(\u003ccode\u003e\u0026#x3C;number\u003e\u003c/code\u003e) where only accepts \u003ccode\u003e\u0026#x3C;integer\u003e\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/release-chrome-96\"\u003eChrome 96 リリースノートまとめ\u003c/a\u003eにも記載したものが、Chrome97 で追加されました。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecss の calc()関数で integer しか受け取らないような場所でも number を指定できるようになりました。 もっとも近い整数に丸められます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5656451751084032\"\u003ehttps://chromestatus.com/features/5656451751084032\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003etransform: perspective(none)\u003c/h3\u003e\n\u003cp\u003eCSS transform プロパティ内で利用できる、\u003ccode\u003eperspective()\u003c/code\u003e関数への引数として'none'を実装としてサポートしました。\u003ccode\u003eperspective(0)\u003c/code\u003eと\u003ccode\u003eperspective(none)\u003c/code\u003eでは挙動が変わるため、変形をしないことを意図する場合(単位行列として扱いたい場合)は\u003ccode\u003eperspective(none)\u003c/code\u003eを利用するようにしましょう。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5687325523705856\"\u003ehttps://chromestatus.com/features/5687325523705856\u003c/a\u003e\u003c/p\u003e\n","metaData":{"title":"Web Transportのサポートなど、Chrome 97 リリースノートまとめ","author":"Saji","editor":"nus3","createdAt":"2022-01-21","summary":"Chrome 97 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2022-01-21"}},{"slug":"release-firefox-96","content":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mozilla.org/en-US/firefox/96.0/releasenotes/\"\u003ehttps://www.mozilla.org/en-US/firefox/96.0/releasenotes/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/96\"\u003ehttps://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/96\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFirefox 96 がリリースされました！\n全体的に性能面での改善が多くを占めるアップデートでした。\n本リリースでは Cookie Policy がデフォルトで \u003ccode\u003eSameSite=lax\u003c/code\u003eを指定するようになりました。\nまた、\u003ccode\u003ecolor-scheme\u003c/code\u003eプロパティが追加され、IE 以外の主要なブラウザで利用可能になりました。\u003c/p\u003e\n\u003ch2\u003eNew\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eノイズ抑制やオートゲインコントロールの大きな改善とエコーキャンセレーションの若干の改善がされました\u003c/li\u003e\n\u003cli\u003eメインスレッドの負荷が大きく軽減されました\u003c/li\u003e\n\u003cli\u003eCookie Policy をデフォルトで \u003ccode\u003eSameSite=lax\u003c/code\u003e に強制するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFixed\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emacOS で Gmail のリンクをコマンドクリックした際、正常に新しいタブが開くようになりました\n\u003cul\u003e\n\u003cli\u003eFirefox95 で unresolved になっていた問題の解決\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eビデオの SSRC(RTP セッションでの参加者の識別子) が断続的にドロップする問題が修正されました\u003c/li\u003e\n\u003cli\u003e特定のサイトでビデオの画質が劣化する問題が修正されました\u003c/li\u003e\n\u003cli\u003emacOS でいくつかの問題を回避するためにフルスクリーンでのビデオが無効化されています\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDeveloper\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eLinux にて \u003ccode\u003eSelect All\u003c/code\u003e のショートカットキーが \u003ccode\u003eAlt-A\u003c/code\u003e から \u003ccode\u003eCtrl-A\u003c/code\u003e に変更されました\n\u003cul\u003e\n\u003cli\u003eweb-compatibility の確保やアクセスキーとの衝突回避のため\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWeb Platform\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWeb Lock API が実装されました。\n\u003cul\u003e\n\u003cli\u003e異なる ServiceWorker やタブで実行されているスクリプトを相互連携させることが可能になります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWebRTC ライブラリが更新されたことで Web 会議アプリでの音声やビデオ機能が改善されました\u003c/li\u003e\n\u003cli\u003eCSS にて \u003ccode\u003ecolor-scheme\u003c/code\u003e がサポートされ、Web ページがどのカラースキームでレンダリング可能かを指定できるようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e開発者向けの変更\u003c/h2\u003e\n\u003ch3\u003efor web developers\u003c/h3\u003e\n\u003ch4\u003eCSS\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eCSS で色の値として利用される \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/hwb()\"\u003e\u003ccode\u003ehwb()\u003c/code\u003e\u003c/a\u003e 関数が実装されました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\"\u003e\u003ccode\u003ecolor-scheme\u003c/code\u003e\u003c/a\u003eプロパティがサポートされました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/counter-reset\"\u003e\u003ccode\u003ecounter-reset\u003c/code\u003e\u003c/a\u003e プロパティにて逆順の CSS カウンターを生成する \u003ccode\u003ereversed()\u003c/code\u003e 関数がサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eHTTP\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e同じドメインから送信された Cookie でも異なるスキームを使用されているものは Cookie SameSite ディレクティブについて別サイトから送信されたものと見なすようになりました\u003c/li\u003e\n\u003cli\u003eSameSite 属性が指定されていない Cookie は暗黙的に \u003ccode\u003eSameSite=lax\u003c/code\u003e が指定されるようになりました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSameSite=none\u003c/code\u003e を指定した Cookie はセキュアなコンテキストが必要になりました\u003c/li\u003e\n\u003cli\u003eCookie の SameSite についてはこちらをお読みください\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/05/07/080000\"\u003eCookie の SameSite 属性について - Cybozu Inside Out | サイボウズエンジニアのブログ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eAPIs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eAndroid において \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/canShare\"\u003e\u003ccode\u003enavigator.canShare()\u003c/code\u003e\u003c/a\u003e がサポートされました\u003c/li\u003e\n\u003cli\u003eデフォルトで \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API\"\u003eWeb Locks API\u003c/a\u003e が有効になりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eCanvas\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eWebP の画像エンコーダーをサポートしました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eDOM\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/IntersectionObserver\"\u003e\u003ccode\u003eIntersectionObserver()\u003c/code\u003e\u003c/a\u003e のコンストラクターが関連付けられたパラメータオプションにから文字が渡された場合に例外発生ではなく \u003ccode\u003erootMargin\u003c/code\u003e を設定するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eMedia, WebRTC, and Web Audio\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eいくつかの非標準な静的フィールドが \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_Statistics_API\"\u003eWebRTC Statistics API\u003c/a\u003e から削除されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eWebDriver conformance (Marionette)\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:GetElementShadowRoot\u003c/code\u003e コマンドが追加されました\n\u003cul\u003e\n\u003cli\u003e指定された要素が持っている shadow root を取り出す\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:ExecuteScript\u003c/code\u003e 及び \u003ccode\u003eWebDriver:ExecuteAsyncScript\u003c/code\u003eにて要素の \u003ccode\u003eShadowRoot\u003c/code\u003e を返す際に \u003ccode\u003ecyclic object error\u003c/code\u003e が発生する問題が解決されました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:Print\u003c/code\u003e が PDF にプリントする際のページ範囲をサポートするように拡張されました\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"CSS color-scheme サポート追加等 Firefox 96.0 リリースノートまとめ","author":"BaHo","editor":"shisama","createdAt":"2022-01-20","summary":"Firefox 96.0 のリリースノートの日本語まとめです","tags":["Releasenote","Browser"],"updatedAt":"2022-01-20"}},{"slug":"turborepo","content":"\u003cp\u003e今年からフロントエンドエキスパートチームでは活動内容の一つである\u003cstrong\u003e探求\u003c/strong\u003eの一環として、メンバーが気になった技術に対して、気軽に触ってみる会をしています。次の画像は筆者が Slack で、気軽に触ってみる会の開催を宣言してる時のものです。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/turborepo/slack.png\" alt=\"slackで気軽に触ってみる会を宣言してる\" width=\"718\" height=\"152.15061295971978\" \u003e\u003c/p\u003e\n\u003cp\u003e今回は\u003ca href=\"https://vercel.com/blog/vercel-acquires-turborepo\"\u003e去年の 12 月に Vercel に買収されたニュース\u003c/a\u003eがあった Turborepo を気軽に触ってみました。\n個人的には 1 人で調べるときよりも複数人でわいわい調べた方が、その技術や関連する周辺知識の話を色んな人の観点で深掘ってできて、とても有意義な時間でした。\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eTurborepo はモノレポのためのビルドシステムで次のような特徴があります。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYarn, npm, pnpm の workspaces に対応してるリポジトリに対して簡単に導入できる\u003c/li\u003e\n\u003cli\u003eworkspace 内のコマンドの依存関係をシンプルに設定してくれる\u003c/li\u003e\n\u003cli\u003eTurborepo で実行するコマンドがない package はスルーしてくれる(npm workspace の\u003ccode\u003e--if-present\u003c/code\u003eに相当)\u003c/li\u003e\n\u003cli\u003eローカルキャッシュ、リモートキャッシュを生成・利用できる\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eサンプルで作ったモノレポ構成\u003c/h3\u003e\n\u003cp\u003e今回は Yarn v1 の workspace を使ってます。\u003cbr\u003e\n\u003ca href=\"https://github.com/nus3/p-turborepo/tree/main/yarn\"\u003ehttps://github.com/nus3/p-turborepo/tree/main/yarn\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e├── apps\n│   └── nus3-a: Next.js\n└── packages:\n    ├── nus3-button2: Reactのコンポーネント + ViteのLibrary Modeでビルド\n    ├── nus3-config: tsconfig + eslintのconfig\n    └── nus3-ui: Reactのコンポーネント(ビルドせずに使う)\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eサンプルで作ったモノレポ内の package たちは次のような依存関係になっています。\u003cbr\u003e\n(色々試してたので適当な命名になってます。すんません)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enus3-a\u003c/code\u003eは\u003ccode\u003enus3-ui\u003c/code\u003eと\u003ccode\u003enus3-button2\u003c/code\u003eに依存している\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enus3-ui\u003c/code\u003eは\u003ccode\u003enus3-button2\u003c/code\u003eに依存している\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/turborepo/dependencies.png\" alt=\"サンプルリポジトリの依存関係\" width=\"577\" height=\"314\" \u003e\u003c/p\u003e\n\u003ch3\u003e使い方\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e使っているパッケージマネージャーで(Yarn, npm, pnpm)で workspace の設定\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eturbo\u003c/code\u003eのインストール\u003c/li\u003e\n\u003cli\u003epackage.json に\u003ccode\u003epipeline\u003c/code\u003eの設定\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4\u003e1. 使っているパッケージマネージャーで(Yarn, npm, pnpm)で workspace の設定\u003c/h4\u003e\n\u003cp\u003eworkspace の設定については割愛します。各パッケージマネージャーのドキュメントをご覧ください。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://classic.yarnpkg.com/lang/en/docs/workspaces/\"\u003eYarn\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.npmjs.com/cli/v8/using-npm/workspaces\"\u003enpm\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pnpm.io/workspaces\"\u003epnpm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003e2. \u003ccode\u003eturbo\u003c/code\u003eのインストール\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eyarn add turbo -W --dev\u003c/code\u003eで Turborepo を追加します。\u003c/p\u003e\n\u003ch4\u003e3. package.json に\u003ccode\u003epipeline\u003c/code\u003eの設定\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003epackage.json\u003c/code\u003eに\u003ccode\u003eturbo.pipeline\u003c/code\u003eを追加し、そこで\u003ccode\u003eturbo run {command}\u003c/code\u003eで実行する command の依存関係やキャッシュの設定をします。この\u003ccode\u003epipeline\u003c/code\u003eで定義した command しか\u003ccode\u003eturbo run {command}\u003c/code\u003eでは実行できません。\u003c/p\u003e\n\u003cp\u003e実際に定義したものが次の json になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"turbo\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"pipeline\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"^build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"outputs\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dist/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".next/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003edependsOn\u003c/code\u003eで依存関係を、\u003ccode\u003eoutputs\u003c/code\u003eでキャッシュするものを指定します。\u003c/p\u003e\n\u003cp\u003e定義したコマンドを一つずつ見ていきましょう。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"^build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003edependOn に\u003ccode\u003e^\u003c/code\u003eを追加したコマンド(\u003ccode\u003e^build\u003c/code\u003e)を指定することで workspace 内の各 package の指定したコマンド(\u003ccode\u003ebuild\u003c/code\u003e)を package 間の依存関係を考慮した順番で実行してくれます。\u003c/p\u003e\n\u003cp\u003e実際に実行してみると、サンプルで作った各 package の依存関係を考慮した順番(\u003ccode\u003e@nus3/example-button2\u003c/code\u003e → \u003ccode\u003enus3-ui\u003c/code\u003e → \u003ccode\u003enus3-a\u003c/code\u003e)でビルドされていることがわかります。\u003cbr\u003e\n(※今回サンプルで作った構成では\u003ccode\u003enus3-ui\u003c/code\u003eはビルドの必要がないですが、依存関係を考慮した順番を表すのにあえて build コマンドを追加しています)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run build\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running build in 4 packages\n@nus3/example-button2:build: cache miss, executing a161062b16a0be35\n@nus3/example-button2:build: $ vite build \u0026#x26;amp;\u0026#x26;amp; tsc -p ./tsconfig.build.json\n...\n@nus3/example-button2:build: dist/nus3-example-button2.es.js   3.30 KiB / gzip: 1.39 KiB\nnus3-ui:build: cache miss, executing b32d4fb848c8658f\nnus3-ui:build: $ echo \u0026#x26;#39;build nus3-ui\u0026#x26;#39;\n...\nnus3-a:build: cache miss, executing a80d8842624981a8\nnus3-a:build: $ next build\n...\n\n Tasks:    3 successful, 3 total\nCached:    0 cached, 3 total\n  Time:    5.702s\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次の\u003ccode\u003eoutputs\u003c/code\u003eはコマンドを実行した際に、\u003ccode\u003edist\u003c/code\u003eと\u003ccode\u003e.next\u003c/code\u003e配下にあるファイル群をキャッシュする設定です。\u003ccode\u003enode_modules/.cache/turbo\u003c/code\u003eにキャッシュしたファイルが出力されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"outputs\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dist/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".next/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e先程の build コマンドをもう一度実行すると cache が使われ、前回より早く実行されているのがわかります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run build\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running build in 4 packages\n@nus3/example-button2:build: cache hit, replaying output a161062b16a0be35\n...\nnus3-ui:build: cache hit, replaying output b32d4fb848c8658f\n...\nnus3-a:build: cache hit, replaying output a80d8842624981a8\n...\n\n Tasks:    3 successful, 3 total\nCached:    3 cached, 3 total\n  Time:    221ms \u0026#x26;gt;\u0026#x26;gt;\u0026#x26;gt; FULL TURBO\n\n✨  Done in 0.57s.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次のように何も指定しない場合、依存関係がないものとして認識され並列に実行されます\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次の deploy コマンドの\u003ccode\u003edependsOn\u003c/code\u003eでは pipeline で定義した\u003ccode\u003ebuild\u003c/code\u003e, \u003ccode\u003etest\u003c/code\u003e, \u003ccode\u003elint\u003c/code\u003e(順不同)を実行し、終了した時点で workspace 内の各 package の\u003ccode\u003edeploy\u003c/code\u003eコマンドを実行します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回定義したものの場合、Turborepo は次のようなことを考慮しながら各々の package のコマンドを実行します。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebuild\u003c/code\u003e: モノレポ内の各 package の依存関係を考慮しつつ build\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etest\u003c/code\u003e: \u003ccode\u003epipeline\u003c/code\u003eで定義した\u003ccode\u003ebuild\u003c/code\u003eが実行された後に実行\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003elint\u003c/code\u003e: 他のコマンドの順番を気にせず、並列で実行\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003edeploy コマンドを実行した結果が次になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run deploy\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running deploy in 4 packages\nnus3-a:lint: $ next lint\n@nus3/example-button2:build: $ vite build \u0026#x26;amp;amp;\u0026#x26;amp;amp; tsc -p ./tsconfig.build.json\n...\nnus3-ui:build: $ echo \u0026#x26;#39;build nus3-ui\u0026#x26;#39;\n...\nnus3-a:build: $ next build\n...\nnus3-a:test: $ echo \u0026#x26;#39;test nus3-a\u0026#x26;#39;\n...\nnus3-a:deploy: $ echo \u0026#x26;#39;deploy nus3-a\u0026#x26;#39;\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e実際に上記を考慮しつつ各 package のコマンドが実行された後に、最後に deploy コマンドが実行されているのがわかると思います。\u003c/p\u003e\n\u003cp\u003eまた、今回はローカルキャッシュの話のみでしたが、Turborepo には\u003ca href=\"https://turborepo.org/docs/features/remote-caching#vercel\"\u003eVercel\u003c/a\u003eや\u003ca href=\"https://turborepo.org/docs/features/remote-caching#custom-remote-caches\"\u003e独自\u003c/a\u003eにキャッシュを配置することで、同じハッシュのキャッシュがあった場合にそのキャッシュを使ってくれる\u003cstrong\u003eリモートキャッシュ\u003c/strong\u003eといった機能も Beta で用意されています。\u003c/p\u003e\n\u003cp\u003e今のプロジェクトが Yarn や npm の workspace を使っているのであれば、Turborepo を試しに入れてみてもいいかもしれません。\u003c/p\u003e\n","metaData":{"title":"workspaceを使ったコマンドを最適化して実行するTurborepoについて","author":"nus3","createdAt":"2022-01-17","summary":"Turborepoの機能について","tags":["Turborepo","Monorepo"],"updatedAt":"2022-01-17"}},{"slug":"release-firefox-95","content":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mozilla.org/en-US/firefox/95.0/releasenotes/\"\u003ehttps://www.mozilla.org/en-US/firefox/95.0/releasenotes/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/95\"\u003ehttps://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/95\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFirefox 95 がリリースされました。\n本アップデートでは RLBox という新しいコードサンドボックス機能が導入されて信頼できないコードに対する安全性が向上しました。\nまた、Firefox App から Slack.com の Huddle や Call 機能が利用できるようになったのは嬉しいですね。\u003c/p\u003e\n\u003ch2\u003eNew\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hacks.mozilla.org/2021/12/webassembly-and-back-again-fine-grained-sandboxing-in-firefox-95/\"\u003eRLBox\u003c/a\u003eが全てのプラットフォームで有効になりました\n\u003cul\u003e\n\u003cli\u003e信頼できないコードを WebAssembly を用いてネイティブコードへコンパイルすることで意図しない領域外へのメモリアクセスを防止する機能のようです\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hacks.mozilla.org/2021/12/webassembly-and-back-again-fine-grained-sandboxing-in-firefox-95/\"\u003emozilla hacks\u003c/a\u003eによれば、従来のプロセスを分割する手法における非同期化のオーバーヘッドやメモリフットプリントの増加を懸念した手法だと記載されていました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWindows 10 及び Windows 11 において Firefox App を Microsoft Store からダウンロードできるようになりました\u003c/li\u003e\n\u003cli\u003eブラウザクロームとツールバースクリーンショットがシンプルになりました\u003c/li\u003e\n\u003cli\u003emacOS において WindowsServer イベントの処理時の CPU 使用量が削減されました\u003c/li\u003e\n\u003cli\u003emacOS において主にフルスクリーン時のソフトウェアでコードされたビデオコンテンツの使用電力が削減されました\u003c/li\u003e\n\u003cli\u003ePiP のトグルボタンをビデオウィンドウの反対側にへ移動できるようになりました\u003c/li\u003e\n\u003cli\u003eSite Isolation が有効化されました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFixed\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFirefox を起動した際、JAWS や ZoomText が Firefox をフォーカスするようになりました\u003c/li\u003e\n\u003cli\u003eVoiceOver が ARIA の switch ロールの状態を正しく報告するようになりました\u003c/li\u003e\n\u003cli\u003emacOS でコンテンツプロセスの起動速度が速くなりました\u003c/li\u003e\n\u003cli\u003eメモリアロケータが改善されました\u003c/li\u003e\n\u003cli\u003eJavaScript を先行してコンパイルするようになり、ページロード時のパフォーマンスが改善されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eChanged\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSlack.com で Call や Huddles へアクセスできるように User Agent オーバーライドが追加されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDeveloper\u003c/h2\u003e\n\u003ch3\u003eFor web developers\u003c/h3\u003e\n\u003ch4\u003eHTML\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eグローバル属性 \u003ccode\u003einputmode\u003c/code\u003e が全てのプラットフォームでサポートされるようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eCSS\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eAndroid 版 Firefox で cursor プロパティがサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eAPIs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCrypt.randomUUID()\u003c/code\u003e 関数がサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eMedia, WebRTC, and Web Audio\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eSpeechSynthesisEvent.elapseTime\u003c/code\u003e がミリ秒ではなく秒単位の経過時間を返すようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eWebDriver Conformance (Marionette)\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eMarionette が使用しているポートがプロファイルディレクトリにある \u003ccode\u003eMarionetteActivePort\u003c/code\u003e ファイルに書き込まれるようになりました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:NewSession\u003c/code\u003e が最初のタブのロードが完了するまで待機するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFor add-on developers\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ebrowserSettings に \u003ccode\u003eoverrideContentColorScheme\u003c/code\u003e が追加され、\u003ccode\u003e.css.prefers-color-scheme.content.override\u003c/code\u003e という環境設定を制御することでブラウザのテーマとは独立したページ単位の優先的な配色を設定する機能が追加されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eunresolved\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eGmail のリンクをコマンドクリックしても新しいタブが開かない問題がありました\n\u003cul\u003e\n\u003cli\u003e回避策: Gmail のリンクをコマンドキーを利用せずにクリックすると新しいタブが開きます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"新しいコードサンドボックス機能 RLBox の追加など Firefox 95.0 リリースノートまとめ","author":"BaHo","createdAt":"2021-12-20","summary":"Firefox 95.0 のリリースノートの日本語まとめです","tags":["Releasenote","Browser"],"updatedAt":"2021-12-20"}},{"slug":"team-activity-logs-2021","content":"\u003cp\u003eこの記事は\u003ca href=\"https://adventar.org/calendars/6823\"\u003eCybozu Advent Calendar 2021\u003c/a\u003eの18日目の記事です（業務なので前日に出してます🍀）。\u003c/p\u003e\n\u003cp\u003eサイボウズには 10 年以上運用が続いているプロダクトがいくつかあります。フロントエンドエキスパートチームは、そんなプロダクトや開発メンバーへの支援を横断的に行うチームです。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームの今年の取り組みを紹介します。\u003c/p\u003e\n\u003ch2\u003eフロントエンドエキスパートチームの立ち位置とミッション\u003c/h2\u003e\n\u003cp\u003eフロントエンドエキスパートチームは特定のプロダクトなどに属さない、独立した横断的な支援チームです。活動内容についてはすべてチームに裁量があり、何をどうしていくかは自律的に決めて動く必要があります。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームでは「サイボウズのフロントエンドを最高にする」というミッションを掲げています。このミッションを達成するための活動を日々考えながら活動しています。\u003c/p\u003e\n\u003cp\u003e日々の活動は次の 4 つの内容を軸に行なっています。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e支援: プロダクトやチームへの支援\u003c/li\u003e\n\u003cli\u003e発信: Cybozu やメンバーのプレゼンス向上のための情報発信\u003c/li\u003e\n\u003cli\u003e啓蒙: 社内メンバーのフロントエンドの技術力向上のための啓蒙活動\u003c/li\u003e\n\u003cli\u003e探究: プロダクトの可能性を広げるための調査検証\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eこれら 4 つを軸に、\u003ccode\u003e支援:5\u003c/code\u003e \u003ccode\u003e発信\u0026#x26;啓蒙:2\u003c/code\u003e \u003ccode\u003e探究:3\u003c/code\u003e の割合を目安にメンバー個々人が裁量を持って活動しています。\u003c/p\u003e\n\u003cp\u003eチームは今月で 4 歳 2 ヶ月になります。\u003c/p\u003e\n\u003ch2\u003e活動内容まとめ\u003c/h2\u003e\n\u003cp\u003e今年は大小さまざまな取り組みを行いました。次のリストはフロントエンドエキスパートチームが行なった今年の活動内容のざっくりとしたまとめです。これらの活動はチームで自発的に始めた取り組みと、相談きっかけで行なったものがあります。割合としては自発的なものが 9 割、相談きっかけが 1 割程度です。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eプロダクトのフロントエンドリアーキテクチャ支援\u003c/li\u003e\n\u003cli\u003eプロダクトのマイクロサービス化を検証\u003c/li\u003e\n\u003cli\u003eプロダクトのライブラリアップデート支援\u003c/li\u003e\n\u003cli\u003eプロダクトへのフロントエンドのテスト環境整備支援\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.github.io/frontend-monthly/\"\u003eサイボウズフロントエンドマンスリー\u003c/a\u003eの開催\u003c/li\u003e\n\u003cli\u003e登壇\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nodejs.connpass.com/event/221358/\"\u003eNode 学園 37 時限目 オンライン\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web-study.connpass.com/event/213676/\"\u003etc39_study\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jsconf.jp/2021/\"\u003eJSConf JP 2021\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.connpass.com/event/212572/\"\u003eMeetup の開催\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eOSS へのコントリビューション\u003c/li\u003e\n\u003cli\u003e社内向けフロントエンド研修の開催\u003c/li\u003e\n\u003cli\u003eフロントエンドウィークリーの開催（社内向け勉強会）\u003c/li\u003e\n\u003cli\u003eエンジニアインターンの開催\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/search?q=%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%82%A8%E3%82%AD%E3%82%B9%E3%83%91%E3%83%BC%E3%83%88\"\u003eエンジニアブログへの記事投稿\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts\"\u003eチームの web サイトへの記事投稿\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eデザインシステムの探究\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eプロダクトの現状を見て、プロダクトや会社の今後の方向性などを加味した上で、取り組みの内容や注力する割合をコントロールしています。\u003c/p\u003e\n\u003cp\u003eその中からいくつかをピックアップして詳細を紹介します。\u003c/p\u003e\n\u003ch2\u003eプロダクトのフロントエンドリアーキテクチャをプロジェクト化するまで\u003c/h2\u003e\n\u003cp\u003eサイボウズでは現在、kinotne のフロントエンドのリアーキテクチャプロジェクトが進行中です。kintone の脱レガシーの取り組み自体は 2019 年ごろから開始されていましたが、1 つのプロジェクトとして動くようになったのは今年からです。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://blog.cybozu.io/entry/2021/07/20/170000\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003ch3\u003e少数チームでやれることに限界を感じた\u003c/h3\u003e\n\u003cp\u003eリアーキテクチャがプロジェクトになる前、kintone の脱レガシーはもともとフロントエンドエキスパートチームが主導・先行する形で調査検討を行っていました。Closure Tools というフレームワークに依存している現状に対して、脱 Closure Tools のロードマップを作成したり、Closure Tools を使い続けた場合の影響と今後の見通しについて社内各所に警鐘を鳴らすとともに、別のフレームワークへの置き換え方法についての PoC などを行なっていました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/04/07/110126\"\u003eフロントエンドの開発体験向上と脱レガシー\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/about-clutz\"\u003eClosure Library から TypeScript の型定義を生成する\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/06/25/105457\"\u003estyled-components の採用と既存資産を捨てた理由\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eそこから kintone の開発メンバーの一部とともに少しずつ React への置き換えを進めるようになりましたが、リソース的にできる範囲とスピードに課題感を抱えており、このままでは 5 年かかっても完了しないのではないかという不安がありました。\u003c/p\u003e\n\u003cp\u003eこの不安をどうやれば解消できるか、どうすればスピードアップできるかをチーム内で定期的に議論していろんな案を考えていました。\u003c/p\u003e\n\u003ch3\u003eプロダクトの課題を組織の課題にする\u003c/h3\u003e\n\u003cp\u003ekintone はサイボウズにとって大事なプロダクトで、そのプロダクトの内部の経年劣化は間違いなく組織にとっても課題です。10 年以上使い続けているフレームワークによる開発は限界に近づいてきていますが、この課題に対しての温度感がフロントエンドエキスパートとその他で大きな差がありました。\u003c/p\u003e\n\u003cp\u003eプロダクト側からすると新規機能の開発やバグ修正などの優先度が高くなりがちなので、脱レガシーにリソースを注力すると決めるのは難しいことだと理解はできます。また、プロダクトより上の層（サイボウズでは本部長などの経営に近い層）からするとゆっくりながらも進んでいるという事実からか、そこまで危機感は持っていないように感じられました。\u003c/p\u003e\n\u003cp\u003eそんな状況もあり、フロントエンドエキスパートチームとしては脱レガシーを組織の課題として、トップダウン的な動きで会社として注力する形でやっていきたいと考えました。しかしながらことはそう簡単ではなく、サイボウズは上長やマネージャーがいないという組織構造から、そういった大きな活動を起こすのに気力とコストを大いに必要としました。（現在この課題に対していろいろなトライを実施しており、解消に向かって進んでいます）\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームからの問題提起を根気強く続けながら、プロダクトのメンバーや本部長を交えてどういったチーム構成でどうリリースまで持っていくかなどさまざまな議論を重ねました。その結果、リアーキテクチャプロジェクトとして発足するに至り、組織の課題として取り組める状況まで持っていくことができました。\u003c/p\u003e\n\u003ch2\u003e横断的な支援チームで難しいと感じるところ\u003c/h2\u003e\n\u003cp\u003e支援チームで活動していく上で何度か感じた難しいところがあります。それは、外側からの働きかけだけではやれることが多くないということです。外側からいくら熱心に働きかけても支援先のプロダクトなりチームなりが自分ごととして動いてくれない限りは、その場限りの活動になりがちで支援の効果も一時的なものになってしまいます。\u003c/p\u003e\n\u003cp\u003eこういった実感からフロントエンドエキスパートチームでは、短中期で支援先の内部に入って活動するという方法を取ることが多くなりました。その場限りの支援にならないように仕組みを整えたり、初期段階のブースター役としてがっちりプロダクトチームに寄り添そうような形で支援できるように心がけています。支援したい対象はいくつもありますが、焦らずに 1 つずつ集中して解決していくのが支援チームとしてうまく動いていくのには重要だと思います。\u003c/p\u003e\n\u003cp\u003eまた、支援が一方的な押し付けにならないように、関わるメンバーにその支援活動の意味や意義を共感してもらうことに対して手を抜かないことも大事だと感じています。\u003c/p\u003e\n\u003ch2\u003e継続的な社内啓蒙と社外発信\u003c/h2\u003e\n\u003cp\u003e啓蒙・発信をチームの取り組みとして行なっています。社内勉強会として Frontend Weekly を、社外イベントとして Cybozu Frontend Monthly を継続して開催しています。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.github.io/frontend-expert/posts/frontendWeekly-And-Monthly\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eどちらも意識しているのは開催のコストを下げることです。司会を交代制にしたり、録画での開催を試したりと、常にコストを下げる工夫を行なっています。その結果、Frontend Weekly は 5 周年、Cybozu Frontend Monthly は 17 ヶ月連続で開催しています。\u003c/p\u003e\n\u003cp\u003eCybozu Frontend Monthly は多くの人に視聴してもらえており、中途入社のきっかけになったり、学生への認知向上といった効果も出ています。これからも無理しない範囲で続けていければと思います。\u003c/p\u003e\n\u003ch3\u003e社外発信のコストと心理的障壁を減らす\u003c/h3\u003e\n\u003cp\u003e今年はフロントエンドエキスパートチームの web サイト(このサイト)を作成して、そこでの情報発信をはじめました。サイボウズの技術ブログは他にもありますが、あちらはプロダクトでの知見を共有する場という側面が強かったり、ちゃんとしたものをそこそこのボリュームで出さなければという意識が働くといった意見がチーム内で出たりと、若干のハードルを感じる場所になっています。\u003c/p\u003e\n\u003cp\u003eチームの web サイトであれば、フロントエンドの情報に偏っていても問題なく、プロダクトに依存しない内容を気軽に発信できる場所として機能すると考えました。\u003c/p\u003e\n\u003cp\u003e記事の執筆は一見コストが高そうですが、フロントエンドエキスパートチームではもともと社内 SNS(kintone)に web の最新情報などを共有する活動を行なっていました。この情報を外向けに少し整える手間さえかければアウトプットが行えるので、記事作成のコストが低めで継続が見込めます。\u003c/p\u003e\n\u003cp\u003e今年の 10 月にサイトを開設してから 3 ヶ月で記事を 10 本投稿できていることから、今の所うまくいっているように思います。\u003c/p\u003e\n\u003ch2\u003eおわりに\u003c/h2\u003e\n\u003cp\u003e2021 年はフロントエンドエキスパートチームとして存在感と価値を発揮できた年だと感じています。地道な草の根活動からプロジェクト化へこぎつけたり、継続的な発信が行えていたりと、エキスパートチームらしい働きができたのかなと思います。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームの活動はチームメンバーだけでなく、プロダクトチームなどの協力があってこその活動も多いです。来年も関係各所と連携を取りつつ、着々と成果が出せるように取り組んで行きたいと思います。\u003c/p\u003e\n\u003cp\u003eフロントエンドの横断的支援チーム、フロントエンドのリアーキテクチャなどに興味がある方はカジュアル面談からでもぜひお願いします。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://meety.net/matches/TgEdHofmrGjd\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://meety.net/matches/arWAMFBPtzsm\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://meety.net/matches/phQxpBZQLDBO\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e応募もお待ちしております。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.co.jp/company/job/recruitment/list/front_end_expert.html\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.co.jp/company/job/recruitment/list/front_end_engineer_kintone.html\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n","metaData":{"title":"長期運用プロダクトを抱える組織で横断的なフロントエンド支援チームが1年で行なったこと","author":"nakajmg","createdAt":"2021-12-18","summary":"サイボウズのフロントエンドエキスパートチームの2021年の活動内容を紹介します。","tags":["Cybozu","FrontendExpert"],"updatedAt":"2021-12-18"}},{"slug":"frontendWeekly-And-Monthly","content":"\u003cp\u003eこの記事は、\u003ca href=\"https://adventar.org/calendars/6823\"\u003eCybozu Advent Calendar 2021\u003c/a\u003eの9日目の記事です。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eフロントエンドエキスパートチームでは、社内向けフロントエンド勉強会の「Frontend Weekly」と、社外向けフロントエンド情報発信イベントの「Cybozu Frontend Monthly」を運営しています。\u003c/p\u003e\n\u003cp\u003eこの度、Frontend Weeklyが5周年、Cybozu Frontend Monthlyが1周年を迎えました🎉\u003c/p\u003e\n\u003cp\u003e今回はそれぞれの各勉強会の内容と継続して開催してきた所感について紹介します。\u003c/p\u003e\n\u003ch2\u003eFrontend Weeklyとは？\u003c/h2\u003e\n\u003cp\u003eFrontend Weeklyは社内の有志が週ごとにフロントエンドの情報を持ち寄り、共有し合う会です。\u003c/p\u003e\n\u003cp\u003e次のように社内の\u003ca href=\"https://kintone.cybozu.co.jp/\"\u003ekintone\u003c/a\u003e上で情報が共有されています。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/frontendWeekly-And-Monthly/frontendWeekly.png\" alt=\"kintone上で情報が共有されている様子\" width=\"718\" height=\"640.4116638078901\" \u003e\u003c/p\u003e\n\u003cp\u003e各々が持ち寄った記事の他に、\u003ca href=\"https://twitter.com/azu_re\"\u003eazuさん\u003c/a\u003eが運営している\u003ca href=\"https://jser.info/\"\u003eJSer.info\u003c/a\u003eを読む時間を設けています。\u003c/p\u003e\n\u003cp\u003eFrontend Weeklyは、2016年3月にFrontend Weekly Lunchとしてスタートしました。その後、ランチの時間では社内メンバーの予定が合わなくなり、Frontend Weeklyとして毎週火曜日の夕方に開催されるようになりました。\u003c/p\u003e\n\u003cp\u003e上記のように開催形態が変わりつつも、2021年まで約5年間継続しています。\u003c/p\u003e\n\u003cp\u003e稀にゲスト招待も行っています。\u003c/p\u003e\n\u003ch2\u003e社内勉強会を継続開催してみた感想とメリット\u003c/h2\u003e\n\u003cp\u003eFrontend Weeklyは所属する組織・チームに関わらず、フロントエンドに興味ある社内メンバーが情報をキャッチアップできるきっかけの場になっています。ときには、社内の事情や歴史的経緯にも触れられ、情報に対する理解度が深まることもありました。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームは社内のフロントエンドを横断的に支援することが1つの役割になっています。この会を通して、チームと社内メンバーが繋がり、横断的な支援へのきっかけづくりになっています。\u003c/p\u003e\n\u003ch2\u003eCybozu Frontend Monthlyとは？\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/frontendWeekly-And-Monthly/cybozuFrontendMonthly-ogp.png\" alt=\"Cybozu Frontend Monthlyのアイキャッチ画像\" width=\"659\" height=\"229\" \u003e\u003c/p\u003e\n\u003cp\u003eCybozu Frontend Monthlyは、フロントエンドエキスパートチームが月末にフロントエンド情報を発信するオンラインイベントです。\u003c/p\u003e\n\u003cp\u003e*YouTubeの\u003ca href=\"https://www.youtube.com/watch?v=gujWyAmtzys\u0026#x26;list=PLPTndynQK4dxLZFEZgOZjt_zKG-0JWoWy\"\u003eアーカイブ一覧\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eコロナ禍によりフロントエンドエキスパートチームの社外発信が激減したことが、Cybozu Frontend Monthlyを開催するきっかけでした。\u003c/p\u003e\n\u003cp\u003e2020年7月に第1回目を開催し、2021年まで約1年間毎月開催することができています。\u003c/p\u003e\n\u003ch3\u003e社外勉強会を継続開催してみた感想とメリット\u003c/h3\u003e\n\u003cp\u003eCybozu Frontend Monthlyはオンライン開催なので、オフラインでは獲得できないフロントエンドエキスパートチームの認知を得ることができました。実際に、コロナ禍の影響でオフラインでの関わりを作ることが難しかったインターン応募者の方達から「Cybozu Frontend Monthlyがきっかけでチームを知った」と声を聞くこともありました\nまた、フロントエンドエキスパートチームに中途入社するきっかけがCybozu Frontend Monthlyだったこともあります。\u003c/p\u003e\n\u003cp\u003e*\u003ca href=\"https://nus3.com/fee-team/\"\u003eサイボウズのフロントエンドエキスパートチームに入った話\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2021年の途中からは他社のゲストの方を招いて開催もしました。\n社外のフロントエンドエンジニアと交流のきっかけになり、オンライン放送後の雑談会では、情報交換を行うことができました。\u003c/p\u003e\n\u003cp\u003eこれまでに公開した動画の再生回数は平均約500回程度と、多くの方に観ていただくことができました。\u003c/p\u003e\n\u003ch2\u003e勉強会を継続開催していくために工夫してきたこと\u003c/h2\u003e\n\u003cp\u003e勉強会を開催してきた中で一番大事だったことは、「継続すること」でした。\n社内勉強会の参加人数が少ないときは3人だったこともありますが、会を閉じずに開催することで、興味ある人が戻ってきました。継続していなければ、社内の場がなくなってしまい、機会がなくなるところでした。\u003c/p\u003e\n\u003cp\u003e継続開催するために、定期的に振り返りを行い、運営のコストを下げ、継続しやすい環境にする工夫をしてきました。\n具体的には次のような改善がありました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e司会を運営メンバーでローテーションする\u003c/li\u003e\n\u003cli\u003e準備を運営メンバーで分担する\u003c/li\u003e\n\u003cli\u003e開催時間を参加者しやすい時間にする\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまた、サイボウズには社外発信などのイベントをサポートしてくれる\u003ca href=\"https://blog.cybozu.io/entry/2020/12/24/110000\"\u003eコネクト支援\u003c/a\u003eチームがいます。このチームがCybozu Frontend Monthlyの配信周りをサポートしてくれたので、フロントエンドエキスパートチームはコンテンツ準備と当日オンライン上で話すことに集中することができました。\u003c/p\u003e\n\u003ch2\u003eおわりに\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://jser.info/\"\u003eJSer.info\u003c/a\u003e、技術記事をアウトプットしてくれている方、Frontend WeeklyとCybozu Frontend Monthlyのゲストに参加してくれた方、視聴者の方、多くの方達のおかげで継続ができています。ありがとうございます！\u003c/p\u003e\n\u003cp\u003eこれからも継続的に情報発信を続けていきます。\u003c/p\u003e\n","metaData":{"title":"Frontend Weekly5周年\u0026Cybozu Frontend Monthly1周年🎉 〜続けてみてのアレコレ〜","author":"sakito","createdAt":"2021-12-09","summary":"社内と社外向けのフロントエンド勉強会について","tags":["Announcement"],"updatedAt":"2021-12-09"}},{"slug":"strings-as-import-export","content":"\u003cp\u003e11 月 11 日に、以前から一部で注目されていた\u003ca href=\"https://github.com/tc39/ecma262/pull/2154\"\u003eある Pull Request\u003c/a\u003e が \u003ca href=\"https://github.com/tc39/ecma262\"\u003etc39/ecma262\u003c/a\u003e にマージされました。\u003c/p\u003e\n\u003cp\u003eこの Pull Request がマージされたことで、識別子ではなく文字列リテラルを使った import/export が可能になりました。\u003c/p\u003e\n\u003cp\u003eこの仕様変更はプロポーザルという形で扱われてはいませんが、構文上の影響があるので、JavaScript ユーザーとして知っておくに越したことはないものになります。\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eまず具体例を示します。\u003c/p\u003e\n\u003cp\u003e今回の変更によって、次のように import/export する際の名前として文字列リテラルを使えるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e foo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./module.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// foo\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e基本的にはこれだけです。\u003c/p\u003e\n\u003ch2\u003e詳解\u003c/h2\u003e\n\u003cp\u003eここからは仕様上の用語を使って解説をします。\u003c/p\u003e\n\u003cp\u003eこの変更が入る前の ECMAScript では \u003ca href=\"https://tc39.es/ecma262/#prod-ImportSpecifier\"\u003e\u003ccode\u003eImportSpecifier\u003c/code\u003e\u003c/a\u003e で \u003ccode\u003eas\u003c/code\u003e を使う場合 \u003ccode\u003eas\u003c/code\u003e の左側は \u003ca href=\"https://tc39.es/ecma262/#prod-IdentifierName\"\u003e\u003ccode\u003eIdentifierName\u003c/code\u003e\u003c/a\u003e でなければいけませんでした。\nまた \u003ca href=\"https://tc39.es/ecma262/#prod-ExportSpecifier\"\u003e\u003ccode\u003eExportSpecifier\u003c/code\u003e\u003c/a\u003e は、単一の \u003ccode\u003eIdentifierName\u003c/code\u003e もしくは、\u003ccode\u003eas\u003c/code\u003e を使う場合は \u003ccode\u003eas\u003c/code\u003e の左側と右側は両方とも \u003ccode\u003eIdentifierName\u003c/code\u003e でなければいけませんでした。\u003c/p\u003e\n\u003cp\u003e今回の変更によって、新たに \u003ca href=\"https://tc39.es/ecma262/#prod-ModuleExportName\"\u003e\u003ccode\u003eModuleExportName\u003c/code\u003e\u003c/a\u003e という構文が追加されました。\u003ccode\u003eModuleExportName\u003c/code\u003e は、\u003ccode\u003eIdentifierName\u003c/code\u003e もしくは \u003ca href=\"https://tc39.es/ecma262/#prod-StringLiteral\"\u003e\u003ccode\u003eStringLiteral\u003c/code\u003e\u003c/a\u003e の形をとります。\nたとえば、識別子 \u003ccode\u003efoo\u003c/code\u003e や 文字列リテラル \u003ccode\u003e\"😃 hey hey\"\u003c/code\u003e は \u003ccode\u003eModuleExportName\u003c/code\u003e です。\u003c/p\u003e\n\u003cp\u003eそして、\u003ccode\u003eImportSpecifier\u003c/code\u003e で \u003ccode\u003eas\u003c/code\u003e を使う場合 \u003ccode\u003eas\u003c/code\u003e の左側は \u003ccode\u003eModuleExportName\u003c/code\u003e の形をとるようになりました。したがって、次の例の \u003ccode\u003eimport\u003c/code\u003e 文はすべて構文として妥当です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e bar \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e baz \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eExportSpecifier\u003c/code\u003e は、単一の \u003ccode\u003eModuleExportName\u003c/code\u003e もしくは、 \u003ccode\u003eas\u003c/code\u003e を使う場合 \u003ccode\u003eas\u003c/code\u003e の左側と右側は両方とも \u003ccode\u003eModuleExportName\u003c/code\u003e の形をとるようになりました。したがって、次の例の \u003ccode\u003eexport\u003c/code\u003e 文はすべて構文として妥当です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token exports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token exports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e foo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e foo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eただし \u003ccode\u003eExportSpecifier\u003c/code\u003e の \u003ccode\u003eModuleExportName\u003c/code\u003e を \u003ccode\u003eStringLiteral\u003c/code\u003e にできるのは、その \u003ccode\u003eExportSpecifier\u003c/code\u003e を含む \u003ca href=\"https://tc39.es/ecma262/#prod-ExportDeclaration\"\u003e\u003ccode\u003eExportDeclaration\u003c/code\u003e\u003c/a\u003e に \u003ca href=\"https://tc39.es/ecma262/#prod-FromClause\"\u003e\u003ccode\u003eFromClause\u003c/code\u003e\u003c/a\u003e が存在する場合のみです。\u003c/p\u003e\n\u003cp\u003eたとえば、次のコードは \u003ccode\u003eExportDeclaration\u003c/code\u003e に \u003ccode\u003eFromClause\u003c/code\u003e が存在しないので \u003ccode\u003eExportSpecifier\u003c/code\u003e で \u003ccode\u003eStringLiteral\u003c/code\u003e を使うことはできません。\u003c/p\u003e\n\u003c!-- prettier-ignore --\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// できない\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e一方で、次のコードは \u003ccode\u003eFromClause\u003c/code\u003e が存在するので、\u003ccode\u003eExportSpecifier\u003c/code\u003e で \u003ccode\u003eStringLiteral\u003c/code\u003e を使うことができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// できる\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"😃 hey hey\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mod\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003e文字列の制約\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eStringLiteral\u003c/code\u003e は通常の JavaScript の文字列リテラルです。たとえば \u003ccode\u003e\"foo\"\u003c/code\u003e とか \u003ccode\u003e\"bar\"\u003c/code\u003e みたいな形をしたものです。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eModuleExportName\u003c/code\u003e は \u003ccode\u003eStringLiteral\u003c/code\u003e を含むので、全ての文字列リテラルを \u003ccode\u003eModuleExportName\u003c/code\u003e として使えるようにみえますが、実際には少々異なります。\u003ccode\u003eModuleExportName\u003c/code\u003e として使える \u003ccode\u003eStringLiteral\u003c/code\u003e には制限があります。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eModuleExportName\u003c/code\u003e として使える \u003ccode\u003eStringLiteral\u003c/code\u003e は、\u003ca href=\"https://www.unicode.org/glossary/#well_formed_code_unit_sequence\"\u003eWell-Formed Code Unit Sequence\u003c/a\u003e でなければいけません。\u003c/strong\u003e\nこのことは、\u003ca href=\"https://tc39.es/ecma262/#sec-module-semantics\"\u003eModule Semantics\u003c/a\u003e の Eary Errros 内の \u003ca href=\"https://tc39.es/ecma262/#_ref_6583\"\u003ehttps://tc39.es/ecma262/#_ref_6583\u003c/a\u003e に記載されています。\u003c/p\u003e\n\u003ch3\u003eWell-Formed Code Unit Sequence とは\u003c/h3\u003e\n\u003cp\u003eJavaScript の文字列は UTF-16 でエンコードされます。そのため、実際には JavaScript の文字列というのは 16 ビットの整数で表現される Unicode のコードユニットの並びでしかありません。\u003c/p\u003e\n\u003cp\u003eUTF-16 では基本的に 1 文字につき 16 ビットで表現されます。しかし、Unicode の BMP(基本多言語面)に収まらない文字は 16 ビットのコードユニットを二つ並べたペアで表現します。\u003c/p\u003e\n\u003cp\u003eたとえば、ひらがなの \u003ccode\u003eあ\u003c/code\u003e は BMP に含まれており、一つのコードユニット(\u003ccode\u003e0x3042\u003c/code\u003e)で表されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\u3042\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// あ\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e一方で、\u003ccode\u003e𠮟\u003c/code\u003e(\u003ccode\u003e叱\u003c/code\u003e ではないことに注意) は BMP に含まれないので、二つのコードユニット(\u003ccode\u003e0xD842\u003c/code\u003e と \u003ccode\u003e0xDF9F\u003c/code\u003e)で表されます。このようなコードユニットのペアを、サロゲートペアといいます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\uD842\\uDF9F\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 𠮟\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e前述のとおり、JavaScript の文字列は 16 ビットの整数で表現されるコードユニットの並びでしかありません。したがって、\u003ccode\u003e𠮟\u003c/code\u003e を構成する二つのコードユニットである \u003ccode\u003e0xD842\u003c/code\u003e と \u003ccode\u003e0xDF9F\u003c/code\u003e のうち一つだけを含む文字列も作ることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e str \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\\uD842\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、\u003ccode\u003e0xD842\u003c/code\u003e 単体に対応する文字は Unicode には存在しません。\u003c/p\u003e\n\u003cp\u003eこのような、\u003cstrong\u003e対になっていないサロゲートペアを含むような文字列は Well-Formed Code Unit Sequence ではありません。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e逆に、対になっていないサロゲートペアを許容しないような文字列を \u003cstrong\u003eWell-Formed Code Unit Sequence\u003c/strong\u003e といいます。つまり、大雑把にいえば「ちゃんと文字になっているコードユニットで構成された文字列」ということです。\u003c/p\u003e\n\u003cp\u003eちなみに、このような Well-Formed な文字列は WebIDL では \u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/USVString\"\u003eUSVString\u003c/a\u003e と呼ばれています。\u003c/p\u003e\n\u003ch3\u003e新しい Abstract Operation \u003ccode\u003eIsStringWellFormedUnicode\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eこの仕様の変更に伴って、\u003ca href=\"https://tc39.es/ecma262/#sec-isstringwellformedunicode\"\u003e\u003ccode\u003eIsStringWellFormedUnicode\u003c/code\u003e\u003c/a\u003e という新しい Abstract Operation が追加されました。\u003c/p\u003e\n\u003cp\u003eこの Abstract Operation は、引数の文字列が Well-Formed Code Unit Sequence かどうかを判定します。\u003c/p\u003e\n\u003cp\u003e前述した \u003ccode\u003eModuleExportName\u003c/code\u003e のための Early Errors では、この \u003ccode\u003eIsStringWellFormedUnicode\u003c/code\u003e Abstract Operation を使って \u003ccode\u003eStringLiteral\u003c/code\u003e が Well-Formed Code Unit Sequence かどうかの判定を行います。そしてもし Well-Formed Code Unit Sequence でなければ Syntax Error になります。\u003c/p\u003e\n\u003ch2\u003e仕様変更のモチベーション\u003c/h2\u003e\n\u003cp\u003e実はこの仕様の変更は、今の Web の仕様ではほとんど役に立つことはありません。\u003c/p\u003e\n\u003cp\u003eこの変更が行われたモチベーションは、\u003cstrong\u003e将来的に\u003c/strong\u003e WebAssembly の Module との相互運用性を向上させるためです。\u003c/p\u003e\n\u003cp\u003eこの背景を理解するために、おさえておくべき前提が二つあります。\u003c/p\u003e\n\u003cp\u003e１つ目は、WebAssembly の Module では関数を export するときに文字列で名前をつけるということです。\nたとえば次の例では \u003ccode\u003e$add\u003c/code\u003e という関数を \u003ccode\u003e\"add\"\u003c/code\u003e という名前で export しています。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-wasm\"\u003e\u003ccode class=\"language-wasm\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003emodule\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$add\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eparam\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$lhs\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eparam\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$rhs\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eresult\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elocal\u003c/span\u003e.get \u003cspan class=\"token variable\"\u003e$lhs\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elocal\u003c/span\u003e.get \u003cspan class=\"token variable\"\u003e$rhs\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ei32\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"add\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$add\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e２つ目は、WebAssembly の Module を JavaScript から import できるようにしたい、という動きがあるということです。\u003ca href=\"https://github.com/WebAssembly/esm-integration\"\u003eWebAsembly/esm-integration\u003c/a\u003e などで、その動きを見ることができます。\u003c/p\u003e\n\u003cp\u003e簡単にいえば、次のようにして簡単に WebAssembly の Module を JavaScript から扱えるようにしたいということです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e add \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo.wasm\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e現在の WebAssembly および ECMAScript の仕様では、このような形で JavaScript 側から WebAssembly の Module を読み込むことはできません。\u003c/p\u003e\n\u003cp\u003eこれらを前提として上で、次の例について考えます。\u003c/p\u003e\n\u003cp\u003eこの例は前述したものとほとんど変わりませんが、\u003ccode\u003eexport\u003c/code\u003e の後ろが \u003ccode\u003e\"add\"\u003c/code\u003e ではなく \u003ccode\u003e\"+\"\u003c/code\u003e になっています。\u003ccode\u003eexport\u003c/code\u003e の後ろには文字列を置くことができるので、これは妥当な Module です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-wasm\"\u003e\u003ccode class=\"language-wasm\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003emodule\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$add\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eparam\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$lhs\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eparam\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$rhs\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eresult\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elocal\u003c/span\u003e.get \u003cspan class=\"token variable\"\u003e$lhs\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elocal\u003c/span\u003e.get \u003cspan class=\"token variable\"\u003e$rhs\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ei32\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"+\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$add\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e将来、WebAssembly の Module を JavaScript から import できるようになったときに、このモジュールから \u003ccode\u003e+\u003c/code\u003e 関数を named import したいとします。\n\u003cstrong\u003eしかし、\u003ccode\u003e+\u003c/code\u003e は \u003ccode\u003eIdentifierName\u003c/code\u003e ではないので、今までの ECMAScript の仕様では named import できませんでした。\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// できない\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo.wasm\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// できない\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e add \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo.wasm\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回の変更によって \u003ccode\u003eImportSpecifier\u003c/code\u003e の \u003ccode\u003eas\u003c/code\u003e の左側に \u003ccode\u003eStringLiteral\u003c/code\u003e を置けるようになったことで、次のように書るようになりました。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// ES2022 でできる\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"+\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e add \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo.wasm\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのような書き方は ES2022 では構文上は妥当ですが、実際にはまだ WebAssembly の import はできません。\u003c/p\u003e\n\u003cp\u003eまた、\u003ccode\u003eModuleExportName\u003c/code\u003e の \u003ccode\u003eStringLiteral\u003c/code\u003e が Well-Formed Code Unit Sequence でなければならないという制約が存在するのも、WebAssembly との相互運用のためです。\nWebAssembly のテキストフォーマットで \u003ccode\u003eexport\u003c/code\u003e の後に続く文字列は Well-Formed Code Unit Sequence でなければいけないので、それと統一させたのでしょう。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/2154\"\u003eNormative: Arbitrary module namespace identifier names by bmeck · Pull Request #2154 · tc39/ecma262\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/master/meetings/2020-09/sept-21.md#arbitrary-strings-as-exportimport-names\"\u003eArbitrary module namespace identifier names · tc39/notes/notes/sept-21.md\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-import-reflection\"\u003etc39/proposal-import-reflection\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eBabel\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/babel/pull/13195\"\u003eParse string export names by default (\u003ccode\u003emoduleStringNames\u003c/code\u003e) by nicolo-ribaudo · Pull Request #13195 · babel/babel\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://babeljs.io/blog/2020/10/15/7.12.0#imports-and-exports-with-string-names-12091httpsgithubcombabelbabelpull12091\"\u003e7.12.0 Released: TypeScript 4.1, strings as import/export names, and class static blocks · Babel\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMDN\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Glossary/Identifier\"\u003eIdentifier (識別子) - MDN Web Docs 用語集: ウェブ関連用語の定義\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/USVString\"\u003eUSVString - Web API | MDN\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eECMA262\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-ImportSpecifier\"\u003eImportSpecifier · ECMAScript® 2022 Language Specification\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-ExportSpecifier\"\u003eExportSpecifier · ECMAScript® 2022 Language Specification\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-ModuleExportName\"\u003eModuleExportName · ECMAScript® 2022 Language Specification\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#sec-isstringwellformedunicode\"\u003eIsStringWellFormedUnicode · ECMAScript® 2022 Language Specification\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eUnicode\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.unicode.org/glossary/#well_formed_code_unit_sequence\"\u003eWell-Formed Code Unit Sequence · Glossary of Unicode Terms\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWebAssembly\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/WebAssembly/esm-integration\"\u003eWebAssembly/esm-integration: ECMAScript module integration\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://webassembly.github.io/spec/core/text/values.html#names\"\u003eValues — WebAssembly 1.1 (Draft 2021-12-02)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/WebAssembly/esm-integration/issues/39\"\u003eESM isn't suited for importing objects containing non-JavaScript identifiers · Issue #39 · WebAssembly/esm-integration\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"なぜ ES2022 で文字列リテラルを使った import/export ができるようになるのか","author":"sosukesuzuki","createdAt":"2021-12-06","summary":"ES2022 に含まれる予定の、識別子ではなく文字列リテラルを使って import/export できるようになる ECMAScript の仕様変更について解説します","tags":["ECMAScript"],"updatedAt":"2021-12-06"}},{"slug":"release-chrome-96","content":"\u003cp\u003eChrome 96 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-96/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-96/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-96/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-96/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-96/\"\u003ehttps://developer.chrome.com/blog/deps-rems-96/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D96\"\u003ehttps://www.chromestatus.com/features#milestone%3D96\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://v8.dev/blog/v8-release-96\"\u003ehttps://v8.dev/blog/v8-release-96\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 96)\u003c/h2\u003e\n\u003cp\u003eChrome 96で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eManifest id for PWAs\u003c/h3\u003e\n\u003cp\u003e今まではPWAをインストールする際、ブラウザ側でPWAを一意に識別するための明確な方法が存在しておらず、ブラウザの判断に委ねられていました。(実際ブラウザによってPWAマニフェストファイルの\u003ccode\u003estart_url\u003c/code\u003eが利用されていたり、マニフェストファイル自体のパスなどが利用されたりしています)\u003c/p\u003e\n\u003cp\u003e今回のアップデートにより、マニフェストファイル内でPWAの識別子を\u003ccode\u003eid\u003c/code\u003eプロパティとして明示的に定義できるようになりました。\u003c/p\u003e\n\u003cp\u003eマニフェストに\u003ccode\u003eid\u003c/code\u003eプロパティを追加すると、マニフェストファイルの\u003ccode\u003estart_url\u003c/code\u003eプロパティやマニフェストファイル場所へ依存がなくなり、これらのフィールドを更新することが容易になります。\u003c/p\u003e\n\u003ch4\u003eサポート状況と予定\u003c/h4\u003e\n\u003cp\u003eデスクトップのChromium搭載ブラウザ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eChrome 96からidプロパティがサポートされます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eモバイルブラウザ(マニフェストファイルのURLをユニークIDとして使用しているもの)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e2022年前半にサポートが開始される予定です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eidプロパティの追加について\u003c/h4\u003e\n\u003cp\u003eすでに運用しているPWAのマニフェストファイルにidを追加する場合\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eブラウザから割り当てられたIDを使用する必要があります。\u003c/li\u003e\n\u003cli\u003e割り当てられているID は、Dev Tools の \u003ccode\u003eApplication\u003c/code\u003e パネルの \u003ccode\u003eManifest\u003c/code\u003e ペインで確認できます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e新しくPWAを作成する場合\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eidプロパティに好きな文字列を設定することができますが、将来的に変更することはできないので慎重に選んでください。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eURL protocol handlers for PWAs\u003c/h3\u003e\n\u003cp\u003e今までwebページで利用可能だった\u003ccode\u003eURL protocol handler\u003c/code\u003eの登録がChrome 96からはPWAでもインストール時に行えるようになりました。\u003c/p\u003e\n\u003cp\u003ePWAの場合は以下のように\u003ccode\u003eprotocol_handlers\u003c/code\u003eプロパティをマニフェストファイルに記載することで登録できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  ...\n  \u003cspan class=\"token property\"\u003e\"protocol_handlers\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"protocol\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"web+tea\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"url\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"/tea?type=%s\"\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"protocol\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"web+coffee\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"url\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"/coffee?type=%s\"\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eそれぞれ、\u003ccode\u003eprotocol\u003c/code\u003eには登録したいプロトコル名を、\u003ccode\u003eurl\u003c/code\u003eにはそのプロトコルのURLをクリックしたときに開いてほしいURLを指定します。ただし、これらのプロトコル登録にはいくつかの制限があります。詳細や登録方法などは\u003ca href=\"https://web.dev/url-protocol-handler/\"\u003eこちら\u003c/a\u003eを参照してください。\u003c/p\u003e\n\u003ch3\u003ePriority hints (origin trial)\u003c/h3\u003e\n\u003cp\u003eブラウザがページ内リソース(\u003ccode\u003eimage\u003c/code\u003e,\u003ccode\u003escript\u003c/code\u003e,\u003ccode\u003eCSS\u003c/code\u003e)を読み込む際の優先度ヒントを追加できる機能がOrigin Trialsとして実験的に利用できるようになりました。\u003c/p\u003e\n\u003cp\u003e具体的には以下のような形で対象となるリソースに\u003ccode\u003eimportance\u003c/code\u003e属性で優先度(\u003ccode\u003ehigh\u003c/code\u003e,\u003ccode\u003elow\u003c/code\u003e,\u003ccode\u003eauto\u003c/code\u003eから選択)を指定します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token comment\"\u003e\u0026#x3C;!-- We don't want a high priority for this above-the-fold image --\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eimg\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003esrc\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e/not-important.svg\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eimportance\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003elow\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e\u0026#x3C;!-- Initiate an early fetch for a resource, but de-prioritize it --\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003elink\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003erel\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003epreload\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e/script.js\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eas\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003escript\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eimportance\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003elow\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n  \u003cspan class=\"token function\"\u003efetch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'https://example.com/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eimportance\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'high'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edata\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// Trigger a high priority fetch\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回のリリースノートでは Google Flights ページで、\u003ccode\u003ePriority hitns\u003c/code\u003e の有無におけるLCP(最大視覚コンテンツの表示時間)の比較を行った結果を紹介しています。この比較では背景画像の\u003ccode\u003eimg\u003c/code\u003eタグに対して\u003ccode\u003eimportance=\"high\"\u003c/code\u003eを指定することでLCPが 2.6s から 1.9s に向上したとしています。\u003c/p\u003e\n\u003cp\u003e機能詳細やOrigin Trialとして登録する方法、サンプルなどについては\u003ca href=\"https://web.dev/priority-hints/\"\u003eOptimizing resource loading with Priority Hints\u003c/a\u003eを参考にしてください。\u003c/p\u003e\n\u003ch3\u003eEmulate Chrome 100 in the UA string\u003c/h3\u003e\n\u003cp\u003e来年の早い段階でChromeはバージョン100がリリースされる予定であり、これ以降３桁のバージョン番号に突入します。そのため、バージョン番号を利用しているコードや\u003ccode\u003eUserAgent\u003c/code\u003eをパースしているコードが３桁のバージョン番号でも正しく動作することを保証する必要があります。\u003c/p\u003e\n\u003cp\u003eこれらを検証するためChrome 96では\u003ccode\u003e#force-major-version-to-100\u003c/code\u003eというフラグが追加されました。このフラグを有効にするとChromeのバージョンだけが100になった状態をシミュレートすることができ、バージョン番号を扱う動作に問題がないかの検証を行うことができます。\u003c/p\u003e\n\u003cp\u003e詳しくは \u003ca href=\"https://developer.chrome.com/blog/force-major-version-to-100/\"\u003eForce Chrome major version to 100 in the User-Agent string.\u003c/a\u003e を参照してください。\u003c/p\u003e\n\u003ch3\u003eChrome Dev Summit\u003c/h3\u003e\n\u003cp\u003eChrome Dev Summitにおけるすべての動画やコンテンツはオンラインで視聴可能です。詳しくは \u003ca href=\"https://developer.chrome.com/devsummit/\"\u003eChrome Dev Summit site\u003c/a\u003e をご覧ください。またkeynoteや配信を見逃した方はChrome Developers YouTube Channelの \u003ca href=\"https://www.youtube.com/playlist?list=PLNYkxOF6rcIBju4hD9ed1pt6YO20LgLWg\"\u003eCDS Playlist\u003c/a\u003e を合わせて参照してください。\u003c/p\u003e\n\u003ch3\u003eその他\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eBack/forward cache\u003c/code\u003eの機能が\u003ccode\u003estable\u003c/code\u003eになりました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eこれによりFireFoxやSafariと挙動を揃えることができるようになりました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWhat's New In DevTools (Chrome 96)\u003c/h2\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-96/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-96/\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eDeprecations and removals in Chrome 96\u003c/h2\u003e\n\u003cp\u003eChrome96で非推奨になったもの、もしくは削除されたものです\u003cbr\u003e\n\u003ca href=\"https://developer.chrome.com/blog/deps-rems-96/\"\u003ehttps://developer.chrome.com/blog/deps-rems-96/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eThe \"basic-card\" method of PaymentRequest API\u003c/h3\u003e\n\u003cp\u003ePaymentRequestを呼び出すときに指定できる\u003ccode\u003ebasic card\u003c/code\u003emethod(ブラウザで保存されているカード情報を使う方法)が非推奨になります。\u003c/p\u003e\n\u003cp\u003eChrome 96では\u003ccode\u003ebasic card\u003c/code\u003eを使っているとDevToolsのConsoleにwarningメッセージが表示されます。また、Chrome 100では利用できなくなります。\u003ccode\u003ebasic card\u003c/code\u003eを使っている場合は別のmethodに変更するように早めに対応したほうが良さそうです。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.chromium.org/2021/10/sunsetting-basic-card-payment-method-in.html\"\u003ehttps://blog.chromium.org/2021/10/sunsetting-basic-card-payment-method-in.html\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eその他Chrome Platform Statusに記載されていたもの\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D96\"\u003ehttps://www.chromestatus.com/features#milestone%3D96\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eAdding captureTimestamp and senderCaptureTimeOffset to RTCRtpContributingSource.\u003c/h3\u003e\n\u003cp\u003eWebRTC APIの一つである\u003ccode\u003eRTCRtpContributingSource\u003c/code\u003eにオーディオとビデオフレームの同期やend-to-endの遅延が測定できる\u003ccode\u003ecaptureTimestamp\u003c/code\u003eと\u003ccode\u003esenderCaptureTimeOffset\u003c/code\u003eプロパティが追加されます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5728533701722112\"\u003ehttps://www.chromestatus.com/feature/5728533701722112\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eCSS @counter-style descriptor 'speak-as'\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e@counter-style\u003c/code\u003eを使った際にカウンターが音声形式でどのように表されるかを指定できるプロパティ\u003ccode\u003espeak-as\u003c/code\u003eが追加予定で、現状は\u003ccode\u003eIn developer trial\u003c/code\u003eで試験運用中です。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5687059677184000\"\u003ehttps://www.chromestatus.com/feature/5687059677184000\u003c/a\u003e\n\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@counter-style/speak-as\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/@counter-style/speak-as\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eClipboard: Preserve PNG metadata\u003c/h3\u003e\n\u003cp\u003eクリップボードからPNGを読み込む際にサニタイズされなくなります。\n(前まではメタデータを削除していました)\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5629962485760000\"\u003ehttps://www.chromestatus.com/feature/5629962485760000\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eCross-Origin-Embedder-Policy: credentialless\u003c/h3\u003e\n\u003cp\u003eCOEPに\u003ccode\u003ecredentialless\u003c/code\u003eが追加できるようになりました。\n\u003ccode\u003ecredentialless\u003c/code\u003eを指定するとサーバーへのリクエスト時に認証方法(CookieやAuthorizationヘッダなど)が省かれるようになります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/4918234241302528\"\u003ehttps://www.chromestatus.com/feature/4918234241302528\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考: SharedArrayBuffer と過渡期な cross-origin isolation の話\n\u003ca href=\"https://blog.agektmr.com/2021/11/cross-origin-isolation.html\"\u003ehttps://blog.agektmr.com/2021/11/cross-origin-isolation.html\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eDisable propagation of body style to viewport when contained\u003c/h3\u003e\n\u003cp\u003eルートやbody要素に\u003ccode\u003econtain: none\u003c/code\u003e以外の値を使用するとbodyからのCSSプロパティの伝搬が無効になります。\n\u003ca href=\"https://www.chromestatus.com/feature/5663240823504896\"\u003ehttps://www.chromestatus.com/feature/5663240823504896\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eEME MediaKeySession Closed Reason\u003c/h3\u003e\n\u003cp\u003eMediaKeySessionのcloseメソッドが\u003ccode\u003eMediaKeySessionClosedReason\u003c/code\u003eを返すようになります。\nsessionが閉じられた理由(\u003ccode\u003einternal-error\u003c/code\u003e, \u003ccode\u003eclosed-by-application\u003c/code\u003eなど)を取得してハンドリングできるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e keySystemAccess \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003enavigator\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003erequestMediaKeySystemAccess\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e//   ...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Create media keys.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e mediaKeys \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e keySystemAccess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateMediaKeys\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Create a key session.\u003c/span\u003e\nkeySession \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e mediaKeys\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateSession\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Generate a fake license request.\u003c/span\u003e\n\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e keySession\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egenerateRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"webm\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUint8Array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\nkeySession\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eclosed\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ereason\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Reason is either undefined if not supported, \"internal-error\",\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// \"closed-by-application\", \"release-acknowledged\",\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// \"hardware-context-reset\", or \"resource-evicted\".\u003c/span\u003e\n\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eMedia key session was closed. Reason: \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ereason\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\".\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5632124143009792\"\u003ehttps://www.chromestatus.com/feature/5632124143009792\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考: EME MediaKeySession Closed Reason Sample\n\u003ca href=\"https://googlechrome.github.io/samples/media/key-session-closed-reason.html\"\u003ehttps://googlechrome.github.io/samples/media/key-session-closed-reason.html\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eHTTP-\u003eHTTPS redirect for HTTPS DNS records\u003c/h3\u003e\n\u003cp\u003eDNSのHTTPSレコードを従来のAレコードやAAAAレコードと一緒に照会し、解析するようになります。\nHTTPSレコードを追加し、Chromeがそれを受信するとChromeは常にそのウェブサイトにHTTPSで接続します。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5485544526053376\"\u003ehttps://www.chromestatus.com/feature/5485544526053376\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eInteractionID in EventTiming\u003c/h3\u003e\n\u003cp\u003eEvent Timing APIのPerformanceEventTimingに\u003ccode\u003einteractionId\u003c/code\u003eが追加されました。\nユーザーの操作に対して関連するイベント(たとえばユーザーがタップした時にはpointerdown→mousedown→pointerup→mouseup→clickのイベントが発生する)は\u003ccode\u003einteractionId\u003c/code\u003eが同じになります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5674224959094784\"\u003ehttps://www.chromestatus.com/feature/5674224959094784\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eMedia Queries: prefers-contrast feature\u003c/h3\u003e\n\u003cp\u003eOSが設定している色のコントラスト設定に対応するメディアクエリ\u003ccode\u003eprefers-contrast\u003c/code\u003eが追加されました。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* ... */\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003eprefers-contrast\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e more\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* OSでコントラストの設定が高い場合に適応される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003eprefers-contrast\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e less\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* OSでコントラストの設定が低い場合に適応される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5646323212615680\"\u003ehttps://www.chromestatus.com/feature/5646323212615680\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考: prefers-contrast(MDN)\u003cbr\u003e\n\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/@media/prefers-contrast\"\u003ehttps://developer.mozilla.org/ja/docs/Web/CSS/@media/prefers-contrast\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eSupport calc(\u003ccode\u003e\u0026#x3C;number\u003e\u003c/code\u003e) where only accepts \u003ccode\u003e\u0026#x3C;integer\u003e\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003ecssの\u003ccode\u003ecalc()\u003c/code\u003e関数でintegerしか受け取らないような場所でもnumberを指定できるようになりました。\nもっとも近い整数に丸められます。\u003c/p\u003e\n\u003cp\u003e例えば、下記はいずれも\u003ccode\u003ecolumn-count: 1\u003c/code\u003eと同義です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.example\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolumn-count\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003ecalc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1.2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolumn-count\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003ecalc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0.6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5656451751084032\"\u003ehttps://www.chromestatus.com/feature/5656451751084032\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考:\n\u003ca href=\"https://drafts.csswg.org/css-values-4/#calc-range\"\u003ehttps://drafts.csswg.org/css-values-4/#calc-range\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eV8 release v9.6\u003c/h2\u003e\n\u003cp\u003eV8のアップデート情報です。\u003c/p\u003e\n\u003ch3\u003eWebAssembly : Reference Types\u003c/h3\u003e\n\u003cp\u003eWebWebAssemblyでプロポーザルとして提案されている\u003ca href=\"https://github.com/WebAssembly/reference-types/blob/master/proposals/reference-types/Overview.md\"\u003eReference Type\u003c/a\u003eがV8 v9.6からサポートされます。\n現状、WASMの関数は引数や戻り値に、整数や浮動小数点数といったプリミティブな型しか扱えませんが、\u003ccode\u003eReference Types\u003c/code\u003e機能はこれに加えて、JavaScriptオブジェクトへの参照を渡せるようにしたものです。\u003c/p\u003e\n","metaData":{"title":"Chrome 96 リリースノートまとめ","author":"Saji","editor":"nus3","createdAt":"2021-12-02","summary":"Chrome 96 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2021-12-02"}},{"slug":"storybook-interactive-stories","content":"\u003cp\u003e\u003ca href=\"https://github.com/storybookjs/storybook/releases/tag/v6.4.0\"\u003eStorybook の 6.4.0 がリリース\u003c/a\u003eされ、\u003ccode\u003eInteractive stories\u003c/code\u003eが新機能として追加されました。詳細は\u003ca href=\"https://storybook.js.org/blog/interactive-stories-beta/\"\u003eStorybook のブログ\u003c/a\u003eでも記載されています。\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eInteractive stories の Addon を追加すると、testing-library で定義した操作を Storybook 上で確認することができるようになります。\u003c/p\u003e\n\u003cp\u003e次の gif のようにユーザー操作に対するコンポーネントの状態を UI(Addon)からステップごとに確認できます。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/storybook-interactive-stories/capture.gif\" alt=\"Interactive addonを使った例\" width=\"360\" height=\"240\" \u003e\u003c/p\u003e\n\u003ch2\u003e導入手順\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eパッケージを追加する\u003c/li\u003e\n\u003cli\u003eStorybook の\u003ccode\u003emain.js\u003c/code\u003eに設定を追加する\u003c/li\u003e\n\u003cli\u003eInteractive stories 用の story を\u003ccode\u003estories.tsx\u003c/code\u003eに追加する\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e1. パッケージを追加する\u003c/h3\u003e\n\u003cp\u003eInteractive addon を利用するには次のパッケージが必要です。\u003cbr\u003e\n(今回は React のコンポーネントを対象としています)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e@storybook/addon-interactions\u003c/li\u003e\n\u003cli\u003e@storybook/react\u003c/li\u003e\n\u003cli\u003e@storybook/testing-library\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e次のコマンドを実行してインストールします。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enpm i -D @storybook/addon-interactions @storybook/react @storybook/testing-library\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e今回試したバージョンは次になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@storybook/addon-interactions\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"6.4.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@storybook/react\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"6.4.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@storybook/testing-library\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.7\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e2. Storybook の\u003ccode\u003emain.js\u003c/code\u003eに設定を追加する\u003c/h3\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003emodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  stories\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"../src/components/**/**/*.stories.@(js|jsx|ts|tsx)\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  addons\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"@storybook/addon-interactions\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// addonの追加\u003c/span\u003e\n  features\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    interactionsDebugger\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Interactive storiesをaddonで1ステップずつ確認できるようにするのに必要\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e3. Interactive stories 用の story を\u003ccode\u003estories.tsx\u003c/code\u003eに追加する\u003c/h3\u003e\n\u003cp\u003e例えば、次のサンプルコードでは Storybook 上にマウントされたコンポーネントに対して、\u003ccode\u003eAdd\u003c/code\u003eのラベルがついたボタンを 4 回クリックした後に\u003ccode\u003eReset\u003c/code\u003eのボタンをクリックする story を\u003ccode\u003e@storybook/testing-library\u003c/code\u003eを使って追加しています。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-tsx\"\u003e\u003ccode class=\"language-tsx\"\u003e\u003cspan class=\"token comment\"\u003e// Interactive storiesに関係ある部分しか記載してません\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e within\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e userEvent \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"@storybook/testing-library\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eTemplate\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eStory\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eExampleComponentProps\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eargs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token class-name\"\u003eExampleComponent\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token spread\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e...\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003eargs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDefault\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eTemplate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ebind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token maybe-class-name\"\u003eDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method-variable function-variable method function property-access\"\u003eplay\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e canvasElement \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e canvas \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ewithin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvasElement\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userEvent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetByRole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Add\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userEvent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetByRole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Add\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userEvent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetByRole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Add\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userEvent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetByRole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Add\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userEvent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecanvas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetByRole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Reset\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eDefault.play = async ({ canvasElement }) =\u003e {\u003c/code\u003eは Storybook6.4 でサポートされる\u003ca href=\"https://storybook.js.org/blog/component-story-format-3-0/\"\u003eCSF3\u003c/a\u003eの構文です。\u003cbr\u003e\nまた、まだ v0.5 ですが Storybook から\u003ca href=\"https://github.com/storybookjs/eslint-plugin-storybook\"\u003eeslint-plugin\u003c/a\u003eも提供されているので、併せて試してみても良さそうです。\u003c/p\u003e\n\u003cp\u003eInteractive stories の addon を追加した Storybook を GitHub Pages でホスティングしたので、実際に触ってみたい方は次のリンクへ。\u003cbr\u003e\n\u003ca href=\"https://nus3.github.io/p-storybook/?path=/story/components-examplecomponent--default\"\u003ehttps://nus3.github.io/p-storybook/?path=/story/components-examplecomponent--default\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eStorybook 上で複雑な操作があるコンポーネントのデバッグや共有がしやすくなりそうですね。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://storybook.js.org/blog/interactive-stories-beta/\"\u003ehttps://storybook.js.org/blog/interactive-stories-beta/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://storybook.js.org/blog/component-story-format-3-0/\"\u003ehttps://storybook.js.org/blog/component-story-format-3-0/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nus3/p-storybook\"\u003e実際に実装したリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"Interactive storiesを使ってStorybook上でユーザー操作の状態を確認する","author":"nus3","editor":["nakajmg","sakito"],"createdAt":"2021-11-29","summary":"Storybookに新しく追加されたInteractive storiesについて紹介します","tags":["Storybook"],"updatedAt":"2021-11-29"}},{"slug":"release-chrome-95","content":"\u003cp\u003eChrome 95 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-95/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-95/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-95/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-95/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-95/\"\u003ehttps://developer.chrome.com/blog/deps-rems-95/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D95\"\u003ehttps://www.chromestatus.com/features#milestone%3D95\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eRouting with URLPattern\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eURLPattern\u003c/code\u003eという機能が追加されました。現在は Chrome、Edge の 95 以上に対応しています。\u003c/p\u003e\n\u003cp\u003e他のブラウザや Node.js ではまだサポートされていない機能ですが、\u003ca href=\"https://github.com/kenchris/urlpattern-polyfill\"\u003eurlpattern-polyfill\u003c/a\u003eで polyfill できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e pattern \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eURLPattern\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e pathname\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"/books/:id\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epattern\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"https://example.com/books/123\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epattern\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eexec\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"https://example.com/books/123\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epathname\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003egroups\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// { id: '123' }\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 引数で渡せる全てのプロパティ\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e p \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eURLPattern\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  protocol\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"http{s}?\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  username\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":username\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  password\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":password\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  hostname\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":subdomain.example.com\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  port\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":port(80|443)\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  pathname\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"/:path\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  search\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  hash\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e詳細はこちら\n\u003ca href=\"https://web.dev/urlpattern/\"\u003ehttps://web.dev/urlpattern/\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003ePicking colors with the Eye Dropper API\u003c/h2\u003e\n\u003cp\u003eカラーを取得する Eye Dropper API が追加されました\u003c/p\u003e\n\u003cp\u003e詳細はこちらの記事で解説しています。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/eyedropper-api\"\u003eChrome 95 で追加された画面上の色を取得する EyeDropper API について\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003ePWA Summit\u003c/h2\u003e\n\u003cp\u003e10 月 6~7 日に PWA Summit が開催されてました\u003cbr\u003e\n見逃した方はアーカイブが下記のリンクに残ってるので、そこから確認できます\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pwasummit.org/\"\u003ehttps://pwasummit.org/\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://www.youtube.com/channel/UC1j3gvdVISAEO1_2MwA5oQw/videos\"\u003ehttps://www.youtube.com/channel/UC1j3gvdVISAEO1_2MwA5oQw/videos\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eUser-agent reduction origin trial\u003c/h2\u003e\n\u003cp\u003eOrigin Trial で実際に User-Agent の文字列が削減された後の挙動が試せます\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://web.dev/user-agent-client-hints/\"\u003eUser-Agent Client Hints によるユーザーのプライバシーと開発者体験の改善\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers-jp.googleblog.com/2021/09/chrome-user-agent.html\"\u003eUser-Agent Reduction origin trial(日本語訳)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eAnd more!\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eStorage Foundation API を origin trial で試せます\u003c/li\u003e\n\u003cli\u003eWebAssembly で例外処理のサポートが提供され、例外がスローされたときにコードが中断できるようになります\u003c/li\u003e\n\u003cli\u003eChrome 100 が来年きます。バージョンが 2 桁から 3 桁になるので、自分のコードに何らかの影響があるかどうかを確認するといいかもしれません\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDevTools\u003c/h2\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-95/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-95/\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eDeprecations and removals in Chrome 95\u003c/h2\u003e\n\u003cp\u003eChrome 95 で非推奨になったもの、もしくは削除されたものです。\u003c/p\u003e\n\u003ch3\u003eSupport for URLs with non-IPv4 hostnames ending in numbers\u003c/h3\u003e\n\u003cp\u003e有効な IPv4 アドレスではない、 \u003ccode\u003ehttp://foo.127.1/\u003c/code\u003e のような数字で終わる host name を持つ URL が拒否されるようになります。\u003c/p\u003e\n\u003cp\u003e社内のプレビュー環境などで IP アドレスをポストフィックスとして利用してたりする場合は影響がでているかもしれません。\u003c/p\u003e\n\u003ch3\u003eWebAssembly cross-origin module sharing\u003c/h3\u003e\n\u003cp\u003ecross-originでsame-siteな環境間でのWebAssemblyモジュールの共有が非推奨になりました\n\u003ca href=\"https://www.chromestatus.com/feature/5650158039597056\"\u003ehttps://www.chromestatus.com/feature/5650158039597056\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e合わせてこちらも参考にしてください\u003cbr\u003e\n\u003ca href=\"https://developer.chrome.com/blog/wasm-module-sharing-restricted-to-same-origin/\"\u003eRestricting Wasm module sharing to same-origin\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eDeprecate U2F API (Cryptotoken)\u003c/h3\u003e\n\u003cp\u003eU2F API が非推奨になり、Chrome 98 からはデフォルトで無効になります。\u003c/p\u003e\n\u003cp\u003eU2F とはなんぞやという人はこちらの記事が参考になります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.jxck.io/entries/2018-05-15/webauthentication-api.html\"\u003eWeb Authentication API で FIDO U2F(YubiKey) 認証 | blog.jxck.io\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone=95\"\u003ehttps://www.chromestatus.com/features#milestone=95\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003eBack-forward cache for same-site navigations on Android\u003c/h3\u003e\n\u003cp\u003eChrome 86 から origin trial で試せていた Android での戻る/進むのキャッシュが same-site で効くようになりました。\u003cbr\u003e\n\u003ca href=\"https://www.chromestatus.com/feature/5694778600587264\"\u003ehttps://www.chromestatus.com/feature/5694778600587264\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ebfcache(Back/forward cache)については下記に詳細の説明が載っています。\u003cbr\u003e\n\u003ca href=\"https://web.dev/bfcache/\"\u003ehttps://web.dev/bfcache/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eCSS @counter-style rules in shadow trees\u003c/h3\u003e\n\u003cp\u003eShadow tree に対してカスタムの counter-style を定義することができるようになりました。\u003cbr\u003e\n\u003ca href=\"https://www.chromestatus.com/feature/5716198446596096\"\u003ehttps://www.chromestatus.com/feature/5716198446596096\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e@counter-style\u003c/code\u003eについては下記を参考ください\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@counter-style\u003c/span\u003e circled-alpha\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003esystem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e fixed\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003esymbols\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e Ⓐ Ⓑ Ⓒ Ⓓ Ⓔ Ⓕ Ⓖ Ⓗ Ⓘ Ⓙ Ⓚ Ⓛ Ⓜ Ⓝ Ⓞ Ⓟ Ⓠ Ⓡ Ⓢ Ⓣ Ⓤ Ⓥ Ⓦ Ⓧ Ⓨ Ⓩ\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003esuffix\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.items\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003elist-style\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e circled-alpha\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのスタイルを当てた list を作ると次のようなリストができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003eⒶ One\nⒷ Two\nⒸ Three\nⒹ Four\nⒺ FIve\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/@counter-style#specifying_symbols_with_counter-style\"\u003ehttps://developer.mozilla.org/ja/docs/Web/CSS/@counter-style#specifying_symbols_with_counter-style\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eCookie size limits\u003c/h3\u003e\n\u003cp\u003eSet-Cookie header、及び、document.cookie、CookieStore で設定される Cookie のサイズが制限されます。\n具体的には Cookie の名前と値の合計が 4096 バイトまでになり、Cookie の各属性値は 1024 バイトに制限する必要があります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/4946713618939904\"\u003ehttps://www.chromestatus.com/feature/4946713618939904\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eLogical properties for contain-intrinsic-size\u003c/h3\u003e\n\u003cp\u003econtain-intrinsic-size を省略した次の表記が追加されます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003econtain-intrinsic-{width,height}\u003c/li\u003e\n\u003cli\u003econtain-intrinsic-{inline,block}-size\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5709654999957504\"\u003ehttps://www.chromestatus.com/feature/5709654999957504\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://drafts.csswg.org/css-sizing-4/#intrinsic-size-override\"\u003ehttps://drafts.csswg.org/css-sizing-4/#intrinsic-size-override\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003econtain-intrinsic-size\u003c/h3\u003e\n\u003cp\u003econtent-visibility で指定された要素の自然なサイズを制御するプロパティです。\u003c/p\u003e\n\u003cp\u003e次の実装は画面外の section のレンダリングをスキップする例です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n\u003cspan class=\"token selector\"\u003esection\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003econtent-visibility\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e auto\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003econtain-intrinsic-size\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token unit\"\u003epx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eビューポート外のコンテンツはレンダリングされなくなります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/content-visibility\"\u003ehttps://developer.mozilla.org/ja/docs/Web/CSS/content-visibility\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eNew UA platform version source on Windows for User-Agent Client Hints\u003c/h3\u003e\n\u003cp\u003eWindows の Sec-CH-UA-Platform-Version(User-Agent Client Hints)で返されるバージョンが Windows プラットフォームの違いを識別できるように更新されました。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5080939765956608\"\u003ehttps://www.chromestatus.com/feature/5080939765956608\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/WICG/ua-client-hints/issues/220#issuecomment-870858413\"\u003ehttps://github.com/WICG/ua-client-hints/issues/220#issuecomment-870858413\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eNote taking new note URL\u003c/h3\u003e\n\u003cp\u003eWeb Application Manifest が \u003ccode\u003enote_taking\u003c/code\u003e と \u003ccode\u003enew_note_url\u003c/code\u003e に対応しました。\nWeb Application 側から新しいメモを書きたい時にユーザーエージェントに読み込ませたい URL を指定できるようになります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5205972320518144\"\u003ehttps://www.chromestatus.com/feature/5205972320518144\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://wicg.github.io/manifest-incubations/index.html#note_taking-member\"\u003ehttps://wicg.github.io/manifest-incubations/index.html#note_taking-member\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eSecure payment confirmation\u003c/h3\u003e\n\u003cp\u003eWebAuthn を利用して、Web 上での支払い時の認証を強化することができるようになります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5702310124584960\"\u003ehttps://www.chromestatus.com/feature/5702310124584960\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e※ Payment Request API で簡単・高速な決済を実現する\n\u003ca href=\"https://developers.google.com/web/updates/2016/07/payment-request?hl=ja\"\u003ehttps://developers.google.com/web/updates/2016/07/payment-request?hl=ja\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e※ PaymentRequestAPI で secure-payment-confirmation を使った実装例\n\u003ca href=\"https://www.w3.org/TR/2021/WD-secure-payment-confirmation-20210831/#sctn-sample-authentication\"\u003ehttps://www.w3.org/TR/2021/WD-secure-payment-confirmation-20210831/#sctn-sample-authentication\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003edroppedEntriesCount in PerformanceObserver callback\u003c/h3\u003e\n\u003cp\u003ePerformanceObserver のコールバックに droppedEntriesCount が追加されます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/feature/5320666234486784\"\u003ehttps://www.chromestatus.com/feature/5320666234486784\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ePerformanceObserver\u003cbr\u003e\n\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/PerformanceObserver\"\u003ehttps://developer.mozilla.org/ja/docs/Web/API/PerformanceObserver\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eself.reportError()\u003c/h3\u003e\n\u003cp\u003eキャッチされない例外をレポートする\u003ccode\u003eself.reportError()\u003c/code\u003eが追加されます。\n\u003ca href=\"https://www.chromestatus.com/feature/5634523220934656\"\u003ehttps://www.chromestatus.com/feature/5634523220934656\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e以下のコードを実行するとerrorはcatchで握り潰されずに\u003ccode\u003eUncaught Error: foo\u003c/code\u003eになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eaddition\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ea\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e b\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ea \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereportError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e b\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003ecount\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ea\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e b\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e callback\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003ecallback\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ea\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e b\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e addition\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://html.spec.whatwg.org/#runtime-script-errors\"\u003ehttps://html.spec.whatwg.org/#runtime-script-errors\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"Chrome 95 リリースノートまとめ","author":"nus3","editor":"nakajmg","createdAt":"2021-11-17","summary":"Chrome 95 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2021-11-17"}},{"slug":"release-safari-15","content":"\u003cp\u003e先日 Safari 15 がリリースされました。\n\u003ca href=\"https://webkit.org/blog/11989/new-webkit-features-in-safari-15/\"\u003ehttps://webkit.org/blog/11989/new-webkit-features-in-safari-15/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e影響の大きそうな箇所や、知っておいたほうが良さそうな箇所を中心に紹介します。\u003c/p\u003e\n\u003ch2\u003eHTML\u003c/h2\u003e\n\u003ch3\u003etheme-color\u003c/h3\u003e\n\u003cp\u003emeta タグ上での \u003ccode\u003etheme-color\u003c/code\u003e のサポートが追加されました。\n指定することで、ブラウザのメニューバーやタブバーといった領域のカラーを変更することができます。 \u003ccode\u003eprefers-color-scheme\u003c/code\u003e と併用することで、ダークモード/ライトモードに応じた色の指定もできます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.apple.com/videos/play/wwdc2021/10029/\"\u003eDesign for Safari 15\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eCSS\u003c/h2\u003e\n\u003ch3\u003e\u003ccode\u003easpect-ratio\u003c/code\u003e プロパティのサポート\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio\"\u003easpect-ratio - CSS: Cascading Style Sheets | MDN\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003e\u003ccode\u003elab()\u003c/code\u003e \u003ccode\u003elch()\u003c/code\u003e \u003ccode\u003ehwb()\u003c/code\u003e シンタックスのサポート\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.w3.org/TR/css-color-4/\"\u003eW3C Color Module Level 4\u003c/a\u003eに沿った新しいカラーシンタックス \u003ccode\u003elab()\u003c/code\u003e \u003ccode\u003elch()\u003c/code\u003e \u003ccode\u003ehwb()\u003c/code\u003e が利用可能になりました。\u003c/p\u003e\n\u003ch3\u003elist-style-type に設定可能な値が追加\u003c/h3\u003e\n\u003cp\u003eli 要素など、リストアイテム要素のマーカーを指定するための \u003ccode\u003elist-style-type\u003c/code\u003e 新たに 12 個の値が設定可能になりました。\u003c/p\u003e\n\u003cp\u003eMDN のデモで値に応じた表示を確認することができます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/list-style-type#result_2\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/list-style-type#result_2\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eWeb Inspector\u003c/h2\u003e\n\u003cp\u003eCSS Grid に対応したオーバレイ表示が可能になりました。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://webkit.org/blog/11588/introducing-css-grid-inspector/\"\u003ehttps://webkit.org/blog/11588/introducing-css-grid-inspector/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eデバッグ用のブレークポイント周りなどにも改善が施されています。その他の変更点は WWDC2021 の発表動画に含まれます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.apple.com/videos/play/wwdc2021/10031/\"\u003eDiscover Web Inspector improvements - WWDC21 - Videos - Apple Developer\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eJavaScript and WebAssembly\u003c/h2\u003e\n\u003cp\u003eWorker や ServiceWorker で ES6 Modules のサポートが追加されました。\u003c/p\u003e\n\u003cp\u003eまた、JavaScript エンジンで次の機能がサポートされました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etop-level \u003ccode\u003eawait\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eError.cause\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eプライベートクラスメソッド とアクセサ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eBigInt64Array\u003c/code\u003e および \u003ccode\u003eBigUint64Array\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWebAssembly では次のサポートが追加されました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estreaming compilation\u003c/li\u003e\n\u003cli\u003ebulk memory operations\u003c/li\u003e\n\u003cli\u003ereference types\u003c/li\u003e\n\u003cli\u003enon-trapping conversions from \u003ccode\u003efloat\u003c/code\u003e to \u003ccode\u003eint\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/WebAssembly/spec/tree/main/proposals\"\u003eWebAssembly/spec - proposals\u003c/a\u003e\n\u003ca href=\"https://developer.apple.com/videos/play/wwdc2021/10030\"\u003eDevelop advanced web content - WWDC21 - Videos - Apple Developer\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eWeb APIs\u003c/h2\u003e\n\u003ch3\u003eWebGL2 に対応\u003c/h3\u003e\n\u003cp\u003eWebGL2 に対応し、かつ Apple の グラフィック API の Metal 上で動作するようになり、パフォーマンスが向上しました。\u003c/p\u003e\n\u003ch3\u003eWeb Share API Level 2 の実装\u003c/h3\u003e\n\u003cp\u003eWeb Share API Level 2 の実装により、Web ページからアプリへのファイル共有が可能になりました。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.apple.com/videos/play/wwdc2021/10030\"\u003eDevelop advanced web content - WWDC21 - Videos - Apple Developer\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eMedia\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eMediaSession API のサポートの追加\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://developer.apple.com/videos/play/wwdc2021/10189/\"\u003eCoordinate media playback in Safari with Group Activities - WWDC21 - Videos - Apple Developer\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eSecurity and Privacy\u003c/h2\u003e\n\u003ch3\u003e自動 HTTPS アップグレードのサポート\u003c/h3\u003e\n\u003cp\u003ehttp と https の双方が利用可能なページの場合、自動で https を利用するようになります。\u003c/p\u003e\n\u003ch2\u003e所感\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003easpect-ratio\u003c/code\u003e が 主要 4 ブラウザ(Chrome/Safari/Firefox/Edge)すべてで利用可能になりましたね。今後利用するケースが徐々に増えていきそうです。\u003c/p\u003e\n\u003cp\u003e余談ですが、\u003ccode\u003elist-style-type\u003c/code\u003e に \u003ccode\u003ejapanese-formal\u003c/code\u003e を指定すると \u003ccode\u003e壱・弐・参・四・伍…\u003c/code\u003e になるのですね。カッコいいです。\u003c/p\u003e\n","metaData":{"title":"Safari 15 の新機能とかまとめ","author":"mugi","editor":"nakajmg","createdAt":"2021-11-16","summary":"先日 Safari 15 がリリースされました。影響の大きそうな箇所や、知っておいたほうが良さそうな箇所を中心に紹介します。","tags":["Releasenote","Browser"],"updatedAt":"2021-11-16"}},{"slug":"ergonomic-brand-checks-for-private-fields","content":"\u003cp\u003e2021年7月に行われた TC39 ミーティングで \u003ca href=\"https://github.com/tc39/proposal-private-fields-in-in\"\u003eErgonomic brand checks for Private Fields\u003c/a\u003e というプロポーザルが Stage 4 になりました。\nこのプロポーザルは、ES2022 に含まれる予定です。また、\u003ca href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-4-5-rc/#private-field-presence-checks\"\u003eTypeScript 4.5 にも含まれる予定です\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003eこの記事では、Ergonomic brand checks for Private Fields について解説します。\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eErgonomic brand checks for Private Fields は、\u003ccode\u003ein\u003c/code\u003e 演算子を使ったプライベートフィールドの有無の判定を可能にするプロポーザルです。\u003c/p\u003e\n\u003ch3\u003e現在の \u003ccode\u003ein\u003c/code\u003e 演算子\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ein\u003c/code\u003e 演算子は、オブジェクトが特定の名前のプロパティを持っているかどうかを判定するための二項演算子です。\n左辺にプロパティの名前、右辺にオブジェクトを受け取ります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e obj \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e prop1\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"prop1\"\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e obj\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e新しい \u003ccode\u003ein\u003c/code\u003e 演算子\u003c/h3\u003e\n\u003cp\u003eErgonomic brand checks for Private Fields では、この \u003ccode\u003ein\u003c/code\u003e 演算子を拡張し、左辺に Private Identifier を取れるようになります。\u003c/p\u003e\n\u003cp\u003ePrivate Identifier は \u003ccode\u003e#foo\u003c/code\u003e のような形をした特別な識別子で、クラスのプライベートフィールドを表現するのに使われます。\u003c/p\u003e\n\u003cp\u003eたとえば、次のコードではクラス \u003ccode\u003eFoo\u003c/code\u003e は、\u003ccode\u003e#prop1\u003c/code\u003e というプライベートフィールドを持ちます。\nこのとき \u003ccode\u003e#prop1\u003c/code\u003e は Private Identifier です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #prop1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e拡張された \u003ccode\u003ein\u003c/code\u003e 演算子では、次のようにしてオブジェクトにプライベートフィールドが含まれるかどうかをチェックできます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e#prop1 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e obj\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、プライベートフィールドはプライベートなので上記のコードはそのフィールドを持つクラスの中でのみ使うことができます。\u003c/p\u003e\n\u003cp\u003eつまり、次のようにクラスの外でプライベートフィールドに対して \u003ccode\u003ein\u003c/code\u003e を使うとエラーになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #prop1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e#prop1 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Uncaught SyntaxError: Private field '#prop1' must be declared in an enclosing class\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、次のようなコードはエラーになりません。メソッド \u003ccode\u003efoo\u003c/code\u003e はクラス \u003ccode\u003eFoo\u003c/code\u003e の中にあるので、Private Identifier である \u003ccode\u003e#foo\u003c/code\u003e を \u003ccode\u003ein\u003c/code\u003e 演算子の左辺として使うことができます。\nそして、この \u003ccode\u003efoo\u003c/code\u003e の中で \u003ccode\u003ethis\u003c/code\u003e は \u003ccode\u003eFoo\u003c/code\u003e のインスタンスであり、それには当然 \u003ccode\u003e#prop1\u003c/code\u003e というプライベートプロパティが存在するので、\u003ccode\u003e#prop1 in this\u003c/code\u003e の結果は \u003ccode\u003etrue\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #prop1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003efoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e #prop1 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eモチベーション\u003c/h2\u003e\n\u003cp\u003e存在しないプライベートフィールドにアクセスすると、実行時エラーが発生します。\u003c/p\u003e\n\u003cp\u003eその挙動と try / catch を組み合わせて、次のようにしてオブジェクトのクラスを判定できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #brand\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eobj\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      obj\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e#brand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eobj.#brand\u003c/code\u003e にアクセスしたとき、\u003ccode\u003eobj\u003c/code\u003e が Foo のインスタンスでない場合、実行時エラーが発生し \u003ccode\u003ecatch\u003c/code\u003e に入り \u003ccode\u003efalse\u003c/code\u003e が返されます。\nこのようにして、あるオブジェクトが\u003ccode\u003eFoo\u003c/code\u003eのインスタンスであるかを検証するスタティックメソッドを作れます。\u003c/p\u003e\n\u003cp\u003eですが、このパターンは冗長です。\u003ccode\u003ein\u003c/code\u003e 演算子を使えばもっと短く書けます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #brand\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eobj\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e #brand \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e obj\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこれが、このプロポーザルの主なモチベーションです。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/instanceof\"\u003e\u003ccode\u003einstanceof\u003c/code\u003e 演算子\u003c/a\u003eも基本的にはこの目的のために使えます。しかし \u003ccode\u003einstanceof\u003c/code\u003e 演算子はプロトタイプに依存するので、プロトタイプを書き換えることでその挙動を変更できます。\u003c/p\u003e\n\u003cp\u003e次の例では、 \u003ccode\u003eobj\u003c/code\u003e は \u003ccode\u003eFoo\u003c/code\u003e のインスタンスではありませんが、後からプロトタイプを書き換えているので \u003ccode\u003eobj instanceof Foo\u003c/code\u003e は \u003ccode\u003etrue\u003c/code\u003e になっています。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e obj \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token known-class-name class-name\"\u003eObject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPrototypeOf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eobj\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e foo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eobj \u003cspan class=\"token keyword\"\u003einstanceof\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた、\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Symbol/hasInstance\"\u003eSymbol.hasInstance\u003c/a\u003e を使って \u003ccode\u003einstanceof\u003c/code\u003e の挙動を変更することも可能です。\u003c/p\u003e\n\u003cp\u003eなので、より安全にオブジェクトのもとになったクラスを検証したい場合は \u003ccode\u003ein\u003c/code\u003e 演算子を使うと良いでしょう。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-RelationalExpression\"\u003ehttps://tc39.es/ecma262/#prod-RelationalExpression\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-PrivateIdentifier\"\u003ehttps://tc39.es/ecma262/#prod-PrivateIdentifier\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-private-fields-in-in\"\u003ehttps://github.com/tc39/proposal-private-fields-in-in\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/in\"\u003ehttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/in\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"ES2022 と TypeScript 4.5 に入るプライベートフィールドのための in 演算子について","author":"sosukesuzuki","createdAt":"2021-11-11","summary":"ES2022 と TypeScript 4.5 に入る現在 Stage 4 の提案 Ergonomic brand checks for Private Fields についての解説です。","tags":["ECMAScript","TypeScript"],"updatedAt":"2021-11-11"}},{"slug":"eyedropper-api","content":"\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-95/\"\u003eChrome 95 がリリース\u003c/a\u003eされ、新機能として EyeDropper API が追加されました。(Edge 95 にも追加されました)\u003c/p\u003e\n\u003ch2\u003eEyeDropper API とは\u003c/h2\u003e\n\u003cp\u003eEyeDropper API は画面上から色情報を取得するスポイトツールをブラウザ上で実現する API です。スポイトツールはデザインツールなどに搭載されていることが多いかと思います。\nChrome の DevTools にも色選択をするときにスポイトアイコンをクリックするとスポイトツールが使えますが、この機能が単体の Web API として実装された形になります。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/eyedropper-api/eyedropper.png\" alt=\"DevToolsのカラーピッカー\" width=\"687\" height=\"307\" \u003e\u003c/p\u003e\n\u003ch2\u003e使い方\u003c/h2\u003e\n\u003cp\u003eEyeDropper API の使い方は次のようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e eyeDropper \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEyeDropper\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e eyeDropper\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// {sRGBHex: '#92d0e1'}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eEyeDropper\u003c/code\u003eのインスタンスで\u003ccode\u003eopen\u003c/code\u003eを実行すると色選択の UI が表示されます。\u003c/p\u003e\n\u003ch3\u003eセキュリティ上の制約\u003c/h3\u003e\n\u003cp\u003eEyeDropper API の \u003ccode\u003eopen\u003c/code\u003e はユーザーの操作なしに実行するとエラーになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003eDOMException: Failed to execute \u0026#x26;#39;open\u0026#x26;#39; on \u0026#x26;#39;EyeDropper\u0026#x26;#39;: EyeDropper::open() requires user gesture.\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこれはプライバシーやセキュリティを考慮しての制限になります。\u003ccode\u003eopen\u003c/code\u003eはユーザーの操作によってのみスポイトモードに移行し、ユーザーがクリックしたときのみ色の値を返します。\nこれによって悪意のあるサイトがユーザーの画面のピクセル情報を勝手に取得できないようになっています。\u003c/p\u003e\n\u003ch3\u003econsole からは起動できる\u003c/h3\u003e\n\u003cp\u003eユーザーの操作なしに起動できない API ですが、DevTools の console からはその限りではありません。次のワンライナーのコードを console で実行するとスポイトツールを起動できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEyeDropper\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e覚えておくと便利かもしれません。\u003c/p\u003e\n\u003cp\u003eちなみにですが、Snippets からは起動できませんでした。\u003c/p\u003e\n\u003ch2\u003eEyeDropper API を使ったデモサイト\u003c/h2\u003e\n\u003cp\u003eEyeDropper API のデモサイトの紹介です。こちらのデモでは EyeDropper API を使った色選択ゲームが遊べます。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://captainbrosset.github.io/eyedropper-demos/color-game.html\"\u003eeyedropper-demos/color-game\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ePlay ボタンをクリックするとカウントダウンが開始されます。時間内に左のマスに表示された色と同じ色を選択すると勝ちです。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/eyedropper-api/demo.png\" alt=\"EyeDropper APIのデモ\" width=\"704\" height=\"491\" \u003e\u003c/p\u003e\n\u003cp\u003e一部ブラウザでは \u003ccode\u003einput\u003c/code\u003eタグで\u003ccode\u003etype=\"color\"\u003c/code\u003eとすることで似たようなピッカーを使用できましたが、UI なしに実行できるようになったことでいろいろな使い道が考えられそうですね。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://wicg.github.io/eyedropper-api/\"\u003ehttps://wicg.github.io/eyedropper-api/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web.dev/eyedropper/\"\u003ehttps://web.dev/eyedropper/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"Chrome 95 で追加された画面上の色を取得するEyeDropper APIについて","author":"nakajmg","createdAt":"2021-11-02","summary":"Chromiumベースのブラウザーに追加されたEyeDropper APIについて紹介します","tags":["Web API","Browser"],"updatedAt":"2021-11-02"}},{"slug":"tc39-meeting-2021-10","content":"\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e※ 旧タイトル: TC39 meeting 86th の概要とステージの移動\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTC39 の 86 回目のミーティングが 10/25 ~ 10/28 に開催されました。\nこのミーティングで議題に上がった提案と、そのステージの移動について紹介します。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/agendas/blob/master/2021/10.md\"\u003eagendas/10.md at master · tc39/agendas\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/proposals/issues/77\"\u003eOct 2021 · Issue #77 · babel/proposals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003efor Stage 4\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-error-cause\"\u003eError Cause\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 4 になりました。ECMAScript 2022 に入ります\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eError Cause は、\u003ccode\u003eError\u003c/code\u003e コンストラクタの第 2 引数に \u003ccode\u003ecause\u003c/code\u003e という値で原因となったエラーを渡すことができるようにする提案です。\nキャッチする側では、\u003ccode\u003eerror.cause\u003c/code\u003e で、そのエラーを取得できます。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edoUploadJob\u003c/code\u003e 関数は \u003ccode\u003efetch\u003c/code\u003e を実行して失敗したときに新しいエラーをスローします。そのエラーの第 2 引数に \u003ccode\u003e{ cause: err }\u003c/code\u003e というオブジェクトを渡しています。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edoUploadJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003efetch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"https://example.com/upload\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ethrow\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Upload job result failed\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e cause\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e err \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003edoJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Caused by\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecause\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Error: Upload job result failed\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Caused by TypeError: Failed to fetch\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003edoUploadJob\u003c/code\u003e がスローしているエラーメッセージは \u003ccode\u003e\"Upload job result failed\"\u003c/code\u003e ですが、その原因となったエラーを \u003ccode\u003ecause\u003c/code\u003e として渡すことで、キャッチする側でどのエラーが原因で失敗したのかを取得できます。\u003c/p\u003e\n\u003cp\u003eこの例では、\u003ccode\u003edoUploadJob\u003c/code\u003e が失敗した原因が \u003ccode\u003eTypeError: Failed to fetch\u003c/code\u003e であったことがわかります。\u003c/p\u003e\n\u003ch2\u003efor Stage 3\u003c/h2\u003e\n\u003cp\u003e今回は、for Stage 3 の提案はありませんでした。\u003c/p\u003e\n\u003ch2\u003efor Stage 2\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-grouping\"\u003eArray Grouping\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eArray Grouping は、\u003ccode\u003eArray\u003c/code\u003e に \u003ccode\u003egroupBy\u003c/code\u003e というインスタンスメソッドを追加する提案です。\u003c/p\u003e\n\u003cp\u003eユースケースは\u003ca href=\"https://lodash.com/docs/4.17.15#groupBy\"\u003eLodash の \u003ccode\u003egroupBy\u003c/code\u003e\u003c/a\u003e と同様です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e array \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\narray\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egroupBy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ei\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"even\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"odd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// =\u003e  { odd: [1, 3, 5], even: [2, 4] }\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-partial-application\"\u003ePartial Application\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003ePartial Application は、関数の部分適用のための構文を導入します。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eadd\u003c/code\u003e は 2 つの引数を受け取り、その 2 つを足し合わせて返すだけの単純な関数です。\nそして、Partial Application を使って \u003ccode\u003eaddOne\u003c/code\u003e という新しい関数を作っています。\u003ccode\u003eaddOne\u003c/code\u003e は、1 つの引数を受け取り、それに\u003ccode\u003e1\u003c/code\u003eを足して返す関数です。\nつまり、既存の関数の一部の引数だけ渡して、残りの引数を受け取るような関数を作ることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eadd\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e y\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e addOne \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e add\u003cspan class=\"token operator\"\u003e~\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eaddOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e現在の JavaScript で表現すると、次のようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eadd\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ey\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e y\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e addOne \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eaddOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHaskell のような関数型プログラミング言語では標準で備わっている機能です。\u003c/p\u003e\n\u003ch2\u003efor Stage 1\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/bathos/proposal-string-cooked\"\u003e\u003ccode\u003eString.cooked\u003c/code\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eString.cooked\u003c/code\u003e は \u003ccode\u003eString\u003c/code\u003e に新しいスタティックメソッド \u003ccode\u003ecooked\u003c/code\u003e を追加する提案です。\n\u003ccode\u003eString.cooked\u003c/code\u003e は \u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/raw\"\u003e\u003ccode\u003eString.raw\u003c/code\u003e\u003c/a\u003e と逆のことをします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eraw\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003emmm ... \\u0064elicious cooked string\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// mmm ... \\u0064elicious cooked string\u003c/span\u003e\n\u003cspan class=\"token known-class-name class-name\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecooked\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003emmm ... \\u0064elicious cooked string\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// \"mmm ... delicious cooked string\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eつまり、通常のテンプレートリテラルとおなじ挙動です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003emmm ... \\u0064elicious cooked string\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// \"mmm ... delicious cooked string\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこの機能がタグ付きテンプレートリテラルとして存在することで、これを用いて新しいタグ付きテンプレートリテラルを作るときに役にたちます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emyTag\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estrings\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003evalues\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecooked\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estrings\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003evalues\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoUpperCase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nmyTag\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003ehello \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token string\"\u003e'world'\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// \"hello WORLD\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/jridgewell/proposal-destructuring-private\"\u003eDestructure Private Fields\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 を飛ばして、Stage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eDestructure Private Fields は、プライベートフィールドの分割代入のための構文を導入します。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e#\u003c/code\u003e からはじまる識別子は通常であれば存在できないので、別の名前にリネームする必要があります。次の例では \u003ccode\u003ethis.#x\u003c/code\u003e を \u003ccode\u003ex\u003c/code\u003e という名前にリネームしています。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  #x \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e#x\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// =\u003e 1\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e #x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// =\u003e 1\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/js-choi/proposal-bind-this\"\u003eBind-this operator\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eBind this operator は、\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Function/bind\"\u003eFunction.prototype.bind\u003c/a\u003e と同様の方法で関数をバインドするための二項演算子を導入する提案です。\u003c/p\u003e\n\u003cp\u003e以前から存在する Stage 0 の \u003ca href=\"https://github.com/tc39/proposal-bind-operator\"\u003eBind Operator\u003c/a\u003e の後継であり、Stage 1 の \u003ca href=\"https://github.com/tc39/proposal-extensions\"\u003eExtensions\u003c/a\u003e の競合です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token class-name\"\u003eObject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eprototype\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehasOwnProperty\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token class-name\"\u003eObject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eprototype\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehasOwnProperty\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/js-choi/proposal-function-helpers\"\u003eFunction helpers\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりませんでした。この提案に含まれる関数は個別の提案として再度提出されるかもしれません。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eFunction helpers は、\u003ccode\u003eFunction\u003c/code\u003e のスタティックメソッドとして便利なヘルパー関数を追加する提案です。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eFunction.flow\u003c/code\u003e は引数に与えられた関数を合成した新しい関数を返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e f \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eflow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ef0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e7\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// f2(f1(f0(5, 7))).\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eFunction.pipe\u003c/code\u003e は第 1 引数の値を、それ移行の引数として渡された関数を合成した関数に渡した結果を返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epipe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// f2(f1(f0(5))).\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eFunction.constant\u003c/code\u003e は、第 1 引数として渡された値を返し続ける関数を返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e f \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003econstant\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"fooo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3009\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e33\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e44\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e foo\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eFunction.identifiy\u003c/code\u003e は、第 1 引数に与えられた値をそのまま返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eidentity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eidentity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eFunction.tap\u003c/code\u003e はコールバック関数を引数として受け取り、関数を返します。\n\u003ccode\u003eFunction.tape\u003c/code\u003e が返した関数に引数を渡すと、それをコールバック関数に渡して実行し、その上でその引数をそのまま返します。\n言葉で説明すると難しいですが、例を見れば簡単だと思います。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e f \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eFunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 5 を出力して、5 を返す\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/lucacasonato/proposal-evaluator-attributes\"\u003eEvaluator Attributes\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eEvaluator Attributes は、インポートされたモジュールの評価方法を処理系に伝えるための構文を導入します。\u003c/p\u003e\n\u003cp\u003e例にある通り、提案された目的は WebAssembly のモジュールを JavaScript の Import 文で読み込むためです。しかし、提案の仕様としては WebAssembly には限られていません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003emod\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./foo.wasm\"\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"wasm-module\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmod \u003cspan class=\"token keyword\"\u003einstanceof\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eWebAssembly\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eModule\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e現在 Stage 3 の \u003ca href=\"https://github.com/tc39/proposal-import-assertions\"\u003eImport Assertions\u003c/a\u003e に似ていますが、Import Assertions はモジュールの評価方法に影響を与えることはできません。\u003c/p\u003e\n\u003ch3\u003eRegExp Features\u003c/h3\u003e\n\u003cp\u003e前回のミーティングで提案された\u003ca href=\"https://github.com/rbuckton/proposal-regexp-features\"\u003eRegExp Features\u003c/a\u003eが機能ごとに別々の提案に分割されました。\u003c/p\u003e\n\u003ch4\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-modifiers\"\u003eRegExp Modifiers\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003ch4\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-x-mode\"\u003eRegExp Extended Mode and Comments\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003ch4\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-atomic-operators\"\u003eRegExp Atomic Operators\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003ch4\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-r-escape\"\u003eRegExp \u003ccode\u003e\\R\u003c/code\u003e Escape\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003ch4\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-buffer-boundaries\"\u003eRegExp Buffer Boundaries\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003ch3\u003eUpdates\u003c/h3\u003e\n\u003cp\u003eステージの移動はないものの、アップデートがあった提案です。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-change-array-by-copy\"\u003eChange Array by Copy\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-json-parse-with-source\"\u003eJSON.parse sourct text access\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-record-tuple/\"\u003eRecords \u0026#x26; Tuples\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-explicit-resource-management\"\u003eExplicit Resource Management\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-js-module-blocks\"\u003eJS Module Blocks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/js-choi/proposal-array-from-async\"\u003eArray.fromAsync\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eその他\u003c/h2\u003e\n\u003cp\u003e提案ではなく、仕様書の変更として扱われているものです。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/1321\"\u003eExtending null\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e合意は得られませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003enull\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n","metaData":{"title":"ECMAScriptの最新動向 2021年11月版","author":"sosukesuzuki","editor":"nakajmg","createdAt":"2021-11-02","summary":"2021年10月25日~28日に開催された TC39 meeting 86th の内容を紹介します","tags":["TC39","ECMAScript"],"updatedAt":"2021-11-02"}},{"slug":"release-firefox-93","content":"\u003cp\u003eFirefox 93 がリリースされました！\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mozilla.org/en-US/firefox/93.0/releasenotes/\"\u003ehttps://www.mozilla.org/en-US/firefox/93.0/releasenotes/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/93\"\u003ehttps://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/93\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e今回のリリースから AVIF 画像フォーマットがデフォルトで有効化されます。\u003c/p\u003e\n\u003cp\u003eクライアント側の使用感が変わるわけではありませんが、今後こういった高圧縮可能な形式がスタンダードになることでよりリッチな Web コンテンツを多く提供できるようになるかもしれませんね。\u003c/p\u003e\n\u003cp\u003eまた、クラスの \u003ccode\u003estatic\u003c/code\u003e 初期化ブロックをはじめとして、多くのイベントハンドラやプロパティの追加が盛り込まれているため、開発者視点では重要なアップデートではないかと思われます。\u003c/p\u003e\n\u003ch2\u003eNew\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAV1 形式の画像フォーマットに対応\u003c/li\u003e\n\u003cli\u003ePDF ビューアーがより詳細なフォームに対応(複数の政府や銀行が使用している XFA ベースフォーム)\u003c/li\u003e\n\u003cli\u003eWindows 版にて、利用可能メモリが極端に少ない場合に利用状況や属性に基づいてタブを自動的にアンロードするようになった\u003c/li\u003e\n\u003cli\u003emacOS 版にて、.dmg ファイルからマウントされた Firefox を実行している時、セッションを失わないためにインストールを完了するかどうかプロンプトが表示されるようになった\u003c/li\u003e\n\u003cli\u003e安全でない接続に依存している、もしくは安全でない可能性のあるダウンロードをブロックするようになった\u003c/li\u003e\n\u003cli\u003eSmart Block 3.0 (プライバシー保護機能)の互換性向上\u003c/li\u003e\n\u003cli\u003e新しい referrer tracking protection を Strick Tracking Protection と Private Browsing に導入\u003c/li\u003e\n\u003cli\u003eFirefox Suggest(Web ナビゲーター) の導入\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFixed\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eVoiceOver がアクセス可能なツリーコントロール内にあるチェック可能アイテムのチェック状態を正しく判別するようになった\u003c/li\u003e\n\u003cli\u003eOrca スクリーンリーダーが Firefox で正しく動作するようになった\u003c/li\u003e\n\u003cli\u003eその他セキュリティ修正\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eChanged\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e3DES を使用する TLS 暗号スイートが無効化\n\u003cul\u003e\n\u003cli\u003e非推奨バージョンの TLS を有効化する設定により利用は可能\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eダウンロードパネルが Firefox のビジュアルスタイルに沿うようになった\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003efor web developer\u003c/h2\u003e\n\u003ch3\u003eHTML\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eARIA \u003ccode\u003emeter\u003c/code\u003e ロールを実装\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;input type=\"datetime-local\"\u003e\u003c/code\u003e の UI を実装\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eCSS\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003efont-synthesis\u003c/code\u003e に \u003ccode\u003esmall-caps\u003c/code\u003e キーワードを追加\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eJavaScript\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eクラスの \u003ccode\u003estatic\u003c/code\u003e 初期化ブロックをサポート\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecreateImageBitmap()\u003c/code\u003e にて option オブジェクトを用いて \u003ccode\u003eimageOrientation\u003c/code\u003e 及び \u003ccode\u003epremultiplyAlpha\u003c/code\u003e プロパティを渡せるようになった\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eIntl.supportedValueOf()\u003c/code\u003e をサポート\n\u003cul\u003e\n\u003cli\u003e実装でサポートされている値をコードで列挙できるようになった\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eHTTP\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eダイジェストを用いた HTTP 認証で SHA-256 アルゴリズムをサポート\u003c/li\u003e\n\u003cli\u003e画像のデフォルト HTTP ACCEPT ヘッダーが \u003ccode\u003eimage/avif,image/webp,*/*\u003c/code\u003e に変更\n\u003cul\u003e\n\u003cli\u003eAV1 フォーマット対応によるものだと思われます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eAPIs\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eElementInternals.shadowRoot\u003c/code\u003e 及び \u003ccode\u003eHTMLElement.attachInternals\u003c/code\u003e をサポート\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eResizeObserver.Observe()\u003c/code\u003e にて \u003ccode\u003edevice-pixel-content-box\u003c/code\u003e 値をサポート\u003c/li\u003e\n\u003cli\u003eグローバル関数 \u003ccode\u003ereportError()\u003c/code\u003e をサポート\n\u003cul\u003e\n\u003cli\u003eスクリプトがコンソールやグローバルイベントハンドラに対してエラーを報告できるようになった\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eEvents\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eグローバルイベントハンドラプロパティ \u003ccode\u003eonsecuritypolicyviolation\u003c/code\u003e をサポート\n\u003cul\u003e\n\u003cli\u003eコンテンツセキュリティポリシー違反時に発生する \u003ccode\u003esecuritypolicyviolation\u003c/code\u003e イベントを処理するハンドラを割り当てることが可能になった\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGlobalEventHandlers\u003c/code\u003e 及び \u003ccode\u003eShadowRoot\u003c/code\u003e にて \u003ccode\u003eonslotchange\u003c/code\u003e イベントハンドラプロパティをサポート\n\u003cul\u003e\n\u003cli\u003eスロットに含まれるノードが変更された際に \u003ccode\u003e\u0026#x3C;slot\u003e\u003c/code\u003e 要素で発生する \u003ccode\u003eslotchange\u003c/code\u003e イベントを処理するハンドラを割り当てることが可能になった\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eRemovals\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eKeyboardEvent.initKeyEvent()\u003c/code\u003e が \u003ccode\u003edom.keyboardevent.init_key_event.enabled\u003c/code\u003e によって実行可否が制御されるようになり、デフォルトで無効になった\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eWebDerive conformance (Marionette)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e大きなドキュメントに対して \u003ccode\u003eWebDriver:Print\u003c/code\u003e が失敗する原因になっているバグを修正\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003efor add-on developers\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ewindowId\u003c/code\u003e が指定されている場合、サイドバーが \u003ccode\u003eextension.getViews\u003c/code\u003e に包含されるようになった\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eOther\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAVIF 画像のサポートがデフォルトで有効になった\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eimage.avif.compliance_strictness\u003c/code\u003e を用いて仕様準拠の厳密生を調節できる\u003c/li\u003e\n\u003cli\u003eアニメーション画像には非対応\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWeb Platform\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;input type=\"datetime-local\"\u003e\u003c/code\u003e の UI を実装\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"Firefox 93.0 リリースノート要約","author":"BaHo","editor":"nakajmg","createdAt":"2021-10-21","summary":"Firefox 93.0 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2021-10-21"}},{"slug":"first-post","content":"\u003cp\u003eこんにちは、サイボウズフロントエンドエキスパートチームの\u003ca href=\"https://twitter.com/__sosukesuzuki\"\u003e@__sosukesuzuki\u003c/a\u003eです。\u003c/p\u003e\n\u003cp\u003eサイボウズには\u003ca href=\"https://blog.cybozu.io/\"\u003eCybozu Inside Out\u003c/a\u003eという技術ブログがあります。\nそれとは別に、この度フロントエンドエキスパートチームとしてウェブサイトを開設することにしました。\u003c/p\u003e\n\u003cp\u003eこの記事では、このウェブサイトを開設することになった経緯と目的、使用した技術について説明します。\u003c/p\u003e\n\u003ch2\u003e経緯\u003c/h2\u003e\n\u003cp\u003eフロントエンドエキスパートチームでは、チームでのコミュニケーションの促進を主な目的としてハッカソンを開催することがあります。\n(チームでのハッカソンについては\u003ca href=\"https://blog.cybozu.io/entry/2021/02/25/133039\"\u003eCybozu Inside Out に投稿されている記事\u003c/a\u003eをご覧ください)\u003c/p\u003e\n\u003cp\u003eそのようなハッカソンで、フリーテーマの回がありました。\nそこで、\u003ca href=\"https://twitter.com/__sakito__\"\u003eSakito\u003c/a\u003eさんと\u003ca href=\"https://twitter.com/b4h0_c4t\"\u003eBaHo\u003c/a\u003eさんと\u003ca href=\"https://twitter.com/__sosukesuzuki\"\u003esosukesuzuki\u003c/a\u003e(私)のチームでは、フロントエンドエキスパートチームのウェブサイトを作ってみることにしました。\u003c/p\u003e\n\u003cp\u003eハッカソンの期間内に完成することはありませんでしたが、チームとしてウェブサイトを持っていた方が良いということで合意が得られたので、ハッカソン終了後も開発を継続することにしました。\u003c/p\u003e\n\u003ch2\u003e目的\u003c/h2\u003e\n\u003cp\u003eフロントエンドエキスパートチームの活動を多くの人に知ってもらうためです。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームでは、日頃から様々なフロントエンド技術の啓蒙活動を行っています。\nそれらの多くはクローズドな場所で行われています。しかし基本的にその内容はサイボウズ特有のものではなく、一般的に有用な情報です。\u003c/p\u003e\n\u003cp\u003eそこで、フロントエンドエキスパートチームとしてウェブサイトを開設し、公開できる有用な情報は公開することにしました。\u003c/p\u003e\n\u003cp\u003eこのウェブサイトを通して、フロントエンドエキスパートチームに興味を持ってくれたら嬉しいです。\u003c/p\u003e\n\u003ch2\u003e技術\u003c/h2\u003e\n\u003cp\u003e次の要件を満たす技術として、\u003ca href=\"https://github.com/vercel/next.js\"\u003eNext.js\u003c/a\u003e を採用しました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e環境構築が簡単である\n\u003cul\u003e\n\u003cli\u003eもともとハッカソンで開発していたので、環境構築に多くの時間を割けないという事情がありました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSSG の機能を備えている\n\u003cul\u003e\n\u003cli\u003eすべてのコンテンツは静的なものと決まっていたので、SSG ができると嬉しい\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eTypeScript との相性が良い\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e記事は Markdown として管理して Next.js の \u003ccode\u003egetStaticProps\u003c/code\u003e のタイミングで \u003ca href=\"https://github.com/remarkjs/remark\"\u003eremark\u003c/a\u003e を使って HTML に変換しています。\u003c/p\u003e\n\u003cp\u003eまた、ブログの機能を持つので、feed の生成と記事ごとの OGP 画像の生成をのためのスクリプトをそれぞれ用意しました。feed 生成スクリプトは、記事データの Markdown からメタデータを取得し、XML ファイルを書き出します。\nOGP 画像生成スクリプトは、記事データの Markdown からタイトルを取得し、\u003ca href=\"https://github.com/puppeteer/puppeteer\"\u003ePuppeteer\u003c/a\u003e で画像を生成します。\u003c/p\u003e\n\u003cp\u003eホスティングには GitHub Pages を使っています。GitHub で管理している HTML をホストする先としてはやはり楽です。\u003c/p\u003e\n\u003cp\u003e実装はすべて \u003ca href=\"https://github.com/cybozu/frontend-expert\"\u003ehttps://github.com/cybozu/frontend-expert\u003c/a\u003e で公開しています。\u003c/p\u003e\n\u003ch2\u003eおわりに\u003c/h2\u003e\n\u003cp\u003eこれから、不定期ではありますが、当サイトにてフロントエンドに関連する情報を発信していく予定です。ぜひ読んでみてくださいね。\u003c/p\u003e\n","metaData":{"title":"サイボウズフロントエンドエキスパートチームのウェブサイトを作りました","author":"sosukesuzuki","createdAt":"2021-10-14","summary":"このウェブサイトを開設することになった経緯と目的、使用した技術について説明します。","tags":["Announcement"],"updatedAt":"2021-10-14"}}]},"__N_SSG":true},"page":"/posts","query":{},"buildId":"EaewsNgYRXzvpGat1fleA","assetPrefix":"/frontend-expert","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>