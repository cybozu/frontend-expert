<!DOCTYPE html><html lang="ja"><head><title>Posts | サイボウズ フロントエンドエキスパートチーム</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><link rel="icon" type="image/png" sizes="32x32" href="/frontend-expert/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/frontend-expert/icons/favicon-16x16.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Posts | サイボウズ フロントエンドエキスパートチーム"/><meta name="twitter:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta name="twitter:image " content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><meta property="og:type" content="article"/><meta property="og:title" content="Posts | サイボウズ フロントエンドエキスパートチーム"/><meta property="og:site_name" content="サイボウズ フロントエンドエキスパートチーム"/><meta property="og:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta property="og:image" content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/frontend-expert/feeds/atom.xml"/><meta name="next-head-count" content="16"/><link rel="preload" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend-expert/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/frontend-expert/_next/static/chunks/webpack-b0f44a7ac00bf3cb.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/framework-742985a85518e1e1.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/main-242b1a0e32bf923c.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/_app-ff35bec35d2bc313.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/247-c193c27d2f31cb66.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/836-6657179380c09c99.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/posts/page/%5BpageNum%5D-595525cc6bcfadde.js" defer=""></script><script src="/frontend-expert/_next/static/TJYDfOC8APX_Mlwq6jN6v/_buildManifest.js" defer=""></script><script src="/frontend-expert/_next/static/TJYDfOC8APX_Mlwq6jN6v/_ssgManifest.js" defer=""></script><script src="/frontend-expert/_next/static/TJYDfOC8APX_Mlwq6jN6v/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css ruypru">.css-ruypru{width:100%;}.css-ruypru .main{max-width:100%;background-color:white;}.css-ruypru .main .content{margin:0 auto;max-width:var(--content-width);box-sizing:border-box;padding:1rem 1rem 1.5rem;min-height:400px;}</style><div class="css-ruypru"><style data-emotion="css 14l5li6">.css-14l5li6{padding:1.2rem 0 1rem;background-color:var(--primary-color);}.css-14l5li6 .content{max-width:var(--content-width);margin:0 auto;padding:0 1rem;box-sizing:border-box;}.css-14l5li6 h1{font-size:1.6rem;}.css-14l5li6 .navigation ul{margin:0;list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-14l5li6 .navigation ul li{padding:0.2rem 0;font-size:1rem;}.css-14l5li6 .navigation ul li:not(:last-child)::after{content:"/";margin:0 0.4rem;color:var(--light-font-color);}.css-14l5li6 a{color:var(--light-font-color);}</style><header class="css-14l5li6"><div class="content"><h1><a href="/frontend-expert"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27200%27%20height=%2778%27/%3e"/></span><img alt="Frontend Expert Team Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Frontend Expert Team Logo" src="/frontend-expert/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></h1><nav class="navigation"><ul><li><a href="/frontend-expert/members">Members</a></li><li><a href="/frontend-expert/posts">Posts</a></li><li><a href="https://cybozu.co.jp/recruit/entry/career/front-end-expert.html" target="_blank" rel="noopener noreferrer">Recruiting</a></li></ul></nav></div></header><main class="main"><div class="content"><style data-emotion="css 1ser9hr">.css-1ser9hr h2{font-size:1.6rem;margin-bottom:1rem;}.css-1ser9hr p{font-size:1rem;line-height:1.75;}</style><div class="css-1ser9hr"><h2>Posts</h2><style data-emotion="css 3x8wln">.css-3x8wln .item{font-size:1.1rem;padding:12px 4px 8px;}.css-3x8wln .item+.item{margin-top:8px;border-top:1px solid #ebebeb;}.css-3x8wln .title{font-size:1.2em;}.css-3x8wln .tags{margin-top:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-gap:8px;}.css-3x8wln .tag{font-size:0.5em;border:1px solid;padding:2px 4px;border-radius:2px;color:currentColor;}.css-3x8wln .date{font-size:0.8em;}.css-3x8wln .author{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-gap:8px;padding-top:8px;}.css-3x8wln .author img{border-radius:4px;}</style><div class="css-3x8wln"><div class="item"><a href="/frontend-expert/posts/css-cascade-layers"><div class="title">主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nus3" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nus3" src="/frontend-expert//member-icons/nus3.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-03-22</span></div><div class="tags"><span class="tag">CSS</span></div></a></div><div class="item"><a href="/frontend-expert/posts/tc39-meeting-2022-01"><div class="title">ECMAScriptの最新動向 2022年01月版</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="sosukesuzuki" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="sosukesuzuki" src="/frontend-expert//member-icons/sosukesuzuki.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-03-09</span></div><div class="tags"><span class="tag">TC39</span><span class="tag">ECMAScript</span></div></a></div><div class="item"><a href="/frontend-expert/posts/release-chrome-98"><div class="title">COLRv1 fontのサポートなど、Chrome 98 リリースノートまとめ</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nus3" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nus3" src="/frontend-expert//member-icons/nus3.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-02-18</span></div><div class="tags"><span class="tag">Releasenote</span><span class="tag">Browser</span></div></a></div><div class="item"><a href="/frontend-expert/posts/considerations-for-monorepo"><div class="title">フロントエンドのモノレポ構成はスケーリングの夢を見るか</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nus3" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nus3" src="/frontend-expert//member-icons/nus3.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-01-31</span></div><div class="tags"><span class="tag">Monorepo</span><span class="tag">Turborepo</span></div></a></div><div class="item"><a href="/frontend-expert/posts/tc39-meeting-2021-12"><div class="title">ECMAScriptの最新動向 2021年12月版</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="sosukesuzuki" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="sosukesuzuki" src="/frontend-expert//member-icons/sosukesuzuki.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-01-24</span></div><div class="tags"><span class="tag">TC39</span><span class="tag">ECMAScript</span></div></a></div><div class="item"><a href="/frontend-expert/posts/release-chrome-97"><div class="title">Web Transportのサポートなど、Chrome 97 リリースノートまとめ</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="Saji" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Saji" src="/frontend-expert//member-icons/saji.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-01-21</span></div><div class="tags"><span class="tag">Releasenote</span><span class="tag">Browser</span></div></a></div><div class="item"><a href="/frontend-expert/posts/release-firefox-96"><div class="title">CSS color-scheme サポート追加等 Firefox 96.0 リリースノートまとめ</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="BaHo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="BaHo" src="/frontend-expert//member-icons/baho.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-01-20</span></div><div class="tags"><span class="tag">Releasenote</span><span class="tag">Browser</span></div></a></div><div class="item"><a href="/frontend-expert/posts/turborepo"><div class="title">workspaceを使ったコマンドを最適化して実行するTurborepoについて</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nus3" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nus3" src="/frontend-expert//member-icons/nus3.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-01-17</span></div><div class="tags"><span class="tag">Turborepo</span><span class="tag">Monorepo</span></div></a></div><div class="item"><a href="/frontend-expert/posts/release-firefox-95"><div class="title">新しいコードサンドボックス機能 RLBox の追加など Firefox 95.0 リリースノートまとめ</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="BaHo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="BaHo" src="/frontend-expert//member-icons/baho.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2021-12-20</span></div><div class="tags"><span class="tag">Releasenote</span><span class="tag">Browser</span></div></a></div><div class="item"><a href="/frontend-expert/posts/team-activity-logs-2021"><div class="title">長期運用プロダクトを抱える組織で横断的なフロントエンド支援チームが1年で行なったこと</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nakajmg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nakajmg" src="/frontend-expert//member-icons/nakajmg.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2021-12-18</span></div><div class="tags"><span class="tag">Cybozu</span><span class="tag">FrontendExpert</span></div></a></div></div><style data-emotion="css 1fxj6lq">.css-1fxj6lq{margin-top:40px;margin-bottom:32px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;grid-gap:8px;}.css-1fxj6lq a{border:1px solid #dedede;text-align:center;padding:8px 16px;border-radius:2px;}.css-1fxj6lq a:hover{border-color:currentColor;}.css-1fxj6lq .isCurrentPage{color:inherit;border-color:black;}</style><div class="css-1fxj6lq"><a href="/frontend-expert/posts/page/1">1<!-- --></a><a href="/frontend-expert/posts/page/2">2<!-- --></a><a href="/frontend-expert/posts/page/3">3<!-- --></a><a href="/frontend-expert/posts/page/4">4<!-- --></a><a class="isCurrentPage">5<!-- --></a><a href="/frontend-expert/posts/page/6">6<!-- --></a><a href="/frontend-expert/posts/page/7">7<!-- --></a></div></div></div></main><style data-emotion="css 1n88omd">.css-1n88omd{padding:2.4rem 0;background-color:var(--primary-color);color:white;}.css-1n88omd .content{max-width:var(--content-width);padding:0 1.2rem;box-sizing:border-box;margin:0 auto;}.css-1n88omd a{color:white;}.css-1n88omd ul{list-style:none;margin-bottom:2.5rem;}.css-1n88omd ul li{font-size:1.2rem;margin-bottom:0.5rem;}.css-1n88omd small{font-size:1rem;}</style><footer class="css-1n88omd"><div class="content"><ul><li><a href="https://cybozu.co.jp/" target="_blank" rel="noreferrer">サイボウズ 企業情報</a></li><li><a href="https://www.cybozu.com/jp/" target="_blank" rel="noreferrer">cybozu.com</a></li><li><a href="https://blog.cybozu.io/" target="_blank" rel="noreferrer">サイボウズエンジニアのブログ Cybozu Inside Out</a></li><li><a href="https://tech.cybozu.io/" target="_blank" rel="noreferrer">Cybozu Tech</a></li><li><a href="https://cybozu.co.jp/recruit/" target="_blank" rel="noreferrer">採用情報</a></li></ul><small>Copyright © Cybozu, Inc.</small></div></footer></div>;<!-- --></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"type":"markdown","href":"/posts/css-cascade-layers","slug":"css-cascade-layers","content":"\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/\"\u003eChrome99\u003c/a\u003eに新機能として CSS Cascade Layers が実装され、Firefox、Edge、Safari といった主要ブラウザで CSS Cascade Layers が使えるようになりました。\u003c/p\u003e\n\u003ch2\u003eCSS Cascade Layers とは\u003c/h2\u003e\n\u003cp\u003eCSS の仕様において、要素にどのスタイルを適用するかはざっくりと次のような優先順位で決定されていました。(カスケード順を省いて簡略的に記述しています)\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここに CSS Cascade Layers が導入されると次のように変わります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCascade Layers\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e従来の CSS が抱える複雑な詳細度の管理\u003c/h2\u003e\n\u003cp\u003eどのスタイルを適用するか判断するのにセレクターの詳細度を用いる場合は、詳細度がより高いものが適用されます。\u003c/p\u003e\n\u003cp\u003eセレクターの詳細度は、高い順に次のような順番になります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eID セレクター: \u003ccode\u003e#example\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eクラスセレクター: \u003ccode\u003e.example\u003c/code\u003e, 属性セレクター: \u003ccode\u003e[type=\"radio\"]\u003c/code\u003e, 疑似クラス: \u003ccode\u003e:hover\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e要素型セレクター: \u003ccode\u003eh1\u003c/code\u003e, 擬似要素: \u003ccode\u003e::before\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eまた、単純にセレクターの種類だけでなく、セレクターの数も詳細度に影響します。\u003c/p\u003e\n\u003cp\u003e参考: \u003ca href=\"https://specifishity.com/\"\u003ehttps://specifishity.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCSS の記述量が増えていくにつれ、この詳細度をうまく管理できず意図しないスタイルが適用されることがままあります。意図しないスタイルが適用されないために、セレクターの命名規則を厳格にする\u003ca href=\"http://getbem.com/naming/\"\u003eBEM\u003c/a\u003eなどの設計手法を取り入れて対応することもあります。\u003c/p\u003e\n\u003cp\u003eしかし、命名規則をベースとした設計手法では、サードパーティの CSS ライブラリを使用する場合や、コントロールが難しいくらい多い記述量の CSS になってしまった場合、全体の詳細度を把握して管理することはなかなか大変です。\u003c/p\u003e\n\u003ch2\u003eCascade Layers によってどう変わるか\u003c/h2\u003e\n\u003cp\u003eCascade Layers を使うと、セレクターの詳細度よりも優先してスタイルが適用されるレイヤーを定義できるようになります。\u003c/p\u003e\n\u003cp\u003e実際にコードで見てみましょう。\u003c/p\u003e\n\u003ch3\u003e通常の詳細度を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers を使わない場合、同じ詳細度のセレクターは属性値での記述順に関わらず、スタイルシート内で最後に宣言されたスタイルが適用されます。\u003c/p\u003e\n\u003cp\u003e次の場合、\u003ccode\u003e.base\u003c/code\u003e と \u003ccode\u003e.nus3\u003c/code\u003e は同一の詳細度です。また、1 つ目の \u003ccode\u003e.base\u003c/code\u003e は最後に記述されている \u003ccode\u003e.base\u003c/code\u003e によって上書きされます。このボタンには\u003ccode\u003estyle\u003c/code\u003e内で一番最後に記述されている \u003ccode\u003e.base\u003c/code\u003e のスタイルが適用され、背景色が \u003ccode\u003eroyalblue\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eroyalblue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebase nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eroyalblueになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた、セレクターの詳細度は種類によって異なり、要素セレクター \u0026#x3C; クラスセレクター \u0026#x3C; ID セレクター の順に高くなります。\u003c/p\u003e\n\u003cp\u003e次の場合、ID セレクター(\u003ccode\u003e#btn\u003c/code\u003e)のほうがクラスセレクター(\u003ccode\u003e.nus3\u003c/code\u003e) や要素セレクター(\u003ccode\u003ebutton\u003c/code\u003e)よりも詳細度が高いので、\u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecoral\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eblack\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ecrimsonになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eCascade Layers を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers では、まず\u003ccode\u003e@layer\u003c/code\u003e構文を使ってレイヤーを定義します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e`\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e`\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのとき、base、page、utilities の 3 つのレイヤーを定義するとともに、レイヤーの優先順位を定義しています。\u003c/p\u003e\n\u003cp\u003eこの場合、各レイヤーのスタイルは後ろに定義したものほど優先度が高く、次のような優先度でスタイルが適用されます。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eutilities\u003c/li\u003e\n\u003cli\u003epage\u003c/li\u003e\n\u003cli\u003ebase\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここではレイヤーの定義と優先度を同時に定義していますが、この記述を省略した場合、あとに定義したレイヤーの優先度が高くなります。\u003c/p\u003e\n\u003cp\u003eレイヤーの動作についてサンプルコードで詳しく見てみましょう。\u003c/p\u003e\n\u003cp\u003e次のコードは、前述したコードをベースに \u003ccode\u003e@layer\u003c/code\u003e を追加したものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e utilities\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.shiny\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e page\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny base nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e１つ目のボタンはレイヤーがない場合には最後に宣言されている \u003ccode\u003e.nus3\u003c/code\u003e の \u003ccode\u003ewhite\u003c/code\u003e が適用されていましたが、優先度の高い utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e の \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e２つ目のボタンはレイヤーがない場合には ID セレクターの \u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されていましたが、この場合も utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e のほうが優先度が高いため、 \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e次のサンプルページを開いて、DevTools で対象の要素をみると Cascade Layers が適用されているのがわかります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://c1r38o.csb.app/\"\u003eサンプルページ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/css-cascade-layers/devtools.png\" alt=\"DevToolsで確認すると実際にCascade Layersが適用されている\" width=\"337\" height=\"400\" \u003e\u003c/p\u003e\n\u003cp\u003eレイヤーの適用順が utilities \u003e page \u003e base になってるのがわかります。\u003c/p\u003e\n\u003cp\u003eこのように、Cascade Layers を使うことで、詳細度ではなくレイヤーでスタイルをコントロールできるようになります。\u003c/p\u003e\n\u003ch3\u003eCascade Layers 内で\u003ccode\u003e!important\u003c/code\u003eを使った際のスタイルの優先順位\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e!important\u003c/code\u003eを使っていない場合、Cascade Layers で定義したレイヤー外のスタイルが優先して適用されます。\u003c/p\u003e\n\u003cp\u003eこれはカスケード順が、レイヤー内 \u0026#x3C; レイヤー外 の順に高くなっているからです。\u003c/p\u003e\n\u003cp\u003e次のコードでは、レイヤー外のスタイルが適用され、ボタンの背景色が\u003ccode\u003ewhite\u003c/code\u003eになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ewhiteになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、\u003ccode\u003e!important\u003c/code\u003eを使ったスタイルの場合、このカスケード順が変わるので注意が必要です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eCSS フレームワークにも Cascade Layers は使える\u003c/h2\u003e\n\u003cp\u003eBootstrap や Materialize CSS、Bulma といった CSS フレームワークにも Cascade Layers を使ってレイヤーを定義できます。\u003c/p\u003e\n\u003cp\u003eCSS フレームワークの一つである\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eを使って試してみましょう。\u003c/p\u003e\n\u003cp\u003e本来、次のようなクラスをボタンに付与すると、Bulma で元から定義されている\u003ccode\u003e.button.is-primary\u003c/code\u003eが、後に追加した\u003ccode\u003e.button-nus3\u003c/code\u003eより詳細度が高くなり、\u003ccode\u003e.button-nus3\u003c/code\u003eのスタイルは適用されません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebutton is-primary button-nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eボタン\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* styles/page.cssで定義されているスタイル */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.button-nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし次のように Cascade Layers を使い、\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eの CSS を\u003ccode\u003ebase\u003c/code\u003eのレイヤーにしつつ、画面特有のスタイルを\u003ccode\u003estyles/page.css\u003c/code\u003eに定義することで、詳細度の影響を気にすることなく Bulma のスタイルを上書きすることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e対象ブラウザのサポート状況は考慮する必要がありますが、CSS の記述量が増えることが想定されるプロジェクトには、Cascade Layers をベースにした設計を検討してみてはいかがでしょうか。\u003c/p\u003e\n\u003ch2\u003e参考リンクなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.w3.org/TR/css-cascade-5/\"\u003ehttps://www.w3.org/TR/css-cascade-5/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@layer\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/@layer\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/cascade-layers/\"\u003ehttps://developer.chrome.com/blog/cascade-layers/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nus3/p-css-cascade-layers\"\u003eサンプル実装したリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える","author":"nus3","editor":["nakajmg"],"createdAt":"2022-03-22","summary":"CSS Cascade Layersを使ったスタイルの管理方法について紹介します","tags":["CSS"],"updatedAt":"2022-03-22"}},{"type":"markdown","href":"/posts/tc39-meeting-2022-01","slug":"tc39-meeting-2022-01","content":"\u003cp\u003eこの記事では2021年01月24日~27日に開催された TC39 meeting 88th で議題に上がったプロポーザルについて紹介します。\u003c/p\u003e\n\u003ch2\u003eFor Stage 4\u003c/h2\u003e\n\u003cp\u003eFor Stage 4 の提案はありませんでした。\u003c/p\u003e\n\u003ch2\u003eFor Stage 3\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eArray.fromAsync\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 3 にはなりませんでした。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eArray.fromAsync\u003c/code\u003e は次のようにして非同期イテラブルから配列を生成するスタティックメソッドを追加するプロポーザルです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003en\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eyield\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e arr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eArray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efromAsync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/issues/19\"\u003ehttps://github.com/tc39/proposal-array-from-async/issues/19\u003c/a\u003e で指摘された問題のため、Stage 3 にはなりませんでした。\u003c/p\u003e\n\u003ch2\u003eFor Stage 2\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-class-brand-check\"\u003eClass brand checks\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 にはなりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eClass brand checks は brand check のための新しい構文を導入するプロポーザルです。\u003c/p\u003e\n\u003cp\u003ebrand check は TC39 内で使われる用語で、\u003ca href=\"https://github.com/tc39/how-we-work/blob/master/terminology.md#brand-check\"\u003ehttps://github.com/tc39/how-we-work/blob/master/terminology.md#brand-check\u003c/a\u003e で説明されています。\u003c/p\u003e\n\u003cp\u003ebrand check とは、雑に言えば「ある値があるデータ型であることを検証すること」です。たとえば \u003ccode\u003eArray.isArray\u003c/code\u003e は brand check です(\u003ca href=\"https://zenn.dev/sosukesuzuki/articles/e0516a3d4c424e\"\u003e\u003ccode\u003einstanceof\u003c/code\u003e は厳密ではない\u003c/a\u003eため brand check ではありません)。\u003c/p\u003e\n\u003cp\u003e以前 brand check の方法の一つである \u003ca href=\"https://github.com/tc39/proposal-private-fields-in-in\"\u003eErgonomic brand checks for private fields\u003c/a\u003e についての記事を書いたので興味のある方はそちらもご覧ください。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.github.io/frontend-expert/posts/ergonomic-brand-checks-for-private-fields\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eClass branc check プロポーザルでは \u003ccode\u003eclass.hasInstance(x)\u003c/code\u003e という新しい Meta Property を追加します。これはクラスの中でのみ使うことができ、引数として渡された値が今いるクラスのインスタンスかどうかをチェックします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehasInstance\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e obj \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eisFoo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eobj\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 1\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/rbuckton/proposal-enum\"\u003eenum\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 にはなりませんでした。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eenum は列挙型を実現するためのプロポーザルです。このプロポーザルは 4 年ほど前から存在していましたがまた動き出したようです。\u003c/p\u003e\n\u003cp\u003eenum プロポーザルでは次のような構文を導入します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eenum\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eSyntaxKind\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eC\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e他のプログラミング言語の enum と構文上は似ています。\u003c/p\u003e\n\u003cp\u003eしかし細部の仕様について検討すべき事項が多く、今回のミーティングでは Stage 1 に到達することはありませんでした。\u003ca href=\"https://docs.google.com/presentation/d/14WtGmdWjEYXIXZVWJWpERF98D90_BytceAu7b7DKr5Q/edit#slide=id.g10effb28f4f_0_273\"\u003eこのスライド\u003c/a\u003eに詳しくまとまっているので興味のある方はご覧ください。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-reversible-string-split\"\u003eReversible string split\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1 になりました。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eReversible string split は可逆(Reversible)の文字列分割のための方法を導入するプロポーザルです。\u003c/p\u003e\n\u003cp\u003eJavaScript では \u003ccode\u003eString.prototype.split\u003c/code\u003e を使って文字列を分割できます。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/split\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B', 'C', 'D', 'E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eString.prototype.split\u003c/code\u003e は第2引数として非負の整数を渡すことで、分割する数を制限できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A' ]\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B' ]\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted3 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B', 'C' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eJavaScript 以外のいくつかの言語(Perl、PHP、Ruby、Go、Rust、Java など)では第2引数を受け取った \u003ccode\u003eString.prototype.split\u003c/code\u003e に相当する機能は、次のように文字列の分割を行います。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B,C,D,E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eN-1 回分割され、残りの部分が戻り値の配列の末尾に含まれています(戻り値の配列の要素数が N)。\u003c/p\u003e\n\u003cp\u003eReversible string split プロポーザルでは、このような振る舞いを持つ新しいメソッド \u003ccode\u003eString.prototype.splitN\u003c/code\u003e を導入します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e splitted2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplitN\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esplitted2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// [ 'A', 'B,C,D,E' ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのような文字列分割メソッドを使うと、次のようにして分割する前の文字列を取得できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"A,B,C,D,E\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e separator \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e n \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esplitN\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eseparator\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejoin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eseparator\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e提案の名前に含まれている Reversible というのはこのような可逆性のことを指しているようです。\u003c/p\u003e\n\u003ch2\u003eUpdates\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-symbols-as-weakmap-keys\"\u003eSymbols as WeakMap keys\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSymbols as WeakMap keys は Symbol を WeakMap のキーとして使えるようにするためのプロポーザルです。\u003c/p\u003e\n\u003cp\u003e現在では一部情報が古くなっていますが以前このプロポーザルについて解説する記事を書いたので興味がある方はそちらもご覧ください。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://sosukesuzuki.dev/posts/symbols-as-weakmap-keys\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e以前から Symbols as WeakMap keys プロポーザルのモチベーションや基本的な振る舞いについては概ね合意がとれていました。しかし、Well-knwon Symbols やグローバルシンボルレジストリに登録された Symbol (Eternal Symbol と呼ばれている)についてはどのように扱うべきかという点で TC39 メンバー内でも意見が分かれていました。\u003c/p\u003e\n\u003cp\u003e今回のミーティングで Symbols as WeakMap keys チャンピョングループは、Eternal Symbol を WeakMap のキーとして使おうとするとエラーが throw されるという振る舞いを選択したことを発表しました。それにともなって、\u003ccode\u003eWeakMap.isValidKey(x)\u003c/code\u003e、\u003ccode\u003eWeakSet.isValidValue(x)\u003c/code\u003e、\u003ccode\u003eWeakRef.isValidTarget(x)\u003c/code\u003e、\u003ccode\u003eFinalizationRegistry.isValidTarget(x)\u003c/code\u003e などのいくつかのスタティックメソッドが追加される可能性があります。\u003c/p\u003e\n\u003cp\u003eしかし議事録によればまだ TC39 メンバーの中で意見が分かれているため仕様の決定には時間がかかりそうです。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/agendas/blob/main/2022/01.md\"\u003eagendas/01.md at main · tc39/agendas\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-24.md\"\u003enotes/jan-24.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-25.md\"\u003enotes/jan-25.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/notes/blob/main/meetings/2022-01/jan-26.md\"\u003enotes/jan-26.md at main · tc39/notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eProposal Array.fromAsync\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-symbols-as-weakmap-keys\"\u003eProposal Symbols as WeakMap keys\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-class-brand-check\"\u003eProposal \u003ccode\u003eclass.hasInstance()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/rbuckton/proposal-enum\"\u003eProposal enum\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-reversible-string-split\"\u003eProposal Reversible string split\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eBabel\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/proposals/issues/80\"\u003eJan 2022 · Issue #80 · babel/proposals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"ECMAScriptの最新動向 2022年01月版","author":"sosukesuzuki","createdAt":"2022-03-09","summary":"2021年01月24日~27日に開催された TC39 meeting 88th の内容を紹介します","tags":["TC39","ECMAScript"],"updatedAt":"2022-03-09"}},{"type":"markdown","href":"/posts/release-chrome-98","slug":"release-chrome-98","content":"\u003cp\u003eChrome 98 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-98/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-98/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-98/\"\u003ehttps://developer.chrome.com/blog/deps-rems-98/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D98\"\u003ehttps://www.chromestatus.com/features#milestone%3D98\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 98)\u003c/h2\u003e\n\u003cp\u003eChrome98 で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eOpting out of auto-dark themes on Android\u003c/h3\u003e\n\u003cp\u003eChrome96 から、Android では OriginTrial として「\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/\"\u003eAuto Dark Themes\u003c/a\u003e」という機能を追加しています。\u003c/p\u003e\n\u003cp\u003eこの機能はユーザーの OS がダークモードである場合、明るいテーマのサイトに対しブラウザが自動的に生成したダークテーマを適用するものです。\u003c/p\u003e\n\u003cp\u003e今回のアップデートでは OriginTrial に登録したサイトのうち、特定のページで自動生成されるダークテーマを無効にする方法が追加されました。\u003c/p\u003e\n\u003cp\u003e具体的には以下のように\u003ccode\u003emeta\u003c/code\u003eタグを利用して無効化することが出来ます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003emeta\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ename\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ecolor-scheme\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003econtent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eonly light\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた以下のように\u003ccode\u003ecolor-scheme: only light\u003c/code\u003eというスタイルを\u003ccode\u003e:root\u003c/code\u003e要素にあてることでも無効化できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token pseudo-class\"\u003e:root\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolor-scheme\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e only light\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCSS スタイルを利用する方法の優れた点として、以下のように要素ごとに自動生成されるダークテーマを無効にできる点が挙げられます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.only-light\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token id\"\u003e#my-element\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ecolor-scheme\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e only light\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e詳しくは\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/\"\u003eAuto Dark Themes on Android\u003c/a\u003eにおける\u003ca href=\"https://developer.chrome.com/blog/auto-dark-theme/#per-element-opt-out\"\u003eHow to opt-out of Auto Dark Theme\u003c/a\u003eの章を参照してください。\u003c/p\u003e\n\u003ch3\u003eCOLRv1 font support\u003c/h3\u003e\n\u003cp\u003eCOLRv1 フォントがサポートされました。\u003c/p\u003e\n\u003cp\u003eCOLRv1 では COLRv0 と比べて、新たにフォントのグラデーションや合成などに対応しています。また、フォントが鮮明なまま圧縮率が高いのも特徴の一つです。\u003c/p\u003e\n\u003cp\u003e次の参考記事では実際にグラデーションを導入したカラーフォントや COLRv1 と Bitmap を比較してどれほど鮮明なのかを確認することができます。\u003c/p\u003e\n\u003cp\u003eお使いの Chrome のバージョンを 98 にアップデートした上で、ぜひ見てみてください！\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/colrv1-fonts/\"\u003ehttps://developer.chrome.com/blog/colrv1-fonts/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eEmulate Chrome 100 in the UA string\u003c/h3\u003e\n\u003cp\u003eここ何回かのリリースには必ず含まれている内容ですね。\u003c/p\u003e\n\u003cp\u003eChrome のバージョンがもうすぐ 100 になるので、Chrome のバージョンを使っているような実装がある場合はバージョン番号が 3 桁になっても正しく動くかどうか確認しましょう。現在のバージョンを 100 にする\u003ca href=\"https://developer.chrome.com/blog/force-major-version-to-100/\"\u003e#force-major-version-to-100\u003c/a\u003eフラグを使って、既存のコードが正しく動くか確認することができます。\u003c/p\u003e\n\u003ch3\u003eAnd more!\u003c/h3\u003e\n\u003ch2\u003eWhat's New In DevTools (Chrome 98)\u003c/h2\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eDeprecations and removals in Chrome 98\u003c/h2\u003e\n\u003ch3\u003eRemove SDES key exchange for WebRTC\u003c/h3\u003e\n\u003cp\u003eChrome97 で記載があったものですが、98 で Shipping になりました。\u003c/p\u003e\n\u003cp\u003e詳細は\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/release-chrome-97\"\u003e前回のリリースノートのまとめ\u003c/a\u003eでも記載したので、そちらをご覧ください。\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003ch3\u003eAdd support for Promise to Blobs in clipboard item\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eClipboardItem\u003c/code\u003eオブジェクトに対して Promise をサポートしました。\u003c/p\u003e\n\u003cp\u003e今まで、Chrome では\u003ccode\u003eClipboardItem\u003c/code\u003eコンストラクターの引数として「文字列または blob に解決される Promise」を受け取ることが出来ませんでした。\u003c/p\u003e\n\u003cp\u003e今回のアップデートにより\u003ccode\u003eclipboard.write\u003c/code\u003eAPI が呼ばれた時に、一旦クリップボードに書き込む Blob データを同期的に取得する必要がなくなり、ブロックすることなく非同期的に write メソッドを呼び出すことができるようになります。\u003c/p\u003e\n\u003ch3\u003eCSS Color Adjust: 'only' keyword for color-scheme\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecolor-scheme\u003c/code\u003eプロパティの\u003ccode\u003eonly\u003c/code\u003eキーワードがサポートされました。only を指定することでユーザーエージェント(ブラウザ)が要素のカラースキーマを上書きすることを禁止します。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\"\u003ehttps://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://drafts.csswg.org/css-color-adjust/#color-scheme-prop\"\u003ehttps://drafts.csswg.org/css-color-adjust/#color-scheme-prop\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFileSystemHandle::Remove() method\u003c/h3\u003e\n\u003cp\u003eFileSystemHandle に\u003ccode\u003eRemove()\u003c/code\u003eメソッドを追加しました。\u003c/p\u003e\n\u003cp\u003e今ままで\u003ccode\u003eFileSystemHandle\u003c/code\u003eから直接ファイルやディレクトリを削除することは不可能で、親ディレクトリの\u003ccode\u003eFileSystemDirectoryHandle\u003c/code\u003eから\u003ccode\u003eRemoveEntry\u003c/code\u003eを呼ぶ必要がありました。\u003c/p\u003e\n\u003cp\u003e今回のアップデートにより「\u003ccode\u003eshowSaveFilePicker\u003c/code\u003eから\u003ccode\u003eFileHandle\u003c/code\u003eを取得したが、結局保存したくなくなったのでファイルを削除したい」というような、よくあるユースケースに対応できるようになりました。\u003c/p\u003e\n\u003ch3\u003eHDR CSS Media Queries: dynamic-range\u003c/h3\u003e\n\u003cp\u003eCSS のメディアクエリーに\u003ccode\u003edynamic-range\u003c/code\u003eが追加されました。\u003c/p\u003e\n\u003cp\u003e次のサンプルコードのように、ディスプレイが HDR をサポートしてるかしていないかを\u003ccode\u003edynamic-range\u003c/code\u003eで判別できるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token comment\"\u003e/* HDRをサポートしていない */\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003edynamic-range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e standard\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ered\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* ディスプレイがHDRをサポートしている */\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@media\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token property\"\u003edynamic-range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e high\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.contrast\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egreen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.w3.org/TR/mediaqueries-5/#dynamic-range\"\u003ehttps://www.w3.org/TR/mediaqueries-5/#dynamic-range\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eNew window.open() popup vs. window behavior\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ewindow.open()\u003c/code\u003eでは第 3 引数として\u003ccode\u003ewindowFeatures\u003c/code\u003eという option を DOMString で指定できますが、今バージョンから\u003ccode\u003epopup\u003c/code\u003eという機能に対応するようになりました。\u003ccode\u003e popup=yes\u003c/code\u003eまたは\u003ccode\u003epopup=1\u003c/code\u003eのように指定することで、ポップアップウィンドウを利用して開くことをブラウザに要求することが出来ます。\u003c/p\u003e\n\u003cp\u003eこの変更は window.open の新しくリリースされた仕様に合わせて、相互運用性のために行われた変更です。 広報互換性のため、ポップアップやタブ/ウィンドウを開く既存の動作に変更はありません。\u003c/p\u003e\n\u003ch3\u003ePrivate Network Access preflight requests for subresources\u003c/h3\u003e\n\u003cp\u003eサブリソースに対するプライベートネットワークリクエストの前に CORS プリフライトリクエストを送信し、ターゲットサーバーからの明示的な許可を求めるようになります。\u003c/p\u003e\n\u003cp\u003eプライベートネットワークリクエストとは以下のようなリクエストとのことです。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eパブリック Web サイトからプライベート IP アドレスまたはローカルホストへのリクエスト\u003c/li\u003e\n\u003cli\u003eプライベートな Web サイト（イントラネットなど）からローカルホストへのリクエスト\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eプライベートネットワーク上のサービスや機器(ネットワーク機器やプリンタなど)は CSRF 対策が不十分なものが多く、今回のアップデートはこれらの攻撃リスクを軽減させるための対策になります。\u003c/p\u003e\n\u003ch3\u003eWritableStream controller AbortSignal\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/WritableStream/abort\"\u003eWritableStream.abort()\u003c/a\u003eを実行した際に、ストリームへの進行中の書き込みの中止や終了がすぐに実行されるようになりました。\u003c/p\u003e\n\u003ch3\u003eself.structuredClone()\u003c/h3\u003e\n\u003cp\u003eディープコピーができる\u003ccode\u003estructuredClone()\u003c/code\u003eがついに 98 で実装されました。\u003c/p\u003e\n\u003cp\u003eお使いの Chrome を 98 にアップデートした上で、DevTools の Console で次のサンプルコードを試しに実行してみると\u003ccode\u003estructuredClone()\u003c/code\u003eで実際にディープコピーが実行されていることが確認できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myOriginal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003esomeProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"with a string value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myShallowCopy \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003emyOriginal \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmyShallowCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"a new value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  myOriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  myShallowCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myOriginal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003esomeProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"with a string value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e myDeepCopy \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003estructuredClone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emyOriginal\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmyDeepCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"a new value\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  myOriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  myDeepCopy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanotherProp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewithAnotherProp\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://web.dev/structured-clone/\"\u003ehttps://web.dev/structured-clone/\u003c/a\u003e\u003c/p\u003e\n","metaData":{"title":"COLRv1 fontのサポートなど、Chrome 98 リリースノートまとめ","author":"nus3","editor":"Saji","createdAt":"2022-02-18","summary":"Chrome 98 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2022-02-18"}},{"type":"markdown","href":"/posts/considerations-for-monorepo","slug":"considerations-for-monorepo","content":"\u003cp\u003eそれっぽいタイトルを付けましたが特に意味はないです。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/turborepo\"\u003eworkspace を使ったコマンドを最適化して実行する Turborepo について\u003c/a\u003eのお話で Turborepo を軽く触ってみた際に\u003ccode\u003enpx create-turbo@latest\u003c/code\u003eで作られる構成がとてもわかりやすく、プロダクトの初期段階からモノレポを採用するのは選択肢の 1 つとしていいのでは、と思い続編を書きました。\u003c/p\u003e\n\u003cp\u003e前回と同じくサンプルのリポジトリはこちらになります。\u003cbr\u003e\n\u003ca href=\"https://github.com/nus3/p-turborepo/tree/main/yarn\"\u003ehttps://github.com/nus3/p-turborepo/tree/main/yarn\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eモノレポを採用することで、同一リポジトリ内で自作した汎用的なライブラリやコンポーネントを複数のアプリケーションで使いまわせる\u003c/li\u003e\n\u003cli\u003eモノレポの規模が大きくなってきた場合には、モノレポ内のパッケージを npm に公開することでアプリケーションとパッケージを非同期に開発できる\u003c/li\u003e\n\u003cli\u003eYarn や npm の workspace はイイゾ！\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eモノレポとは\u003c/h2\u003e\n\u003cp\u003eモノレポとは本記事では npm や Yarn の workspaces 機能を使い、1 つのリポジトリ内で複数の npm パッケージを管理している構成のこととします。\u003c/p\u003e\n\u003ch3\u003enpm や Yarn の workspaces\u003c/h3\u003e\n\u003cp\u003enpm や Yarn の workspaces は 1 つのリポジトリ内で複数の npm パッケージを管理するための機能です。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://classic.yarnpkg.com/lang/en/docs/workspaces/\"\u003eYarn(v1)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://yarnpkg.com/features/workspaces\"\u003eYarn(v2 以降)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.npmjs.com/cli/v8/using-npm/workspaces\"\u003enpm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eworkspaces を使うにはリポジトリのルート直下にある\u003ccode\u003epackage.json\u003c/code\u003eに\u003ccode\u003eworkspaces\u003c/code\u003eを追加します。\u003c/p\u003e\n\u003cp\u003e例えば\u003ccode\u003eapps\u003c/code\u003e配下にアプリケーションの npm パッケージを、\u003ccode\u003epackages\u003c/code\u003e配下に汎用的なコンポーネント、ライブラリなどの npm パッケージを入れる場合、次のようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"workspaces\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"apps/*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"packages/*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps\u003c/code\u003e 配下にある\u003ccode\u003enus3-a\u003c/code\u003eというアプリケーションから \u003ccode\u003epackages\u003c/code\u003e 配下にある\u003ccode\u003enus3-ui\u003c/code\u003eという名前の npm パッケージを使う場合、それぞれ次のような\u003ccode\u003epackage.json\u003c/code\u003eになります。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Yarnのv2以降であれば`workspace:`構文が使えるようになる\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// REF: (nus3) https://yarnpkg.com/features/workspaces#workspace-ranges-workspace\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// \"nus3-ui\": \"workspace:*\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eworkspaces 内にある npm パッケージの名前が npm に公開されているパッケージ名と同じ場合は、 workspace 内の npm パッケージが優先してインストールされます。後々 workspaces 内の npm パッケージを公開する可能性がある場合、パッケージ名は npm で公開されているパッケージ名と被らない名前にした方が良いかもしれません。\u003c/p\u003e\n\u003cp\u003eworkspace 内の npm パッケージを依存関係に追加すると node_modules にシンボリックリンクが作成されます。次の画像のように node_modules 配下に\u003ccode\u003enus3-ui\u003c/code\u003eと\u003ccode\u003enus3-a\u003c/code\u003eのシンボリックリンクが追加されていることが確認できます。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/considerations-for-monorepo/symlink.png\" alt=\"node_modulesに作成されたシンボリックリンク\" width=\"340\" height=\"101\" \u003e\u003c/p\u003e\n\u003cp\u003eシンボリックリンクにより依存する npm パッケージのコードを直接参照するので、npm に公開しバージョン管理するまでは、version は\u003ccode\u003e0.0.0\u003c/code\u003e、かつ、使う側は\u003ccode\u003e\"nus3-ui\": \"*\"\u003c/code\u003eのようにワイルドカードを指定するとバージョンのことを意識せずに管理できます。\u003c/p\u003e\n\u003ch3\u003ecreate-turbo で作られるモノレポ構成\u003c/h3\u003e\n\u003cp\u003ecreate-turbo(\u003ccode\u003enpx create-turbo@latest\u003c/code\u003e) では作られるモノレポ構成に次のようなものが含まれます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enpm に公開せずに config をモノレポ内の別パッケージに分けて、複数のパッケージから使用する\u003c/li\u003e\n\u003cli\u003eReact を使った汎用的なコンポーネント(tsx)を別パッケージに分けて アプリケーション(Next.js)で使用する\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eそれぞれ見ていきましょう。\u003c/p\u003e\n\u003ch4\u003enpm に公開せずに config をモノレポ内の別パッケージに分けて、複数のパッケージから使用する\u003c/h4\u003e\n\u003cp\u003eESLint や Stylelint の config は npm に公開することで、異なるプロジェクトで共通の設定を使えます。サイボウズでは\u003ca href=\"https://github.com/cybozu/eslint-config\"\u003e@cybozu/eslint-config\u003c/a\u003eや\u003ca href=\"https://github.com/cybozu/stylelint-config\"\u003e@cybozu/stylelint-config\u003c/a\u003eとして npm に公開しています。\u003c/p\u003e\n\u003cp\u003eモノレポ内であれば ESLint や Stylelint の設定を npm に公開・管理せずに共有することもできます。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-config\u003c/code\u003e\u003cbr\u003e\nで共通の ESLint や TSConfig を定義して、\u003ccode\u003epackage.json\u003c/code\u003e の\u003ccode\u003efiles\u003c/code\u003e に指定します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-config\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"files\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"eslint-preset.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.base.json\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.nextjs.json\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"tsconfig.react-library.json\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\nで\u003ccode\u003enus3-config\u003c/code\u003eを追加し、\u003ccode\u003enus3-config\u003c/code\u003eから TSConfig や ESLint のルールを適用します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"eslint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"8.6.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nus3-config\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/tsconfig.json\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"extends\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-config/tsconfig.nextjs.json\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/.eslintrc\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003emodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"nus3-config/eslint-preset\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4\u003eReact を使った汎用的なコンポーネント(tsx)を別パッケージに分けて アプリケーション(Next.js)で使用する\u003c/h4\u003e\n\u003cp\u003ecreate-turbo では汎用的な React コンポーネントを tsx ファイルのまま \u003ccode\u003epackages\u003c/code\u003e 配下の npm パッケージで管理し、Next.js の\u003ca href=\"https://github.com/martpie/next-transpile-modules\"\u003eplugin\u003c/a\u003eを使って アプリケーション 側でトランスパイルしています。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui\u003c/code\u003e\u003cbr\u003e\nで React(tsx)のコンポーネントを実装します。実装した tsx ファイルのパスをそのまま\u003ccode\u003emain\u003c/code\u003eと\u003ccode\u003etypes\u003c/code\u003eに追加します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"main\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./index.tsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"types\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./index.tsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/react\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"17.0.37\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/react-dom\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"17.0.11\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"typescript\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"4.5.4\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epackages/nus3-ui/index.tsx\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-tsx\"\u003e\u003ccode class=\"language-tsx\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eVFC\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"react\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eButton\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eVFC\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token plain-text\"\u003eボタン\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003enus3-ui\u003c/code\u003eの tsx ファイルを\u003ccode\u003enus3-a\u003c/code\u003eで\u003ccode\u003enext-transpile-modules\u003c/code\u003eを使ってトランスパイルします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nus3-a\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"next-transpile-modules\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"9.0.0\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eapps/nus3-a/next.config.js\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e withTM \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"next-transpile-modules\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"nus3-ui\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ewithTM\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eフロントエンドのモノレポ戦略\u003c/h2\u003e\n\u003cp\u003e筆者のこれまでの経験では、創業して間もない会社やプロダクトの初期フェーズで、複数のアプリケーションの開発が並列して始まることが多くありました。そういった状況では、モノレポを採用しておくと複数のアプリケーションで共通したコンポーネントやライブラリを少ないコストで使用できます。\u003c/p\u003e\n\u003cp\u003eまた、モノレポ内で共通して使っているパッケージに変更を加える際に、その影響範囲が把握できないくらいモノレポの規模が大きくなった場合には、パッケージを npm に公開してバージョン管理することで、バージョンの変更タイミングを各々のアプリケーションに任せることができ、アプリケーションとパッケージの開発を非同期に行うことができます。\u003c/p\u003e\n\u003cp\u003eこのように、初期段階では汎用的な npm パッケージをアセットとして複数のアプリケーションに提供することで開発スピードを上げられ、また、規模が大きくなってきた場合はパッケージを npm に公開するといった方針をとることもできます。\u003c/p\u003e\n\u003cp\u003eもちろん、1 つのリポジトリですべてのパッケージを管理することやコードベースが大きく複雑になることなどデメリットもあり、モノレポを採用することが適切ではない場合もあります。メリット・デメリットを踏まえつつ、フロントエンドの技術選定の中にモノレポの採用を選択肢の 1 つとして入れてもいいかもしれません。\u003c/p\u003e\n","metaData":{"title":"フロントエンドのモノレポ構成はスケーリングの夢を見るか","author":"nus3","editor":["nakajmg"],"createdAt":"2022-01-31","summary":"Turborepoのstarterでできるモノレポ構成からスケーリングするフロントエンドの構成について考える","tags":["Monorepo","Turborepo"],"updatedAt":"2022-01-31"}},{"type":"markdown","href":"/posts/tc39-meeting-2021-12","slug":"tc39-meeting-2021-12","content":"\u003cp\u003eTC39 の 87 回目のミーティングが 12月14日 ~ 12月15日に開催されました。このミーティングで議題に上がった提案とそのステージの移動について紹介します。\u003c/p\u003e\n\u003ch2\u003eFor Stage 4\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eFor Stage 4 の提案はありませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003eFor Stage 3\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-grouping\"\u003eArray Grouping\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 3 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eArray Grouping は \u003ccode\u003eArray.prototype.groupBy\u003c/code\u003e と \u003ccode\u003eArray.prototype.groupByToMap\u003c/code\u003e を追加するプロポーザルです。\u003c/p\u003e\n\u003cp\u003e2021 年 10 月のミーティングで Stage 2 になったばかりですが、今回のミーティングで Stage 3 になりました。\u003c/p\u003e\n\u003cp\u003eまた、今回から \u003ccode\u003eArray.prototype.groupByToMap\u003c/code\u003e が追加されています。\u003c/p\u003e\n\u003cp\u003eこれは \u003ccode\u003egroupBy\u003c/code\u003e の結果が \u003ccode\u003eMap\u003c/code\u003e になったものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e array \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e odd  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eodd\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e even \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eeven\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e map \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egroupByToMap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003enum\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e num \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e even\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e odd\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emap\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Map { {odd: true}: [1, 3, 5], {even: true}: [2, 4] }\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 2\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eArray.fromAsync\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eArray.fromAsync\u003c/code\u003e は非同期イテラブルから配列を生成するためのスタティックメソッドを追加するプロポーザルです。\u003c/p\u003e\n\u003cp\u003eJavaScript では \u003ccode\u003eArray.from\u003c/code\u003e を使ってイテラブルから配列を生成できます。しかし、非同期イテラブルから配列を生成することはできません。\u003c/p\u003e\n\u003cp\u003eこのプロポーザルによって追加される \u003ccode\u003eArray.fromAsync\u003c/code\u003e メソッドを使うと次のようにして非同期イテラブルから配列を生成できます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003en\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e n\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eyield\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e arr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eArray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efromAsync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003easyncGen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-r-escape\"\u003eRegExp \u003ccode\u003e\\R\u003c/code\u003e escape\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp \u003ccode\u003e\\R\u003c/code\u003e escape は以前 \u003ca href=\"https://github.com/rbuckton/proposal-regexp-features\"\u003eRegExp Language Features\u003c/a\u003e として提案されていた正規表現の機能群の１つで、正規表現内で line terminator とシンプルにマッチングさせるために新しく \u003ccode\u003e\\R\u003c/code\u003e を導入する提案です。\u003c/p\u003e\n\u003cp\u003eこの機能は \u003ccode\u003eu\u003c/code\u003e もしくは \u003ccode\u003ev\u003c/code\u003e フラグが有効になっているときのみ有効になります。そして、大まかには次のパターンと等価です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\\r\\n\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e|\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\\x0A\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\\x0C\\x85\\u\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2028\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\\u\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2029\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこの正規表現の機能は Perl をはじめとする多くの正規表現エンジンに実装されていて、TC39 においてもそのユースケースは認められているようです。\u003c/p\u003e\n\u003cp\u003eしかし、\u003ca href=\"https://github.com/tc39/proposal-regexp-set-notation\"\u003eRegExp Set Notation Proposal\u003c/a\u003e の sequece properties によって同等の機能が実現できる可能性があるためその方向で調査しなおすべきだという結論になり Stage 2 には到達しませんでした。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-modifiers\"\u003eRegExp Modifiers\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp Modifiers は \u003ccode\u003e\\R\u003c/code\u003e escape と同じようにもともと RegExp Language Features の機能の１つでした。\u003c/p\u003e\n\u003cp\u003eこの提案は正規表現パターン内でのフラグの変更を可能にします。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cp\u003e次の例中の正規表現パターン全体には \u003ccode\u003ei\u003c/code\u003e フラグが適用されてます。しかし２つめの \u003ccode\u003e[a-z]\u003c/code\u003e は \u003ccode\u003e?-i:\u003c/code\u003e という RegExp Modifiers の構文を使って \u003ccode\u003ei\u003c/code\u003e フラグを無効にしてます。このとき一文字目では大文字小文字が無視されるものの、二文字目では大文字小文字が無視されません。\u003c/p\u003e\n\u003cp\u003eしたがってこのパターンは \u003ccode\u003e\"ab\"\u003c/code\u003e や \u003ccode\u003e\"Ab\"\u003c/code\u003e にはマッチし \u003ccode\u003e\"aB\"\u003c/code\u003e にはマッチしません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e re1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003e\u003cspan class=\"token anchor function\"\u003e^\u003c/span\u003e\u003cspan class=\"token char-class\"\u003e\u003cspan class=\"token char-class-punctuation punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token range\"\u003ea\u003cspan class=\"token range-punctuation operator\"\u003e-\u003c/span\u003ez\u003c/span\u003e\u003cspan class=\"token char-class-punctuation punctuation\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token group punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e?\u003c/span\u003e-i:\u003cspan class=\"token char-class\"\u003e\u003cspan class=\"token char-class-punctuation punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token range\"\u003ea\u003cspan class=\"token range-punctuation operator\"\u003e-\u003c/span\u003ez\u003c/span\u003e\u003cspan class=\"token char-class-punctuation punctuation\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token group punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token anchor function\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"ab\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Ab\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"aB\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-buffer-boundaries\"\u003eRegExp Buffer Boundaries\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2 になりました\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eRegExp Buffer Boundaries も RegExp Language Features の機能の１つでした。\u003c/p\u003e\n\u003cp\u003eこの提案は、それぞれ入力の最初と最後にマッチする \u003ccode\u003e\\A\u003c/code\u003e と \u003ccode\u003e\\z\u003c/code\u003e を導入します。\u003ccode\u003em\u003c/code\u003e フラグの影響を受けないことを除けば \u003ccode\u003e^\u003c/code\u003e と \u003ccode\u003e$\u003c/code\u003e に似ています。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e^\u003c/code\u003e と \u003ccode\u003e$\u003c/code\u003e はそれぞれ最初と最後にマッチしますが、\u003ccode\u003em\u003c/code\u003e フラグが有効になっているときは行頭と行末にマッチします。しかし RegExp Buffer Boundaries が導入する \u003ccode\u003e\\A\u003c/code\u003e と \u003ccode\u003e\\z\u003c/code\u003e は、たとえ \u003ccode\u003em\u003c/code\u003e フラグが有効であっても入力の最初と最後にマッチします。\u003c/p\u003e\n\u003cp\u003e例を示します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e re \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003e\u003cspan class=\"token anchor function\"\u003e\\A\u003c/span\u003efoo\u003cspan class=\"token alternation keyword\"\u003e|\u003c/span\u003e\u003cspan class=\"token anchor function\"\u003e^\u003c/span\u003ebar\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eum\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのパターンでは \u003ccode\u003efoo\u003c/code\u003e に \u003ccode\u003e\\A\u003c/code\u003e がついています。したがって入力の最初が \u003ccode\u003efoo\u003c/code\u003e の文字列にマッチします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"foo\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし入力の最初ではなく行頭が \u003ccode\u003efoo\u003c/code\u003e の文字列にはマッチしません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\nfoo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// false\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003ebar\u003c/code\u003e には \u003ccode\u003e^\u003c/code\u003e がついています。パターン全体で \u003ccode\u003em\u003c/code\u003e フラグが有効になっているので、入力の先頭と行頭が \u003ccode\u003ebar\u003c/code\u003e の文字列にマッチします。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bar\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\nbar\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eFor Stage 1\u003c/h2\u003e\n\u003ch2\u003eUpdates\u003c/h2\u003e\n\u003cp\u003eステージの移動はないものの、アップデートがあった提案です。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-temporal\"\u003eTemporal\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eいくつかの仕様上の軽微な修正がありました。修正箇所について説明した\u003ca href=\"https://ptomato.name/talks/tc39-2021-12/#1\"\u003eスライド\u003c/a\u003eが公開されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-decimal\"\u003eDecimal\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eDecimal は現在 Stage 1 ですが、2022 年に Stage 2 に到達することを目指しているそうです。進捗を共有するための\u003ca href=\"https://drive.google.com/file/d/1qdieei11dZgDY_KnJhSBcFyHTMZOmCJr/view\"\u003eスライド\u003c/a\u003eが公開されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-destructuring-private\"\u003eDestructuring Private Fields\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eDestructuring Private Fields が提案された当初は小さな修正で十分だと考えられていました。しかし真剣に検討してみるといくつかの仕様上の難しい問題が明らかになったそうです。そこで再度レビュワーを募りレビューをやり直すことが決定しました。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eShadow Realms\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eいくつかの仕様上の重要な変更があったようです。詳しくは\u003ca href=\"https://docs.google.com/presentation/d/12PM5c4_yUnqXHjvACh8HEN5oJwgei-0T0hX_hlqjfDU/edit#slide=id.ge435a9058a_0_0\"\u003eスライド\u003c/a\u003eに記載されています。\u003c/p\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/proposal-record-tuple/\"\u003eRecords and Tuples\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eRecord と Tuple の中で通常のオブジェクトを扱う方法について議論されました。その方法とその懸念についての Decision Tree が\u003ca href=\"https://drive.google.com/file/d/1lVYn8_sHecqxW08vN5Tu7rXZn7GemBqO/view\"\u003eスライド\u003c/a\u003eとして公開されています。\u003c/p\u003e\n\u003ch2\u003eNormative Changes\u003c/h2\u003e\n\u003ch3\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/2106\"\u003e\u003ccode\u003eimport.meta[Symbol.toStringTag]\u003c/code\u003e の追加\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e合意は得られませんでした\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag\"\u003e\u003ccode\u003eSymbol.toStringTag\u003c/code\u003e\u003c/a\u003e という Well-known Symbol があります。\nこの Symbol は \u003ccode\u003eObject.prototype.toString()\u003c/code\u003e によって表示される文字列の決定に使われます。\u003c/p\u003e\n\u003cp\u003e具体的な例を示します。\u003c/p\u003e\n\u003cp\u003eオブジェクト \u003ccode\u003efoo\u003c/code\u003e の \u003ccode\u003e[Symbol.toStringTag]\u003c/code\u003e に \u003ccode\u003e\"I'm foo\"\u003c/code\u003e という文字列をセットしておくと、\u003ccode\u003efoo.toString()\u003c/code\u003e は \u003ccode\u003e[object I'm foo]\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token known-class-name class-name\"\u003eSymbol\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etoStringTag\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"I'm foo\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// \"[object I'm foo]\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回のミーティングでは \u003ccode\u003eimport.meta\u003c/code\u003e の \u003ccode\u003e[Symbol.toStringTag]\u003c/code\u003e に \u003ccode\u003e\"ImportMeta\"\u003c/code\u003e という文字列を設定するという修正について議論されました。\u003c/p\u003e\n\u003cp\u003eこの挙動についての Issue は \u003ccode\u003eimport.meta\u003c/code\u003e の策定時にも存在しましたが、そのときすでに \u003ccode\u003eimport.meta\u003c/code\u003e が Stage 4 を達成していたことからクローズされました。\u003c/p\u003e\n\u003cp\u003eそして今回のミーティングでもこの仕様の修正についての合意は得られませんでした。この修正のための Pull Request が作成された時点で以下のような懸念が公開されていました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eimport.meta\u003c/code\u003e は、ECMAScript の範囲では \u003ca href=\"https://tc39.es/ecma262/#sec-hostgetimportmetaproperties\"\u003e\u003ccode\u003eHostGetImportMetaProperties\u003c/code\u003e\u003c/a\u003e というホスト定義の abstract operation によって中身が決定されるオブジェクトであるということしか決まっておらず、ホストにとって必要であればホスト側で \u003ccode\u003eimport.meta\u003c/code\u003e の \u003ccode\u003eSymbol.toStringTag\u003c/code\u003e を定義できる。\u003c/li\u003e\n\u003cli\u003e仕様内で作成される他のオブジェクトとは異なり、\u003ccode\u003eimport.meta\u003c/code\u003e はホストのデータによって生成されるものであり、ECMAScript の範囲でプロパティを生成することを考慮したものではない。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/agendas/blob/main/2021/12.md\"\u003eAgenda for the 87th meeting of Ecma TC39\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/ecma262/pull/2106\"\u003eNormative: Add import.meta[Symbol.toStringTag]\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-grouping\"\u003eProposal Array Grouping\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eProposal Shadow Realms\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-array-from-async/\"\u003eProposal \u003ccode\u003eArray.fromAsync\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/rbuckton/proposal-regexp-features\"\u003eProposal RegExp Language Features\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-r-escape\"\u003eProposal RegExp \u003ccode\u003e\\R\u003c/code\u003e escape\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-set-notation\"\u003eProposal RegExp Set Notation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-buffer-boundaries\"\u003eProposal RegExp Buffer Boundaries\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-regexp-modifiers\"\u003eProposal RegExp Modifiers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-temporal\"\u003eProposal Temporal\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-shadowrealm\"\u003eProposal Shadow Realms\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-record-tuple/\"\u003eProposal Records and Tuples\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-destructuring-private\"\u003eProposal Destructuring Private Fields\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eBabel\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/babel/proposals/issues/78\"\u003eDec 2021 · Issue #78 · babel/proposals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eECMA262\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#prod-ImportMeta\"\u003e\u003ccode\u003eimport.meta\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tc39.es/ecma262/#sec-hostgetimportmetaproperties\"\u003e\u003ccode\u003eHostGetImportMetaProperties\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"ECMAScriptの最新動向 2021年12月版","author":"sosukesuzuki","createdAt":"2022-01-24","summary":"2021年12月14日~15日に開催された TC39 meeting 87th の内容を紹介します","tags":["TC39","ECMAScript"],"updatedAt":"2022-01-24"}},{"type":"markdown","href":"/posts/release-chrome-97","slug":"release-chrome-97","content":"\u003cp\u003eChrome 97 のリリースノート関連の情報をまとめました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-97/\"\u003ehttps://developer.chrome.com/blog/new-in-chrome-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/blog/new-in-devtools-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-97/\"\u003ehttps://developer.chrome.com/blog/deps-rems-97/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D97\"\u003ehttps://www.chromestatus.com/features#milestone%3D97\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://v8.dev/blog/v8-release-97\"\u003ehttps://v8.dev/blog/v8-release-97\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eNew In Chrome (Chrome 97)\u003c/h2\u003e\n\u003cp\u003eChrome97 で新しく追加された機能です。\u003c/p\u003e\n\u003ch3\u003eWeb Transport\u003c/h3\u003e\n\u003cp\u003eサーバーとクライアントの双方向リアルタイム通信を実現する新しいフレームワークとして提案されている\u003ccode\u003eWeb Transport\u003c/code\u003eが正式にサポートされました。\u003c/p\u003e\n\u003cp\u003eWeb Transport は既存の代表的手法である\u003ccode\u003eWeb Sockets\u003c/code\u003eや\u003ccode\u003eWebRTC\u003c/code\u003eと比べ以下のような利点を持っています。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eWebSockets\u003c/code\u003eよりも低遅延な通信を実現する\u003c/li\u003e\n\u003cli\u003eP2P メッセージング用に設計された\u003ccode\u003eWebRTC\u003c/code\u003eと違い、クライアントサーバーメッセージングを前提として設計されているため扱いやすい\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWeb Transport では\u003ccode\u003estreams API\u003c/code\u003eと\u003ccode\u003edatagram API\u003c/code\u003eという２種類の通信 API がサポートされており、それぞれ以下のような特徴から使い分けることができます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estreams API : 信頼性の高い順序付けられたデータ送信に最適\u003c/li\u003e\n\u003cli\u003edatagram API : 信頼性や順序がそこまで求められず、より低遅延でベストエフォートなデータ送信に最適\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e注意点として、Web Transport を試すためには\u003ccode\u003eHTTP/3\u003c/code\u003eをサポートしたサーバーが必要となります。\u003c/p\u003e\n\u003cp\u003eWeb Transport は以下のような形で簡単に利用することができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e url \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'https://example.com:4999/foo/bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e transport \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eWebTransport\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eurl\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// WebTransportインスタンス生成\u003c/span\u003e\n\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e transport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eready\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 接続を待つ\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e writer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e transport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edatagrams\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewritable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetWriter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUint8Array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e65\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e66\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e67\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nwriter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewrite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e詳しくは\u003ca href=\"https://web.dev/webtransport/\"\u003eExperimenting with WebTransport\u003c/a\u003eを参照しててください。\u003c/p\u003e\n\u003ch3\u003eScript type feature detection\u003c/h3\u003e\n\u003cp\u003eブラウザ側で\u003ccode\u003eES Modules\u003c/code\u003eの対応状況を判別する方法として今まで\u003ccode\u003enomodule\u003c/code\u003e属性がありましたが、\u003ccode\u003eimport maps\u003c/code\u003e, \u003ccode\u003especulation rules\u003c/code\u003e,\u003ccode\u003ebundle preloading\u003c/code\u003eなどの新しく提案されている仕様には対応しきれていませんでした。\u003c/p\u003e\n\u003cp\u003e今回サポートされた\u003ccode\u003eHTMLScriptElement.supports()\u003c/code\u003eを利用することで以下のように JavaScript側でscriptがどの仕様に対応しているかのチェックをすることができるようになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eHTMLScriptElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'importmap'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use \u0026#x3C;script type=\"importmap\" ...\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eHTMLScriptElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esupports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'module'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use \u0026#x3C;script type=\"module\" ...\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Use classic method...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eNew array prototypes\u003c/h3\u003e\n\u003cp\u003eArray と TypedArray で\u003ccode\u003efindLast()\u003c/code\u003eと\u003ccode\u003efindLastIndex()\u003c/code\u003eが使えるようになりました。\nこの二つの関数は引数で渡された条件に合致する配列内の\u003cstrong\u003e最後の要素\u003c/strong\u003eの値、位置をそれぞれ返します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e array \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e12\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e8\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e130\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e44\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e last \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efindLast\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elast\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 44\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e lastIndex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e array\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efindLastIndex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elastIndex\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eEmulate Chrome 100 in the UA string\u003c/h3\u003e\n\u003cp\u003eあと数ヶ月で Chrome のバージョンは 3 桁となる 100 に到達します。\nバージョンや UA 文字列をパースするコードがある場合は 3 桁でも動くかどうか確認しましょう。\u003c/p\u003e\n\u003cp\u003e現在のバージョンを 100 にする\u003ca href=\"https://developer.chrome.com/blog/force-major-version-to-100/\"\u003e#force-major-version-to-100\u003c/a\u003eフラグを使って、既存のコードが正しく動くか確認することができます。\u003c/p\u003e\n\u003ch3\u003eAnd more!\u003c/h3\u003e\n\u003cp\u003e上記以外のようなアップデートがあります。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eフォーム入力の改行が Gecko や WebKit と同じ方法で正規化されるようになりました。\n\u003cul\u003e\n\u003cli\u003eこれによりブラウザ間の相互運用性が向上しました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eclient hint\u003c/code\u003eのプレフィクスを\u003ccode\u003esec-ch\u003c/code\u003eにするように標準化を進めています。\n\u003cul\u003e\n\u003cli\u003e例えば\u003ccode\u003edpr\u003c/code\u003eは\u003ccode\u003esec-ch-dpr\u003c/code\u003eのようになります。\u003c/li\u003e\n\u003cli\u003e以前の仕様も当分の間サポートを続けますが、いずれは非推奨となり削除されることを想定しましょう。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e閉じている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素が検索可能になり、閉じている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素内の element にスクロールしようとした際は閉じられている\u003ccode\u003e\u0026#x3C;detail\u003e\u003c/code\u003e要素を自動的に開くようになりました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eWhat's New In DevTools (Chrome 97)\u003c/h3\u003e\n\u003cp\u003eDevTools についてはこちらの日本語訳を参照ください。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/ja/blog/new-in-devtools-97/\"\u003ehttps://developer.chrome.com/ja/blog/new-in-devtools-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eDeprecations and removals in Chrome 97\u003c/h3\u003e\n\u003cp\u003eChrome97 で非推奨になったもの、もしくは削除されたものです\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/deps-rems-97/\"\u003ehttps://developer.chrome.com/blog/deps-rems-97/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eRemove SDES key exchange for WebRTC\u003c/h3\u003e\n\u003cp\u003eWebRTC の SDES 鍵交換の仕様は 2013 年以降、関連する IETF の標準仕様では MUST NOT となっており、近年では Chrome での使用率も大幅に低下しているので Chrome97 で廃止されました。\u003c/p\u003e\n\u003cp\u003e参考:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://webrtc-security.github.io/report_ja/\"\u003ehttps://webrtc-security.github.io/report_ja/\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eRemove WebSQL in third-party contexts\u003c/h3\u003e\n\u003cp\u003eサードパーティ製の WebSQL が廃止されました。W3C では代わりに Web Storage と Indexed Database を推奨しています。\u003c/p\u003e\n\u003ch3\u003eRemove SDP Plan B\u003c/h3\u003e\n\u003cp\u003eWebRTC でセッションを確立するために使用される SDP に非標準の実装であった\u003ccode\u003ePlan B\u003c/code\u003eが削除されました。\u003c/p\u003e\n\u003cp\u003e参考: SDP の Unified Plan と Plan B\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.jxck.io/entries/2018-01-05/sdp-unified-plan.html\"\u003ehttps://blog.jxck.io/entries/2018-01-05/sdp-unified-plan.html\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eその他 Chrome Platform Status に記載されていたもの\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.chromestatus.com/features#milestone%3D97\"\u003ehttps://www.chromestatus.com/features#milestone%3D97\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eFeature policy for Keyboard API\u003c/h3\u003e\n\u003cp\u003e各言語に対応した keybord レイアウト情報を返す\u003ccode\u003egetLayoutMap()\u003c/code\u003eメソッドは全てのコンテキスト(iframe 内など)では利用できないという問題点がありました。今回のアップデートで iframe の allow 属性に\u003ccode\u003ekeyboard-map\u003c/code\u003eを追加することでこの問題を解決することができるようになりました。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5657965899022336\"\u003ehttps://chromestatus.com/features/5657965899022336\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003e\u003ccode\u003ePermissionStatus.prototype.name\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ePermissionStatus\u003c/code\u003e インターフェースに読み取り専用の属性 \u003ccode\u003e\"name\"\u003c/code\u003e を追加し、\u003ccode\u003ePermissionStatus\u003c/code\u003e が作成された後、パーミッションの名前が取得できるようになりました。\u003c/p\u003e\n\u003cp\u003e今までは\u003ccode\u003ePermissions API\u003c/code\u003e を使って複数のパーミッションを同時に問い合わせた際、どの PermissionStatus がどのパーミッションに対応しているのかを識別する方法がありませんでした。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5651653697994752\"\u003ehttps://chromestatus.com/features/5651653697994752\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003ePropagate request origin and redirect chain in passthrough service workers.\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003efetch(evt.request)\u003c/code\u003eメソッドで navigation requests を発行する ServiceWorker が\u003ccode\u003eFetchEvent.request\u003c/code\u003e からのオリジンとリダイレクトチェーンを使用するようになります。\u003c/p\u003e\n\u003cp\u003e今までは常に ServiceWorker のオリジンが設定され、リダイレクトチェーンを使用することはありませんでした。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5752539724120064\"\u003ehttps://chromestatus.com/features/5752539724120064\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eSupport calc(\u003ccode\u003e\u0026#x3C;number\u003e\u003c/code\u003e) where only accepts \u003ccode\u003e\u0026#x3C;integer\u003e\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts/release-chrome-96\"\u003eChrome 96 リリースノートまとめ\u003c/a\u003eにも記載したものが、Chrome97 で追加されました。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecss の calc()関数で integer しか受け取らないような場所でも number を指定できるようになりました。 もっとも近い整数に丸められます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5656451751084032\"\u003ehttps://chromestatus.com/features/5656451751084032\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003etransform: perspective(none)\u003c/h3\u003e\n\u003cp\u003eCSS transform プロパティ内で利用できる、\u003ccode\u003eperspective()\u003c/code\u003e関数への引数として'none'を実装としてサポートしました。\u003ccode\u003eperspective(0)\u003c/code\u003eと\u003ccode\u003eperspective(none)\u003c/code\u003eでは挙動が変わるため、変形をしないことを意図する場合(単位行列として扱いたい場合)は\u003ccode\u003eperspective(none)\u003c/code\u003eを利用するようにしましょう。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://chromestatus.com/features/5687325523705856\"\u003ehttps://chromestatus.com/features/5687325523705856\u003c/a\u003e\u003c/p\u003e\n","metaData":{"title":"Web Transportのサポートなど、Chrome 97 リリースノートまとめ","author":"Saji","editor":"nus3","createdAt":"2022-01-21","summary":"Chrome 97 のリリースノートの要約です","tags":["Releasenote","Browser"],"updatedAt":"2022-01-21"}},{"type":"markdown","href":"/posts/release-firefox-96","slug":"release-firefox-96","content":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mozilla.org/en-US/firefox/96.0/releasenotes/\"\u003ehttps://www.mozilla.org/en-US/firefox/96.0/releasenotes/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/96\"\u003ehttps://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/96\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFirefox 96 がリリースされました！\n全体的に性能面での改善が多くを占めるアップデートでした。\n本リリースでは Cookie Policy がデフォルトで \u003ccode\u003eSameSite=lax\u003c/code\u003eを指定するようになりました。\nまた、\u003ccode\u003ecolor-scheme\u003c/code\u003eプロパティが追加され、IE 以外の主要なブラウザで利用可能になりました。\u003c/p\u003e\n\u003ch2\u003eNew\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eノイズ抑制やオートゲインコントロールの大きな改善とエコーキャンセレーションの若干の改善がされました\u003c/li\u003e\n\u003cli\u003eメインスレッドの負荷が大きく軽減されました\u003c/li\u003e\n\u003cli\u003eCookie Policy をデフォルトで \u003ccode\u003eSameSite=lax\u003c/code\u003e に強制するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFixed\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emacOS で Gmail のリンクをコマンドクリックした際、正常に新しいタブが開くようになりました\n\u003cul\u003e\n\u003cli\u003eFirefox95 で unresolved になっていた問題の解決\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eビデオの SSRC(RTP セッションでの参加者の識別子) が断続的にドロップする問題が修正されました\u003c/li\u003e\n\u003cli\u003e特定のサイトでビデオの画質が劣化する問題が修正されました\u003c/li\u003e\n\u003cli\u003emacOS でいくつかの問題を回避するためにフルスクリーンでのビデオが無効化されています\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDeveloper\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eLinux にて \u003ccode\u003eSelect All\u003c/code\u003e のショートカットキーが \u003ccode\u003eAlt-A\u003c/code\u003e から \u003ccode\u003eCtrl-A\u003c/code\u003e に変更されました\n\u003cul\u003e\n\u003cli\u003eweb-compatibility の確保やアクセスキーとの衝突回避のため\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWeb Platform\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWeb Lock API が実装されました。\n\u003cul\u003e\n\u003cli\u003e異なる ServiceWorker やタブで実行されているスクリプトを相互連携させることが可能になります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWebRTC ライブラリが更新されたことで Web 会議アプリでの音声やビデオ機能が改善されました\u003c/li\u003e\n\u003cli\u003eCSS にて \u003ccode\u003ecolor-scheme\u003c/code\u003e がサポートされ、Web ページがどのカラースキームでレンダリング可能かを指定できるようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e開発者向けの変更\u003c/h2\u003e\n\u003ch3\u003efor web developers\u003c/h3\u003e\n\u003ch4\u003eCSS\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eCSS で色の値として利用される \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/hwb()\"\u003e\u003ccode\u003ehwb()\u003c/code\u003e\u003c/a\u003e 関数が実装されました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme\"\u003e\u003ccode\u003ecolor-scheme\u003c/code\u003e\u003c/a\u003eプロパティがサポートされました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/counter-reset\"\u003e\u003ccode\u003ecounter-reset\u003c/code\u003e\u003c/a\u003e プロパティにて逆順の CSS カウンターを生成する \u003ccode\u003ereversed()\u003c/code\u003e 関数がサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eHTTP\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e同じドメインから送信された Cookie でも異なるスキームを使用されているものは Cookie SameSite ディレクティブについて別サイトから送信されたものと見なすようになりました\u003c/li\u003e\n\u003cli\u003eSameSite 属性が指定されていない Cookie は暗黙的に \u003ccode\u003eSameSite=lax\u003c/code\u003e が指定されるようになりました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSameSite=none\u003c/code\u003e を指定した Cookie はセキュアなコンテキストが必要になりました\u003c/li\u003e\n\u003cli\u003eCookie の SameSite についてはこちらをお読みください\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/05/07/080000\"\u003eCookie の SameSite 属性について - Cybozu Inside Out | サイボウズエンジニアのブログ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eAPIs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eAndroid において \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/canShare\"\u003e\u003ccode\u003enavigator.canShare()\u003c/code\u003e\u003c/a\u003e がサポートされました\u003c/li\u003e\n\u003cli\u003eデフォルトで \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API\"\u003eWeb Locks API\u003c/a\u003e が有効になりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eCanvas\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eWebP の画像エンコーダーをサポートしました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eDOM\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/ja/docs/Web/API/IntersectionObserver\"\u003e\u003ccode\u003eIntersectionObserver()\u003c/code\u003e\u003c/a\u003e のコンストラクターが関連付けられたパラメータオプションにから文字が渡された場合に例外発生ではなく \u003ccode\u003erootMargin\u003c/code\u003e を設定するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eMedia, WebRTC, and Web Audio\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eいくつかの非標準な静的フィールドが \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_Statistics_API\"\u003eWebRTC Statistics API\u003c/a\u003e から削除されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eWebDriver conformance (Marionette)\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:GetElementShadowRoot\u003c/code\u003e コマンドが追加されました\n\u003cul\u003e\n\u003cli\u003e指定された要素が持っている shadow root を取り出す\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:ExecuteScript\u003c/code\u003e 及び \u003ccode\u003eWebDriver:ExecuteAsyncScript\u003c/code\u003eにて要素の \u003ccode\u003eShadowRoot\u003c/code\u003e を返す際に \u003ccode\u003ecyclic object error\u003c/code\u003e が発生する問題が解決されました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:Print\u003c/code\u003e が PDF にプリントする際のページ範囲をサポートするように拡張されました\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"CSS color-scheme サポート追加等 Firefox 96.0 リリースノートまとめ","author":"BaHo","editor":"shisama","createdAt":"2022-01-20","summary":"Firefox 96.0 のリリースノートの日本語まとめです","tags":["Releasenote","Browser"],"updatedAt":"2022-01-20"}},{"type":"markdown","href":"/posts/turborepo","slug":"turborepo","content":"\u003cp\u003e今年からフロントエンドエキスパートチームでは活動内容の一つである\u003cstrong\u003e探求\u003c/strong\u003eの一環として、メンバーが気になった技術に対して、気軽に触ってみる会をしています。次の画像は筆者が Slack で、気軽に触ってみる会の開催を宣言してる時のものです。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/turborepo/slack.png\" alt=\"slackで気軽に触ってみる会を宣言してる\" width=\"718\" height=\"152.15061295971978\" \u003e\u003c/p\u003e\n\u003cp\u003e今回は\u003ca href=\"https://vercel.com/blog/vercel-acquires-turborepo\"\u003e去年の 12 月に Vercel に買収されたニュース\u003c/a\u003eがあった Turborepo を気軽に触ってみました。\n個人的には 1 人で調べるときよりも複数人でわいわい調べた方が、その技術や関連する周辺知識の話を色んな人の観点で深掘ってできて、とても有意義な時間でした。\u003c/p\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eTurborepo はモノレポのためのビルドシステムで次のような特徴があります。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYarn, npm, pnpm の workspaces に対応してるリポジトリに対して簡単に導入できる\u003c/li\u003e\n\u003cli\u003eworkspace 内のコマンドの依存関係をシンプルに設定してくれる\u003c/li\u003e\n\u003cli\u003eTurborepo で実行するコマンドがない package はスルーしてくれる(npm workspace の\u003ccode\u003e--if-present\u003c/code\u003eに相当)\u003c/li\u003e\n\u003cli\u003eローカルキャッシュ、リモートキャッシュを生成・利用できる\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eサンプルで作ったモノレポ構成\u003c/h3\u003e\n\u003cp\u003e今回は Yarn v1 の workspace を使ってます。\u003cbr\u003e\n\u003ca href=\"https://github.com/nus3/p-turborepo/tree/main/yarn\"\u003ehttps://github.com/nus3/p-turborepo/tree/main/yarn\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e├── apps\n│   └── nus3-a: Next.js\n└── packages:\n    ├── nus3-button2: Reactのコンポーネント + ViteのLibrary Modeでビルド\n    ├── nus3-config: tsconfig + eslintのconfig\n    └── nus3-ui: Reactのコンポーネント(ビルドせずに使う)\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eサンプルで作ったモノレポ内の package たちは次のような依存関係になっています。\u003cbr\u003e\n(色々試してたので適当な命名になってます。すんません)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enus3-a\u003c/code\u003eは\u003ccode\u003enus3-ui\u003c/code\u003eと\u003ccode\u003enus3-button2\u003c/code\u003eに依存している\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enus3-ui\u003c/code\u003eは\u003ccode\u003enus3-button2\u003c/code\u003eに依存している\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/turborepo/dependencies.png\" alt=\"サンプルリポジトリの依存関係\" width=\"577\" height=\"314\" \u003e\u003c/p\u003e\n\u003ch3\u003e使い方\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e使っているパッケージマネージャーで(Yarn, npm, pnpm)で workspace の設定\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eturbo\u003c/code\u003eのインストール\u003c/li\u003e\n\u003cli\u003epackage.json に\u003ccode\u003epipeline\u003c/code\u003eの設定\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4\u003e1. 使っているパッケージマネージャーで(Yarn, npm, pnpm)で workspace の設定\u003c/h4\u003e\n\u003cp\u003eworkspace の設定については割愛します。各パッケージマネージャーのドキュメントをご覧ください。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://classic.yarnpkg.com/lang/en/docs/workspaces/\"\u003eYarn\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.npmjs.com/cli/v8/using-npm/workspaces\"\u003enpm\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pnpm.io/workspaces\"\u003epnpm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003e2. \u003ccode\u003eturbo\u003c/code\u003eのインストール\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eyarn add turbo -W --dev\u003c/code\u003eで Turborepo を追加します。\u003c/p\u003e\n\u003ch4\u003e3. package.json に\u003ccode\u003epipeline\u003c/code\u003eの設定\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003epackage.json\u003c/code\u003eに\u003ccode\u003eturbo.pipeline\u003c/code\u003eを追加し、そこで\u003ccode\u003eturbo run {command}\u003c/code\u003eで実行する command の依存関係やキャッシュの設定をします。この\u003ccode\u003epipeline\u003c/code\u003eで定義した command しか\u003ccode\u003eturbo run {command}\u003c/code\u003eでは実行できません。\u003c/p\u003e\n\u003cp\u003e実際に定義したものが次の json になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"turbo\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"pipeline\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"^build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"outputs\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dist/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".next/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003edependsOn\u003c/code\u003eで依存関係を、\u003ccode\u003eoutputs\u003c/code\u003eでキャッシュするものを指定します。\u003c/p\u003e\n\u003cp\u003e定義したコマンドを一つずつ見ていきましょう。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"^build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003edependOn に\u003ccode\u003e^\u003c/code\u003eを追加したコマンド(\u003ccode\u003e^build\u003c/code\u003e)を指定することで workspace 内の各 package の指定したコマンド(\u003ccode\u003ebuild\u003c/code\u003e)を package 間の依存関係を考慮した順番で実行してくれます。\u003c/p\u003e\n\u003cp\u003e実際に実行してみると、サンプルで作った各 package の依存関係を考慮した順番(\u003ccode\u003e@nus3/example-button2\u003c/code\u003e → \u003ccode\u003enus3-ui\u003c/code\u003e → \u003ccode\u003enus3-a\u003c/code\u003e)でビルドされていることがわかります。\u003cbr\u003e\n(※今回サンプルで作った構成では\u003ccode\u003enus3-ui\u003c/code\u003eはビルドの必要がないですが、依存関係を考慮した順番を表すのにあえて build コマンドを追加しています)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run build\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running build in 4 packages\n@nus3/example-button2:build: cache miss, executing a161062b16a0be35\n@nus3/example-button2:build: $ vite build \u0026#x26;amp;\u0026#x26;amp; tsc -p ./tsconfig.build.json\n...\n@nus3/example-button2:build: dist/nus3-example-button2.es.js   3.30 KiB / gzip: 1.39 KiB\nnus3-ui:build: cache miss, executing b32d4fb848c8658f\nnus3-ui:build: $ echo \u0026#x26;#39;build nus3-ui\u0026#x26;#39;\n...\nnus3-a:build: cache miss, executing a80d8842624981a8\nnus3-a:build: $ next build\n...\n\n Tasks:    3 successful, 3 total\nCached:    0 cached, 3 total\n  Time:    5.702s\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次の\u003ccode\u003eoutputs\u003c/code\u003eはコマンドを実行した際に、\u003ccode\u003edist\u003c/code\u003eと\u003ccode\u003e.next\u003c/code\u003e配下にあるファイル群をキャッシュする設定です。\u003ccode\u003enode_modules/.cache/turbo\u003c/code\u003eにキャッシュしたファイルが出力されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"outputs\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dist/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".next/**\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e先程の build コマンドをもう一度実行すると cache が使われ、前回より早く実行されているのがわかります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run build\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running build in 4 packages\n@nus3/example-button2:build: cache hit, replaying output a161062b16a0be35\n...\nnus3-ui:build: cache hit, replaying output b32d4fb848c8658f\n...\nnus3-a:build: cache hit, replaying output a80d8842624981a8\n...\n\n Tasks:    3 successful, 3 total\nCached:    3 cached, 3 total\n  Time:    221ms \u0026#x26;gt;\u0026#x26;gt;\u0026#x26;gt; FULL TURBO\n\n✨  Done in 0.57s.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次のように何も指定しない場合、依存関係がないものとして認識され並列に実行されます\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e次の deploy コマンドの\u003ccode\u003edependsOn\u003c/code\u003eでは pipeline で定義した\u003ccode\u003ebuild\u003c/code\u003e, \u003ccode\u003etest\u003c/code\u003e, \u003ccode\u003elint\u003c/code\u003e(順不同)を実行し、終了した時点で workspace 内の各 package の\u003ccode\u003edeploy\u003c/code\u003eコマンドを実行します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependsOn\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e今回定義したものの場合、Turborepo は次のようなことを考慮しながら各々の package のコマンドを実行します。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebuild\u003c/code\u003e: モノレポ内の各 package の依存関係を考慮しつつ build\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etest\u003c/code\u003e: \u003ccode\u003epipeline\u003c/code\u003eで定義した\u003ccode\u003ebuild\u003c/code\u003eが実行された後に実行\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003elint\u003c/code\u003e: 他のコマンドの順番を気にせず、並列で実行\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003edeploy コマンドを実行した結果が次になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e$ turbo run deploy\n• Packages in scope: @nus3/example-button2, nus3-a, nus3-config, nus3-ui\n• Running deploy in 4 packages\nnus3-a:lint: $ next lint\n@nus3/example-button2:build: $ vite build \u0026#x26;amp;amp;\u0026#x26;amp;amp; tsc -p ./tsconfig.build.json\n...\nnus3-ui:build: $ echo \u0026#x26;#39;build nus3-ui\u0026#x26;#39;\n...\nnus3-a:build: $ next build\n...\nnus3-a:test: $ echo \u0026#x26;#39;test nus3-a\u0026#x26;#39;\n...\nnus3-a:deploy: $ echo \u0026#x26;#39;deploy nus3-a\u0026#x26;#39;\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e実際に上記を考慮しつつ各 package のコマンドが実行された後に、最後に deploy コマンドが実行されているのがわかると思います。\u003c/p\u003e\n\u003cp\u003eまた、今回はローカルキャッシュの話のみでしたが、Turborepo には\u003ca href=\"https://turborepo.org/docs/features/remote-caching#vercel\"\u003eVercel\u003c/a\u003eや\u003ca href=\"https://turborepo.org/docs/features/remote-caching#custom-remote-caches\"\u003e独自\u003c/a\u003eにキャッシュを配置することで、同じハッシュのキャッシュがあった場合にそのキャッシュを使ってくれる\u003cstrong\u003eリモートキャッシュ\u003c/strong\u003eといった機能も Beta で用意されています。\u003c/p\u003e\n\u003cp\u003e今のプロジェクトが Yarn や npm の workspace を使っているのであれば、Turborepo を試しに入れてみてもいいかもしれません。\u003c/p\u003e\n","metaData":{"title":"workspaceを使ったコマンドを最適化して実行するTurborepoについて","author":"nus3","createdAt":"2022-01-17","summary":"Turborepoの機能について","tags":["Turborepo","Monorepo"],"updatedAt":"2022-01-17"}},{"type":"markdown","href":"/posts/release-firefox-95","slug":"release-firefox-95","content":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mozilla.org/en-US/firefox/95.0/releasenotes/\"\u003ehttps://www.mozilla.org/en-US/firefox/95.0/releasenotes/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/95\"\u003ehttps://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/95\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFirefox 95 がリリースされました。\n本アップデートでは RLBox という新しいコードサンドボックス機能が導入されて信頼できないコードに対する安全性が向上しました。\nまた、Firefox App から Slack.com の Huddle や Call 機能が利用できるようになったのは嬉しいですね。\u003c/p\u003e\n\u003ch2\u003eNew\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hacks.mozilla.org/2021/12/webassembly-and-back-again-fine-grained-sandboxing-in-firefox-95/\"\u003eRLBox\u003c/a\u003eが全てのプラットフォームで有効になりました\n\u003cul\u003e\n\u003cli\u003e信頼できないコードを WebAssembly を用いてネイティブコードへコンパイルすることで意図しない領域外へのメモリアクセスを防止する機能のようです\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hacks.mozilla.org/2021/12/webassembly-and-back-again-fine-grained-sandboxing-in-firefox-95/\"\u003emozilla hacks\u003c/a\u003eによれば、従来のプロセスを分割する手法における非同期化のオーバーヘッドやメモリフットプリントの増加を懸念した手法だと記載されていました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWindows 10 及び Windows 11 において Firefox App を Microsoft Store からダウンロードできるようになりました\u003c/li\u003e\n\u003cli\u003eブラウザクロームとツールバースクリーンショットがシンプルになりました\u003c/li\u003e\n\u003cli\u003emacOS において WindowsServer イベントの処理時の CPU 使用量が削減されました\u003c/li\u003e\n\u003cli\u003emacOS において主にフルスクリーン時のソフトウェアでコードされたビデオコンテンツの使用電力が削減されました\u003c/li\u003e\n\u003cli\u003ePiP のトグルボタンをビデオウィンドウの反対側にへ移動できるようになりました\u003c/li\u003e\n\u003cli\u003eSite Isolation が有効化されました。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFixed\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFirefox を起動した際、JAWS や ZoomText が Firefox をフォーカスするようになりました\u003c/li\u003e\n\u003cli\u003eVoiceOver が ARIA の switch ロールの状態を正しく報告するようになりました\u003c/li\u003e\n\u003cli\u003emacOS でコンテンツプロセスの起動速度が速くなりました\u003c/li\u003e\n\u003cli\u003eメモリアロケータが改善されました\u003c/li\u003e\n\u003cli\u003eJavaScript を先行してコンパイルするようになり、ページロード時のパフォーマンスが改善されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eChanged\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSlack.com で Call や Huddles へアクセスできるように User Agent オーバーライドが追加されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDeveloper\u003c/h2\u003e\n\u003ch3\u003eFor web developers\u003c/h3\u003e\n\u003ch4\u003eHTML\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eグローバル属性 \u003ccode\u003einputmode\u003c/code\u003e が全てのプラットフォームでサポートされるようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eCSS\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eAndroid 版 Firefox で cursor プロパティがサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eAPIs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCrypt.randomUUID()\u003c/code\u003e 関数がサポートされました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eMedia, WebRTC, and Web Audio\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eSpeechSynthesisEvent.elapseTime\u003c/code\u003e がミリ秒ではなく秒単位の経過時間を返すようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eWebDriver Conformance (Marionette)\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eMarionette が使用しているポートがプロファイルディレクトリにある \u003ccode\u003eMarionetteActivePort\u003c/code\u003e ファイルに書き込まれるようになりました\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWebDriver:NewSession\u003c/code\u003e が最初のタブのロードが完了するまで待機するようになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFor add-on developers\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ebrowserSettings に \u003ccode\u003eoverrideContentColorScheme\u003c/code\u003e が追加され、\u003ccode\u003e.css.prefers-color-scheme.content.override\u003c/code\u003e という環境設定を制御することでブラウザのテーマとは独立したページ単位の優先的な配色を設定する機能が追加されました\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eunresolved\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eGmail のリンクをコマンドクリックしても新しいタブが開かない問題がありました\n\u003cul\u003e\n\u003cli\u003e回避策: Gmail のリンクをコマンドキーを利用せずにクリックすると新しいタブが開きます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"新しいコードサンドボックス機能 RLBox の追加など Firefox 95.0 リリースノートまとめ","author":"BaHo","createdAt":"2021-12-20","summary":"Firefox 95.0 のリリースノートの日本語まとめです","tags":["Releasenote","Browser"],"updatedAt":"2021-12-20"}},{"type":"markdown","href":"/posts/team-activity-logs-2021","slug":"team-activity-logs-2021","content":"\u003cp\u003eこの記事は\u003ca href=\"https://adventar.org/calendars/6823\"\u003eCybozu Advent Calendar 2021\u003c/a\u003eの 18 日目の記事です（業務なので前日に出してます 🍀）。\u003c/p\u003e\n\u003cp\u003eサイボウズには 10 年以上運用が続いているプロダクトがいくつかあります。フロントエンドエキスパートチームは、そんなプロダクトや開発メンバーへの支援を横断的に行うチームです。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームの今年の取り組みを紹介します。\u003c/p\u003e\n\u003ch2\u003eフロントエンドエキスパートチームの立ち位置とミッション\u003c/h2\u003e\n\u003cp\u003eフロントエンドエキスパートチームは特定のプロダクトなどに属さない、独立した横断的な支援チームです。活動内容についてはすべてチームに裁量があり、何をどうしていくかは自律的に決めて動く必要があります。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームでは「サイボウズのフロントエンドを最高にする」というミッションを掲げています。このミッションを達成するための活動を日々考えながら活動しています。\u003c/p\u003e\n\u003cp\u003e日々の活動は次の 4 つの内容を軸に行なっています。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e支援: プロダクトやチームへの支援\u003c/li\u003e\n\u003cli\u003e発信: Cybozu やメンバーのプレゼンス向上のための情報発信\u003c/li\u003e\n\u003cli\u003e啓蒙: 社内メンバーのフロントエンドの技術力向上のための啓蒙活動\u003c/li\u003e\n\u003cli\u003e探究: プロダクトの可能性を広げるための調査検証\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eこれら 4 つを軸に、\u003ccode\u003e支援:5\u003c/code\u003e \u003ccode\u003e発信\u0026#x26;啓蒙:2\u003c/code\u003e \u003ccode\u003e探究:3\u003c/code\u003e の割合を目安にメンバー個々人が裁量を持って活動しています。\u003c/p\u003e\n\u003cp\u003eチームは今月で 4 歳 2 ヶ月になります。\u003c/p\u003e\n\u003ch2\u003e活動内容まとめ\u003c/h2\u003e\n\u003cp\u003e今年は大小さまざまな取り組みを行いました。次のリストはフロントエンドエキスパートチームが行なった今年の活動内容のざっくりとしたまとめです。これらの活動はチームで自発的に始めた取り組みと、相談きっかけで行なったものがあります。割合としては自発的なものが 9 割、相談きっかけが 1 割程度です。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eプロダクトのフロントエンドリアーキテクチャ支援\u003c/li\u003e\n\u003cli\u003eプロダクトのマイクロサービス化を検証\u003c/li\u003e\n\u003cli\u003eプロダクトのライブラリアップデート支援\u003c/li\u003e\n\u003cli\u003eプロダクトへのフロントエンドのテスト環境整備支援\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.github.io/frontend-monthly/\"\u003eサイボウズフロントエンドマンスリー\u003c/a\u003eの開催\u003c/li\u003e\n\u003cli\u003e登壇\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nodejs.connpass.com/event/221358/\"\u003eNode 学園 37 時限目 オンライン\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web-study.connpass.com/event/213676/\"\u003etc39_study\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jsconf.jp/2021/\"\u003eJSConf JP 2021\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.connpass.com/event/212572/\"\u003eMeetup の開催\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eOSS へのコントリビューション\u003c/li\u003e\n\u003cli\u003e社内向けフロントエンド研修の開催\u003c/li\u003e\n\u003cli\u003eフロントエンドウィークリーの開催（社内向け勉強会）\u003c/li\u003e\n\u003cli\u003eエンジニアインターンの開催\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/search?q=%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%82%A8%E3%82%AD%E3%82%B9%E3%83%91%E3%83%BC%E3%83%88\"\u003eエンジニアブログへの記事投稿\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cybozu.github.io/frontend-expert/posts\"\u003eチームの web サイトへの記事投稿\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eデザインシステムの探究\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eプロダクトの現状を見て、プロダクトや会社の今後の方向性などを加味した上で、取り組みの内容や注力する割合をコントロールしています。\u003c/p\u003e\n\u003cp\u003eその中からいくつかをピックアップして詳細を紹介します。\u003c/p\u003e\n\u003ch2\u003eプロダクトのフロントエンドリアーキテクチャをプロジェクト化するまで\u003c/h2\u003e\n\u003cp\u003eサイボウズでは現在、kinotne のフロントエンドのリアーキテクチャプロジェクトが進行中です。kintone の脱レガシーの取り組み自体は 2019 年ごろから開始されていましたが、1 つのプロジェクトとして動くようになったのは今年からです。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://blog.cybozu.io/entry/2021/07/20/170000\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003ch3\u003e少数チームでやれることに限界を感じた\u003c/h3\u003e\n\u003cp\u003eリアーキテクチャがプロジェクトになる前、kintone の脱レガシーはもともとフロントエンドエキスパートチームが主導・先行する形で調査検討を行っていました。Closure Tools というフレームワークに依存している現状に対して、脱 Closure Tools のロードマップを作成したり、Closure Tools を使い続けた場合の影響と今後の見通しについて社内各所に警鐘を鳴らすとともに、別のフレームワークへの置き換え方法についての PoC などを行なっていました。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/04/07/110126\"\u003eフロントエンドの開発体験向上と脱レガシー\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/about-clutz\"\u003eClosure Library から TypeScript の型定義を生成する\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.cybozu.io/entry/2020/06/25/105457\"\u003estyled-components の採用と既存資産を捨てた理由\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eそこから kintone の開発メンバーの一部とともに少しずつ React への置き換えを進めるようになりましたが、リソース的にできる範囲とスピードに課題感を抱えており、このままでは 5 年かかっても完了しないのではないかという不安がありました。\u003c/p\u003e\n\u003cp\u003eこの不安をどうやれば解消できるか、どうすればスピードアップできるかをチーム内で定期的に議論していろんな案を考えていました。\u003c/p\u003e\n\u003ch3\u003eプロダクトの課題を組織の課題にする\u003c/h3\u003e\n\u003cp\u003ekintone はサイボウズにとって大事なプロダクトで、そのプロダクトの内部の経年劣化は間違いなく組織にとっても課題です。10 年以上使い続けているフレームワークによる開発は限界に近づいてきていますが、この課題に対しての温度感がフロントエンドエキスパートとその他で大きな差がありました。\u003c/p\u003e\n\u003cp\u003eプロダクト側からすると新規機能の開発やバグ修正などの優先度が高くなりがちなので、脱レガシーにリソースを注力すると決めるのは難しいことだと理解はできます。また、プロダクトより上の層（サイボウズでは本部長などの経営に近い層）からするとゆっくりながらも進んでいるという事実からか、そこまで危機感は持っていないように感じられました。\u003c/p\u003e\n\u003cp\u003eそんな状況もあり、フロントエンドエキスパートチームとしては脱レガシーを組織の課題として、トップダウン的な動きで会社として注力する形でやっていきたいと考えました。しかしながらことはそう簡単ではなく、サイボウズは上長やマネージャーがいないという組織構造から、そういった大きな活動を起こすのに気力とコストを大いに必要としました。（現在この課題に対していろいろなトライを実施しており、解消に向かって進んでいます）\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームからの問題提起を根気強く続けながら、プロダクトのメンバーや本部長を交えてどういったチーム構成でどうリリースまで持っていくかなどさまざまな議論を重ねました。その結果、リアーキテクチャプロジェクトとして発足するに至り、組織の課題として取り組める状況まで持っていくことができました。\u003c/p\u003e\n\u003ch2\u003e横断的な支援チームで難しいと感じるところ\u003c/h2\u003e\n\u003cp\u003e支援チームで活動していく上で何度か感じた難しいところがあります。それは、外側からの働きかけだけではやれることが多くないということです。外側からいくら熱心に働きかけても支援先のプロダクトなりチームなりが自分ごととして動いてくれない限りは、その場限りの活動になりがちで支援の効果も一時的なものになってしまいます。\u003c/p\u003e\n\u003cp\u003eこういった実感からフロントエンドエキスパートチームでは、短中期で支援先の内部に入って活動するという方法を取ることが多くなりました。その場限りの支援にならないように仕組みを整えたり、初期段階のブースター役としてがっちりプロダクトチームに寄り添そうような形で支援できるように心がけています。支援したい対象はいくつもありますが、焦らずに 1 つずつ集中して解決していくのが支援チームとしてうまく動いていくのには重要だと思います。\u003c/p\u003e\n\u003cp\u003eまた、支援が一方的な押し付けにならないように、関わるメンバーにその支援活動の意味や意義を共感してもらうことに対して手を抜かないことも大事だと感じています。\u003c/p\u003e\n\u003ch2\u003e継続的な社内啓蒙と社外発信\u003c/h2\u003e\n\u003cp\u003e啓蒙・発信をチームの取り組みとして行なっています。社内勉強会として Frontend Weekly を、社外イベントとして Cybozu Frontend Monthly を継続して開催しています。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.github.io/frontend-expert/posts/frontendWeekly-And-Monthly\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eどちらも意識しているのは開催のコストを下げることです。司会を交代制にしたり、録画での開催を試したりと、常にコストを下げる工夫を行なっています。その結果、Frontend Weekly は 5 周年、Cybozu Frontend Monthly は 17 ヶ月連続で開催しています。\u003c/p\u003e\n\u003cp\u003eCybozu Frontend Monthly は多くの人に視聴してもらえており、中途入社のきっかけになったり、学生への認知向上といった効果も出ています。これからも無理しない範囲で続けていければと思います。\u003c/p\u003e\n\u003ch3\u003e社外発信のコストと心理的障壁を減らす\u003c/h3\u003e\n\u003cp\u003e今年はフロントエンドエキスパートチームの web サイト(このサイト)を作成して、そこでの情報発信をはじめました。サイボウズの技術ブログは他にもありますが、あちらはプロダクトでの知見を共有する場という側面が強かったり、ちゃんとしたものをそこそこのボリュームで出さなければという意識が働くといった意見がチーム内で出たりと、若干のハードルを感じる場所になっています。\u003c/p\u003e\n\u003cp\u003eチームの web サイトであれば、フロントエンドの情報に偏っていても問題なく、プロダクトに依存しない内容を気軽に発信できる場所として機能すると考えました。\u003c/p\u003e\n\u003cp\u003e記事の執筆は一見コストが高そうですが、フロントエンドエキスパートチームではもともと社内 SNS(kintone)に web の最新情報などを共有する活動を行なっていました。この情報を外向けに少し整える手間さえかければアウトプットが行えるので、記事作成のコストが低めで継続が見込めます。\u003c/p\u003e\n\u003cp\u003e今年の 10 月にサイトを開設してから 3 ヶ月で記事を 10 本投稿できていることから、今の所うまくいっているように思います。\u003c/p\u003e\n\u003ch2\u003eおわりに\u003c/h2\u003e\n\u003cp\u003e2021 年はフロントエンドエキスパートチームとして存在感と価値を発揮できた年だと感じています。地道な草の根活動からプロジェクト化へこぎつけたり、継続的な発信が行えていたりと、エキスパートチームらしい働きができたのかなと思います。\u003c/p\u003e\n\u003cp\u003eフロントエンドエキスパートチームの活動はチームメンバーだけでなく、プロダクトチームなどの協力があってこその活動も多いです。来年も関係各所と連携を取りつつ、着々と成果が出せるように取り組んで行きたいと思います。\u003c/p\u003e\n\u003cp\u003eフロントエンドの横断的支援チーム、フロントエンドのリアーキテクチャなどに興味がある方はカジュアル面談、応募をお待ちしております。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.co.jp/recruit/entry/career/front-end-expert.html\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://cybozu.co.jp/recruit/entry/career/front-end-engineer-kintone.html\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n","metaData":{"title":"長期運用プロダクトを抱える組織で横断的なフロントエンド支援チームが1年で行なったこと","author":"nakajmg","createdAt":"2021-12-18","summary":"サイボウズのフロントエンドエキスパートチームの2021年の活動内容を紹介します。","tags":["Cybozu","FrontendExpert"],"updatedAt":"2021-12-18"}}],"totalPage":7,"pageNum":5},"__N_SSG":true},"page":"/posts/page/[pageNum]","query":{"pageNum":"5"},"buildId":"TJYDfOC8APX_Mlwq6jN6v","assetPrefix":"/frontend-expert","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>