<!DOCTYPE html><html lang="ja"><head><title>主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える | サイボウズ フロントエンドエキスパートチーム</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="CSS Cascade Layersを使ったスタイルの管理方法について紹介します"/><link rel="icon" type="image/png" sizes="32x32" href="/frontend-expert/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/frontend-expert/icons/favicon-16x16.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える | サイボウズ フロントエンドエキスパートチーム"/><meta name="twitter:description" content="CSS Cascade Layersを使ったスタイルの管理方法について紹介します"/><meta name="twitter:image " content="https://cybozu.github.io/frontend-expert/ogp/posts/css-cascade-layers.jpg"/><meta property="og:type" content="article"/><meta property="og:title" content="主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える | サイボウズ フロントエンドエキスパートチーム"/><meta property="og:site_name" content="サイボウズ フロントエンドエキスパートチーム"/><meta property="og:description" content="CSS Cascade Layersを使ったスタイルの管理方法について紹介します"/><meta property="og:image" content="https://cybozu.github.io/frontend-expert/ogp/posts/css-cascade-layers.jpg"/><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/frontend-expert/feeds/atom.xml"/><meta name="next-head-count" content="16"/><link rel="preload" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend-expert/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/frontend-expert/_next/static/chunks/webpack-b0f44a7ac00bf3cb.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/framework-742985a85518e1e1.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/main-242b1a0e32bf923c.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/_app-ff35bec35d2bc313.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/a9a7754c-e3ac32efe6bdfc47.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/247-c193c27d2f31cb66.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/814-0ba85a11642c687f.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/871-c552fdc3653c7625.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/836-39a19b1bc48d36a2.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/posts/%5Bslug%5D-ce7d73879922360b.js" defer=""></script><script src="/frontend-expert/_next/static/ajAJ9VecSH2BCPVFs6nbI/_buildManifest.js" defer=""></script><script src="/frontend-expert/_next/static/ajAJ9VecSH2BCPVFs6nbI/_ssgManifest.js" defer=""></script><script src="/frontend-expert/_next/static/ajAJ9VecSH2BCPVFs6nbI/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css ruypru">.css-ruypru{width:100%;}.css-ruypru .main{max-width:100%;background-color:white;}.css-ruypru .main .content{margin:0 auto;max-width:var(--content-width);box-sizing:border-box;padding:1rem 1rem 1.5rem;min-height:400px;}</style><div class="css-ruypru"><style data-emotion="css 14l5li6">.css-14l5li6{padding:1.2rem 0 1rem;background-color:var(--primary-color);}.css-14l5li6 .content{max-width:var(--content-width);margin:0 auto;padding:0 1rem;box-sizing:border-box;}.css-14l5li6 h1{font-size:1.6rem;}.css-14l5li6 .navigation ul{margin:0;list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-14l5li6 .navigation ul li{padding:0.2rem 0;font-size:1rem;}.css-14l5li6 .navigation ul li:not(:last-child)::after{content:"/";margin:0 0.4rem;color:var(--light-font-color);}.css-14l5li6 a{color:var(--light-font-color);}</style><header class="css-14l5li6"><div class="content"><h1><a href="/frontend-expert"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27200%27%20height=%2778%27/%3e"/></span><img alt="Frontend Expert Team Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Frontend Expert Team Logo" src="/frontend-expert/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></h1><nav class="navigation"><ul><li><a href="/frontend-expert/members">Members</a></li><li><a href="/frontend-expert/posts">Posts</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/list/front_end_expert.html" target="_blank" rel="noopener noreferrer">Recruiting</a></li></ul></nav></div></header><main class="main"><div class="content"><style data-emotion="css wv9xy9">.css-wv9xy9{margin-left:0;margin-right:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.8rem;line-height:1.5;}</style><h2 class="css-wv9xy9"><span style="word-break: keep-all; overflow-wrap: break-word;">主要ブラウザで<wbr>使える！CSS Cascade Layers で<wbr>新しいCSS設計の<wbr>手法を<wbr>考える</span></h2><style data-emotion="css 30b2xt">.css-30b2xt{margin-top:0.6rem;font-size:0.8rem;font-weight:bold;}</style><div class="css-30b2xt">Published on<!-- --> <!-- --><time dateTime="2022-03-22" itemProp="datePublished">2022-03-22</time></div><style data-emotion="css 1yefgjn">.css-1yefgjn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1.5rem 0;}.css-1yefgjn .editors{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:0.4rem;}.css-1yefgjn .author+.editors{margin-left:16px;padding-left:16px;border-left:1px solid #d3d3d3;}</style><div class="css-1yefgjn"><div class="author"><style data-emotion="css jzce96">.css-jzce96{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:60px;color:#333;}.css-jzce96 .label{width:100%;font-size:0.6rem;font-weight:bold;}.css-jzce96 .memberIcon img{border-radius:4px;}.css-jzce96 a{color:inherit;}.css-jzce96 .icon{display:block;}.css-jzce96 .icon svg{color:#444;width:18px;height:18px;font-size:1rem;}.css-jzce96 .authorName{font-size:0.9rem;line-height:1;margin-top:4px;}.css-jzce96 .authorInfo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding-left:0.6rem;font-size:1rem;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}.css-jzce96 .authorInfo ul{list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:4px;}.css-jzce96 .authorInfo ul li:not(:last-of-type){margin-right:8px;}</style><div class="css-jzce96"><a class="memberIcon" href="/frontend-expert/members/nus3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:60px;height:60px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nus3" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nus3" src="/frontend-expert//member-icons/nus3.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a><div class="authorInfo"><div class="label">Author</div><span class="authorName"><a href="/frontend-expert/members/nus3">nus3</a></span><ul><li><a href="https://twitter.com/nus3_" aria-label="twitter" class="icon" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="18" height="18"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li><a href="https://github.com/nus3" aria-label="github" class="icon" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github-alt" class="svg-inline--fa fa-github-alt fa-w-15 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512" width="18" height="18"><path fill="currentColor" d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg></a></li></ul></div></div></div><div class="editors"><div class="css-jzce96"><a class="memberIcon" href="/frontend-expert/members/nakajmg"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:60px;height:60px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="nakajmg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="nakajmg" src="/frontend-expert//member-icons/nakajmg.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a><div class="authorInfo"><div class="label">Editor</div><span class="authorName"><a href="/frontend-expert/members/nakajmg">nakajmg</a></span><ul><li><a href="https://twitter.com/nakajmg" aria-label="twitter" class="icon" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="18" height="18"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li><a href="https://github.com/nakajmg" aria-label="github" class="icon" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github-alt" class="svg-inline--fa fa-github-alt fa-w-15 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512" width="18" height="18"><path fill="currentColor" d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg></a></li></ul></div></div></div></div><style data-emotion="css 1my302l">.css-1my302l{margin:0 auto;}.css-1my302l h1{margin-left:0;margin-right:0;margin-top:1.75rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}.css-1my302l h2{margin-top:1rem;margin-bottom:1rem;font-size:1.6rem;border-bottom:1px solid #ccc;padding-bottom:0.2rem;}.css-1my302l h3{margin-top:1rem;font-size:1.4rem;}.css-1my302l h4{margin-top:1rem;font-size:1.2rem;}.css-1my302l h5{margin-top:1rem;font-size:1.4rem;}.css-1my302l h6{margin-top:1rem;font-size:1.2rem;}.css-1my302l table{width:100%;font-size:1rem;}.css-1my302l img{display:block;margin:0.5rem auto 0;max-width:80%;height:auto;}.css-1my302l p{margin-top:0.8rem;line-height:1.75;font-size:1rem;}.css-1my302l li{margin-left:1rem;font-size:1rem;}.css-1my302l ul{margin-top:1.2rem;margin-bottom:1.2rem;box-sizing:border-box;line-height:2;margin-left:1rem;}.css-1my302l ul ul{margin:0;}.css-1my302l ol{margin-top:1rem;box-sizing:border-box;}.css-1my302l hr{margin-top:1rem;}.css-1my302l a{word-wrap:break-word;}.css-1my302l code:not([class*="language-"]){padding:0.2em 0.4em;margin:0;font-size:0.8rem;background-color:rgba(27, 31, 35, 0.05);border-radius:3px;}.css-1my302l .post table{margin-top:1rem;display:block;width:100%;overflow:auto;}.css-1my302l .post table th{font-weight:600;}.css-1my302l .post table td,.css-1my302l .post table th{padding:6px 13px;border:1px solid #dfe2e5;}.css-1my302l .post table tr{border-top:1px solid #c6cbd1;}</style><div class="css-1my302l"><div><p><a href="https://developer.chrome.com/blog/new-in-chrome-99/">Chrome99</a>に新機能として CSS Cascade Layers が実装され、Firefox、Edge、Safari といった主要ブラウザで CSS Cascade Layers が使えるようになりました。</p>
<h2>CSS Cascade Layers とは</h2>
<p>CSS の仕様において、要素にどのスタイルを適用するかはざっくりと次のような優先順位で決定されていました。(カスケード順を省いて簡略的に記述しています)</p>
<ol>
<li><code>!important</code></li>
<li>インラインスタイル</li>
<li>セレクターの詳細度</li>
<li>同じ詳細度であれば最後に宣言されたもの</li>
</ol>
<p>ここに CSS Cascade Layers が導入されると次のように変わります。</p>
<ol>
<li><code>!important</code></li>
<li>インラインスタイル</li>
<li><strong>Cascade Layers</strong></li>
<li>セレクターの詳細度</li>
<li>同じ詳細度であれば最後に宣言されたもの</li>
</ol>
<h2>従来の CSS が抱える複雑な詳細度の管理</h2>
<p>どのスタイルを適用するか判断するのにセレクターの詳細度を用いる場合は、詳細度がより高いものが適用されます。</p>
<p>セレクターの詳細度は、高い順に次のような順番になります。</p>
<ol>
<li>ID セレクター: <code>#example</code></li>
<li>クラスセレクター: <code>.example</code>, 属性セレクター: <code>[type="radio"]</code>, 疑似クラス: <code>:hover</code></li>
<li>要素型セレクター: <code>h1</code>, 擬似要素: <code>::before</code></li>
</ol>
<p>また、単純にセレクターの種類だけでなく、セレクターの数も詳細度に影響します。</p>
<p>参考: <a href="https://specifishity.com/">https://specifishity.com/</a></p>
<p>CSS の記述量が増えていくにつれ、この詳細度をうまく管理できず意図しないスタイルが適用されることがままあります。意図しないスタイルが適用されないために、セレクターの命名規則を厳格にする<a href="http://getbem.com/naming/">BEM</a>などの設計手法を取り入れて対応することもあります。</p>
<p>しかし、命名規則をベースとした設計手法では、サードパーティの CSS ライブラリを使用する場合や、コントロールが難しいくらい多い記述量の CSS になってしまった場合、全体の詳細度を把握して管理することはなかなか大変です。</p>
<h2>Cascade Layers によってどう変わるか</h2>
<p>Cascade Layers を使うと、セレクターの詳細度よりも優先してスタイルが適用されるレイヤーを定義できるようになります。</p>
<p>実際にコードで見てみましょう。</p>
<h3>通常の詳細度を使ったスタイルの適用</h3>
<p>Cascade Layers を使わない場合、同じ詳細度のセレクターは属性値での記述順に関わらず、スタイルシート内で最後に宣言されたスタイルが適用されます。</p>
<p>次の場合、<code>.base</code> と <code>.nus3</code> は同一の詳細度です。また、1 つ目の <code>.base</code> は最後に記述されている <code>.base</code> によって上書きされます。このボタンには<code>style</code>内で一番最後に記述されている <code>.base</code> のスタイルが適用され、背景色が <code>royalblue</code> になります。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector"><span class="token class">.base</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">crimson</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">white</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.base</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">royalblue</span><span class="token punctuation">;</span> <span class="token comment">/* このスタイルが適用される */</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>base nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>royalblueになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>また、セレクターの詳細度は種類によって異なり、要素セレクター &#x3C; クラスセレクター &#x3C; ID セレクター の順に高くなります。</p>
<p>次の場合、ID セレクター(<code>#btn</code>)のほうがクラスセレクター(<code>.nus3</code>) や要素セレクター(<code>button</code>)よりも詳細度が高いので、<code>#btn</code> のスタイルが適用されます。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">button</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">coral</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token id">#btn</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">crimson</span><span class="token punctuation">;</span> <span class="token comment">/* このスタイルが適用される */</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">black</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>crimsonになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<h3>Cascade Layers を使ったスタイルの適用</h3>
<p>Cascade Layers では、まず<code>@layer</code>構文を使ってレイヤーを定義します。</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css">`<span class="token atrule"><span class="token rule">@layer</span> base<span class="token punctuation">,</span> page<span class="token punctuation">,</span> utilities<span class="token punctuation">;</span></span>`
</code></pre></div>
<p>このとき、base、page、utilities の 3 つのレイヤーを定義するとともに、レイヤーの優先順位を定義しています。</p>
<p>この場合、各レイヤーのスタイルは後ろに定義したものほど優先度が高く、次のような優先度でスタイルが適用されます。</p>
<ol>
<li>utilities</li>
<li>page</li>
<li>base</li>
</ol>
<p>ここではレイヤーの定義と優先度を同時に定義していますが、この記述を省略した場合、あとに定義したレイヤーの優先度が高くなります。</p>
<p>レイヤーの動作についてサンプルコードで詳しく見てみましょう。</p>
<p>次のコードは、前述したコードをベースに <code>@layer</code> を追加したものです。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token atrule"><span class="token rule">@layer</span> base<span class="token punctuation">,</span> page<span class="token punctuation">,</span> utilities<span class="token punctuation">;</span></span>

  <span class="token atrule"><span class="token rule">@layer</span> utilities</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token class">.shiny</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">gold</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token atrule"><span class="token rule">@layer</span> page</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token id">#btn</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">crimson</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token atrule"><span class="token rule">@layer</span> base</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token class">.base</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">crimson</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">white</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shiny base nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>goldになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shiny<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>goldになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>１つ目のボタンはレイヤーがない場合には最後に宣言されている <code>.nus3</code> の <code>white</code> が適用されていましたが、優先度の高い utilities レイヤーに定義した <code>.shiny</code> の <code>gold</code> が適用されます。</p>
<p>２つ目のボタンはレイヤーがない場合には ID セレクターの <code>#btn</code> のスタイルが適用されていましたが、この場合も utilities レイヤーに定義した <code>.shiny</code> のほうが優先度が高いため、 <code>gold</code> が適用されます。</p>
<p>次のサンプルページを開いて、DevTools で対象の要素をみると Cascade Layers が適用されているのがわかります。</p>
<p><a href="https://c1r38o.csb.app/">サンプルページ</a></p>
<p><img src="/frontend-expert/image/css-cascade-layers/devtools.png" alt="DevToolsで確認すると実際にCascade Layersが適用されている" width="337" height="400" ></p>
<p>レイヤーの適用順が utilities > page > base になってるのがわかります。</p>
<p>このように、Cascade Layers を使うことで、詳細度ではなくレイヤーでスタイルをコントロールできるようになります。</p>
<h3>Cascade Layers 内で<code>!important</code>を使った際のスタイルの優先順位</h3>
<p><code>!important</code>を使っていない場合、Cascade Layers で定義したレイヤー外のスタイルが優先して適用されます。</p>
<p>これはカスケード順が、レイヤー内 &#x3C; レイヤー外 の順に高くなっているからです。</p>
<p>次のコードでは、レイヤー外のスタイルが適用され、ボタンの背景色が<code>white</code>になります。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token atrule"><span class="token rule">@layer</span> base</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">gold</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">white</span><span class="token punctuation">;</span> <span class="token comment">/* このスタイルが適用される */</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>whiteになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>しかし、<code>!important</code>を使ったスタイルの場合、このカスケード順が変わるので注意が必要です。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token atrule"><span class="token rule">@layer</span> base</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">gold</span> <span class="token important">!important</span><span class="token punctuation">;</span> <span class="token comment">/* このスタイルが適用される */</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token selector"><span class="token class">.nus3</span></span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">white</span> <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>goldになる<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<h2>CSS フレームワークにも Cascade Layers は使える</h2>
<p>Bootstrap や Materialize CSS、Bulma といった CSS フレームワークにも Cascade Layers を使ってレイヤーを定義できます。</p>
<p>CSS フレームワークの一つである<a href="https://bulma.io/">Bulma</a>を使って試してみましょう。</p>
<p>本来、次のようなクラスをボタンに付与すると、Bulma で元から定義されている<code>.button.is-primary</code>が、後に追加した<code>.button-nus3</code>より詳細度が高くなり、<code>.button-nus3</code>のスタイルは適用されません。</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button is-primary button-nus3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ボタン<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre></div>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@import</span> <span class="token string">"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"styles/page.css"</span><span class="token punctuation">;</span></span>

<span class="token comment">/* styles/page.cssで定義されているスタイル */</span>
<span class="token selector"><span class="token class">.button-nus3</span></span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token color">gold</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>しかし次のように Cascade Layers を使い、<a href="https://bulma.io/">Bulma</a>の CSS を<code>base</code>のレイヤーにしつつ、画面特有のスタイルを<code>styles/page.css</code>に定義することで、詳細度の影響を気にすることなく Bulma のスタイルを上書きすることができます。</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@layer</span> base<span class="token punctuation">,</span> page<span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"</span> <span class="token function">layer</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"styles/page.css"</span> <span class="token function">layer</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
</code></pre></div>
<p>対象ブラウザのサポート状況は考慮する必要がありますが、CSS の記述量が増えることが想定されるプロジェクトには、Cascade Layers をベースにした設計を検討してみてはいかがでしょうか。</p>
<h2>参考リンクなど</h2>
<ul>
<li><a href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@layer">https://developer.mozilla.org/en-US/docs/Web/CSS/@layer</a></li>
<li><a href="https://developer.chrome.com/blog/cascade-layers/">https://developer.chrome.com/blog/cascade-layers/</a></li>
<li><a href="https://github.com/nus3/p-css-cascade-layers">サンプル実装したリポジトリ</a></li>
</ul>
</div></div><style data-emotion="css xjpton">.css-xjpton{margin-top:1.6rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;justify-items:flex-end;}.css-xjpton .tag{font-size:0.8rem;border:1px solid #888;color:#444;padding:0.2rem 0.4rem;cursor:pointer;margin-right:0.8rem;border-radius:2px;}.css-xjpton .tag:link,.css-xjpton .tag:visited{color:#444;}</style><div class="css-xjpton"><a class="tag" href="/frontend-expert/tags/CSS">CSS</a></div><style data-emotion="css 1ees6rw">.css-1ees6rw{margin-top:32px;}.css-1ees6rw .tweetButton{width:88px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px;font-size:12px;background-color:#1d9bf0;position:relative;height:20px;box-sizing:border-box;padding:1px 12px 1px 12px;color:#fff;border-radius:9999px;font-weight:500;cursor:pointer;vertical-align:top;}.css-1ees6rw .tweetButton:hover{background-color:#0c7abf;}.css-1ees6rw .tweetButton svg{display:inline-block;width:12px;height:12px;margin-right:4px;}</style><p class="css-1ees6rw"><a href="" class="tweetButton" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>ツイート<!-- --></a></p><style data-emotion="css 12fmiz3">.css-12fmiz3{font-size:0.9rem;text-align:center;margin-top:16px;padding-top:16px;border-top:1px solid #ccc;}</style><div class="css-12fmiz3">記事に関する報告などは<!-- --><a href="https://github.com/cybozu/frontend-expert/issues" target="_blank" rel="noopener noreferrer">こちら</a>から<!-- --></div></div></main><style data-emotion="css 1n88omd">.css-1n88omd{padding:2.4rem 0;background-color:var(--primary-color);color:white;}.css-1n88omd .content{max-width:var(--content-width);padding:0 1.2rem;box-sizing:border-box;margin:0 auto;}.css-1n88omd a{color:white;}.css-1n88omd ul{list-style:none;margin-bottom:2.5rem;}.css-1n88omd ul li{font-size:1.2rem;margin-bottom:0.5rem;}.css-1n88omd small{font-size:1rem;}</style><footer class="css-1n88omd"><div class="content"><ul><li><a href="https://cybozu.co.jp/">サイボウズ 企業情報</a></li><li><a href="https://www.cybozu.com/jp/">cybozu.com</a></li><li><a href="https://blog.cybozu.io/">サイボウズエンジニアのブログ Cybozu Inside Out</a></li><li><a href="https://tech.cybozu.io/">Cybozu Tech</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/">採用情報</a></li></ul><small>Copyright © Cybozu, Inc.</small></div></footer></div>;<!-- --></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"css-cascade-layers","content":"\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/\"\u003eChrome99\u003c/a\u003eに新機能として CSS Cascade Layers が実装され、Firefox、Edge、Safari といった主要ブラウザで CSS Cascade Layers が使えるようになりました。\u003c/p\u003e\n\u003ch2\u003eCSS Cascade Layers とは\u003c/h2\u003e\n\u003cp\u003eCSS の仕様において、要素にどのスタイルを適用するかはざっくりと次のような優先順位で決定されていました。(カスケード順を省いて簡略的に記述しています)\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここに CSS Cascade Layers が導入されると次のように変わります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCascade Layers\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e従来の CSS が抱える複雑な詳細度の管理\u003c/h2\u003e\n\u003cp\u003eどのスタイルを適用するか判断するのにセレクターの詳細度を用いる場合は、詳細度がより高いものが適用されます。\u003c/p\u003e\n\u003cp\u003eセレクターの詳細度は、高い順に次のような順番になります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eID セレクター: \u003ccode\u003e#example\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eクラスセレクター: \u003ccode\u003e.example\u003c/code\u003e, 属性セレクター: \u003ccode\u003e[type=\"radio\"]\u003c/code\u003e, 疑似クラス: \u003ccode\u003e:hover\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e要素型セレクター: \u003ccode\u003eh1\u003c/code\u003e, 擬似要素: \u003ccode\u003e::before\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eまた、単純にセレクターの種類だけでなく、セレクターの数も詳細度に影響します。\u003c/p\u003e\n\u003cp\u003e参考: \u003ca href=\"https://specifishity.com/\"\u003ehttps://specifishity.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCSS の記述量が増えていくにつれ、この詳細度をうまく管理できず意図しないスタイルが適用されることがままあります。意図しないスタイルが適用されないために、セレクターの命名規則を厳格にする\u003ca href=\"http://getbem.com/naming/\"\u003eBEM\u003c/a\u003eなどの設計手法を取り入れて対応することもあります。\u003c/p\u003e\n\u003cp\u003eしかし、命名規則をベースとした設計手法では、サードパーティの CSS ライブラリを使用する場合や、コントロールが難しいくらい多い記述量の CSS になってしまった場合、全体の詳細度を把握して管理することはなかなか大変です。\u003c/p\u003e\n\u003ch2\u003eCascade Layers によってどう変わるか\u003c/h2\u003e\n\u003cp\u003eCascade Layers を使うと、セレクターの詳細度よりも優先してスタイルが適用されるレイヤーを定義できるようになります。\u003c/p\u003e\n\u003cp\u003e実際にコードで見てみましょう。\u003c/p\u003e\n\u003ch3\u003e通常の詳細度を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers を使わない場合、同じ詳細度のセレクターは属性値での記述順に関わらず、スタイルシート内で最後に宣言されたスタイルが適用されます。\u003c/p\u003e\n\u003cp\u003e次の場合、\u003ccode\u003e.base\u003c/code\u003e と \u003ccode\u003e.nus3\u003c/code\u003e は同一の詳細度です。また、1 つ目の \u003ccode\u003e.base\u003c/code\u003e は最後に記述されている \u003ccode\u003e.base\u003c/code\u003e によって上書きされます。このボタンには\u003ccode\u003estyle\u003c/code\u003e内で一番最後に記述されている \u003ccode\u003e.base\u003c/code\u003e のスタイルが適用され、背景色が \u003ccode\u003eroyalblue\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eroyalblue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebase nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eroyalblueになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた、セレクターの詳細度は種類によって異なり、要素セレクター \u0026#x3C; クラスセレクター \u0026#x3C; ID セレクター の順に高くなります。\u003c/p\u003e\n\u003cp\u003e次の場合、ID セレクター(\u003ccode\u003e#btn\u003c/code\u003e)のほうがクラスセレクター(\u003ccode\u003e.nus3\u003c/code\u003e) や要素セレクター(\u003ccode\u003ebutton\u003c/code\u003e)よりも詳細度が高いので、\u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecoral\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eblack\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ecrimsonになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eCascade Layers を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers では、まず\u003ccode\u003e@layer\u003c/code\u003e構文を使ってレイヤーを定義します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e`\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e`\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのとき、base、page、utilities の 3 つのレイヤーを定義するとともに、レイヤーの優先順位を定義しています。\u003c/p\u003e\n\u003cp\u003eこの場合、各レイヤーのスタイルは後ろに定義したものほど優先度が高く、次のような優先度でスタイルが適用されます。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eutilities\u003c/li\u003e\n\u003cli\u003epage\u003c/li\u003e\n\u003cli\u003ebase\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここではレイヤーの定義と優先度を同時に定義していますが、この記述を省略した場合、あとに定義したレイヤーの優先度が高くなります。\u003c/p\u003e\n\u003cp\u003eレイヤーの動作についてサンプルコードで詳しく見てみましょう。\u003c/p\u003e\n\u003cp\u003e次のコードは、前述したコードをベースに \u003ccode\u003e@layer\u003c/code\u003e を追加したものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e utilities\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.shiny\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e page\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny base nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e１つ目のボタンはレイヤーがない場合には最後に宣言されている \u003ccode\u003e.nus3\u003c/code\u003e の \u003ccode\u003ewhite\u003c/code\u003e が適用されていましたが、優先度の高い utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e の \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e２つ目のボタンはレイヤーがない場合には ID セレクターの \u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されていましたが、この場合も utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e のほうが優先度が高いため、 \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e次のサンプルページを開いて、DevTools で対象の要素をみると Cascade Layers が適用されているのがわかります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://c1r38o.csb.app/\"\u003eサンプルページ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/css-cascade-layers/devtools.png\" alt=\"DevToolsで確認すると実際にCascade Layersが適用されている\" width=\"337\" height=\"400\" \u003e\u003c/p\u003e\n\u003cp\u003eレイヤーの適用順が utilities \u003e page \u003e base になってるのがわかります。\u003c/p\u003e\n\u003cp\u003eこのように、Cascade Layers を使うことで、詳細度ではなくレイヤーでスタイルをコントロールできるようになります。\u003c/p\u003e\n\u003ch3\u003eCascade Layers 内で\u003ccode\u003e!important\u003c/code\u003eを使った際のスタイルの優先順位\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e!important\u003c/code\u003eを使っていない場合、Cascade Layers で定義したレイヤー外のスタイルが優先して適用されます。\u003c/p\u003e\n\u003cp\u003eこれはカスケード順が、レイヤー内 \u0026#x3C; レイヤー外 の順に高くなっているからです。\u003c/p\u003e\n\u003cp\u003e次のコードでは、レイヤー外のスタイルが適用され、ボタンの背景色が\u003ccode\u003ewhite\u003c/code\u003eになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ewhiteになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、\u003ccode\u003e!important\u003c/code\u003eを使ったスタイルの場合、このカスケード順が変わるので注意が必要です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eCSS フレームワークにも Cascade Layers は使える\u003c/h2\u003e\n\u003cp\u003eBootstrap や Materialize CSS、Bulma といった CSS フレームワークにも Cascade Layers を使ってレイヤーを定義できます。\u003c/p\u003e\n\u003cp\u003eCSS フレームワークの一つである\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eを使って試してみましょう。\u003c/p\u003e\n\u003cp\u003e本来、次のようなクラスをボタンに付与すると、Bulma で元から定義されている\u003ccode\u003e.button.is-primary\u003c/code\u003eが、後に追加した\u003ccode\u003e.button-nus3\u003c/code\u003eより詳細度が高くなり、\u003ccode\u003e.button-nus3\u003c/code\u003eのスタイルは適用されません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebutton is-primary button-nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eボタン\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* styles/page.cssで定義されているスタイル */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.button-nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし次のように Cascade Layers を使い、\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eの CSS を\u003ccode\u003ebase\u003c/code\u003eのレイヤーにしつつ、画面特有のスタイルを\u003ccode\u003estyles/page.css\u003c/code\u003eに定義することで、詳細度の影響を気にすることなく Bulma のスタイルを上書きすることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e対象ブラウザのサポート状況は考慮する必要がありますが、CSS の記述量が増えることが想定されるプロジェクトには、Cascade Layers をベースにした設計を検討してみてはいかがでしょうか。\u003c/p\u003e\n\u003ch2\u003e参考リンクなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.w3.org/TR/css-cascade-5/\"\u003ehttps://www.w3.org/TR/css-cascade-5/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@layer\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/@layer\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/cascade-layers/\"\u003ehttps://developer.chrome.com/blog/cascade-layers/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nus3/p-css-cascade-layers\"\u003eサンプル実装したリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える","author":"nus3","editor":["nakajmg"],"createdAt":"2022-03-22","summary":"CSS Cascade Layersを使ったスタイルの管理方法について紹介します","tags":["CSS"],"updatedAt":"2022-03-22"}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"css-cascade-layers"},"buildId":"ajAJ9VecSH2BCPVFs6nbI","assetPrefix":"/frontend-expert","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>