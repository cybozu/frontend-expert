<!DOCTYPE html><html lang="ja"><head><title>CSS | サイボウズ フロントエンドエキスパートチーム</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><link rel="icon" type="image/png" sizes="32x32" href="/frontend-expert/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/frontend-expert/icons/favicon-16x16.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="CSS | サイボウズ フロントエンドエキスパートチーム"/><meta name="twitter:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta name="twitter:image " content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><meta property="og:type" content="article"/><meta property="og:title" content="CSS | サイボウズ フロントエンドエキスパートチーム"/><meta property="og:site_name" content="サイボウズ フロントエンドエキスパートチーム"/><meta property="og:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta property="og:image" content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/frontend-expert/feeds/atom.xml"/><meta name="next-head-count" content="16"/><link rel="preload" href="/frontend-expert/_next/static/css/76ea63cd4865a048.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/76ea63cd4865a048.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend-expert/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/frontend-expert/_next/static/chunks/webpack-729603c643508a46.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/framework-46c1838cec3c6950.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/main-e4d3653ad74fa65d.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/_app-b7e0aa21badb5823.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/896-11851048522348ad.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/tags/%5Btag%5D-ff3c8581788d7d29.js" defer=""></script><script src="/frontend-expert/_next/static/PYIg9mdCVMJk_wK0W0u8t/_buildManifest.js" defer=""></script><script src="/frontend-expert/_next/static/PYIg9mdCVMJk_wK0W0u8t/_ssgManifest.js" defer=""></script><script src="/frontend-expert/_next/static/PYIg9mdCVMJk_wK0W0u8t/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="css-8pyqwr"><header class="css-1qspodk"><div class="content"><h1><a href="/frontend-expert"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9Ijc4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="Frontend Expert Team Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Frontend Expert Team Logo" src="/frontend-expert/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></h1><nav class="navigation"><ul><li><a href="/frontend-expert/members">Members</a></li><li><a href="/frontend-expert/posts">Posts</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/list/front_end_expert.html" target="_blank" rel="noopener noreferrer">Recruiting</a></li></ul></nav></div></header><main class="main"><div class="content"><h2>CSS</h2><div class="css-1jmg40x"><div class="item"><a href="/frontend-expert/posts/css-cascade-layers">2022-03-22 主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える</a></div></div></div></main><footer class="css-1vmnbu5"><div class="content"><ul><li><a href="https://cybozu.co.jp/">サイボウズ 企業情報</a></li><li><a href="https://www.cybozu.com/jp/">cybozu.com</a></li><li><a href="https://blog.cybozu.io/">サイボウズエンジニアのブログ Cybozu Inside Out</a></li><li><a href="https://tech.cybozu.io/">Cybozu Tech</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/">採用情報</a></li></ul><small>Copyright © Cybozu, Inc.</small></div></footer></div>;</div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"slug":"css-cascade-layers","content":"\u003cp\u003e\u003ca href=\"https://developer.chrome.com/blog/new-in-chrome-99/\"\u003eChrome99\u003c/a\u003eに新機能として CSS Cascade Layers が実装され、Firefox、Edge、Safari といった主要ブラウザで CSS Cascade Layers が使えるようになりました。\u003c/p\u003e\n\u003ch2\u003eCSS Cascade Layers とは\u003c/h2\u003e\n\u003cp\u003eCSS の仕様において、要素にどのスタイルを適用するかはざっくりと次のような優先順位で決定されていました。(カスケード順を省いて簡略的に記述しています)\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここに CSS Cascade Layers が導入されると次のように変わります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e!important\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eインラインスタイル\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCascade Layers\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eセレクターの詳細度\u003c/li\u003e\n\u003cli\u003e同じ詳細度であれば最後に宣言されたもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e従来の CSS が抱える複雑な詳細度の管理\u003c/h2\u003e\n\u003cp\u003eどのスタイルを適用するか判断するのにセレクターの詳細度を用いる場合は、詳細度がより高いものが適用されます。\u003c/p\u003e\n\u003cp\u003eセレクターの詳細度は、高い順に次のような順番になります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eID セレクター: \u003ccode\u003e#example\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eクラスセレクター: \u003ccode\u003e.example\u003c/code\u003e, 属性セレクター: \u003ccode\u003e[type=\"radio\"]\u003c/code\u003e, 疑似クラス: \u003ccode\u003e:hover\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e要素型セレクター: \u003ccode\u003eh1\u003c/code\u003e, 擬似要素: \u003ccode\u003e::before\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eまた、単純にセレクターの種類だけでなく、セレクターの数も詳細度に影響します。\u003c/p\u003e\n\u003cp\u003e参考: \u003ca href=\"https://specifishity.com/\"\u003ehttps://specifishity.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCSS の記述量が増えていくにつれ、この詳細度をうまく管理できず意図しないスタイルが適用されることがままあります。意図しないスタイルが適用されないために、セレクターの命名規則を厳格にする\u003ca href=\"http://getbem.com/naming/\"\u003eBEM\u003c/a\u003eなどの設計手法を取り入れて対応することもあります。\u003c/p\u003e\n\u003cp\u003eしかし、命名規則をベースとした設計手法では、サードパーティの CSS ライブラリを使用する場合や、コントロールが難しいくらい多い記述量の CSS になってしまった場合、全体の詳細度を把握して管理することはなかなか大変です。\u003c/p\u003e\n\u003ch2\u003eCascade Layers によってどう変わるか\u003c/h2\u003e\n\u003cp\u003eCascade Layers を使うと、セレクターの詳細度よりも優先してスタイルが適用されるレイヤーを定義できるようになります。\u003c/p\u003e\n\u003cp\u003e実際にコードで見てみましょう。\u003c/p\u003e\n\u003ch3\u003e通常の詳細度を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers を使わない場合、同じ詳細度のセレクターは属性値での記述順に関わらず、スタイルシート内で最後に宣言されたスタイルが適用されます。\u003c/p\u003e\n\u003cp\u003e次の場合、\u003ccode\u003e.base\u003c/code\u003e と \u003ccode\u003e.nus3\u003c/code\u003e は同一の詳細度です。また、1 つ目の \u003ccode\u003e.base\u003c/code\u003e は最後に記述されている \u003ccode\u003e.base\u003c/code\u003e によって上書きされます。このボタンには\u003ccode\u003estyle\u003c/code\u003e内で一番最後に記述されている \u003ccode\u003e.base\u003c/code\u003e のスタイルが適用され、背景色が \u003ccode\u003eroyalblue\u003c/code\u003e になります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eroyalblue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebase nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eroyalblueになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eまた、セレクターの詳細度は種類によって異なり、要素セレクター \u0026#x3C; クラスセレクター \u0026#x3C; ID セレクター の順に高くなります。\u003c/p\u003e\n\u003cp\u003e次の場合、ID セレクター(\u003ccode\u003e#btn\u003c/code\u003e)のほうがクラスセレクター(\u003ccode\u003e.nus3\u003c/code\u003e) や要素セレクター(\u003ccode\u003ebutton\u003c/code\u003e)よりも詳細度が高いので、\u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecoral\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003eblack\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ecrimsonになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eCascade Layers を使ったスタイルの適用\u003c/h3\u003e\n\u003cp\u003eCascade Layers では、まず\u003ccode\u003e@layer\u003c/code\u003e構文を使ってレイヤーを定義します。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e`\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e`\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこのとき、base、page、utilities の 3 つのレイヤーを定義するとともに、レイヤーの優先順位を定義しています。\u003c/p\u003e\n\u003cp\u003eこの場合、各レイヤーのスタイルは後ろに定義したものほど優先度が高く、次のような優先度でスタイルが適用されます。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eutilities\u003c/li\u003e\n\u003cli\u003epage\u003c/li\u003e\n\u003cli\u003ebase\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eここではレイヤーの定義と優先度を同時に定義していますが、この記述を省略した場合、あとに定義したレイヤーの優先度が高くなります。\u003c/p\u003e\n\u003cp\u003eレイヤーの動作についてサンプルコードで詳しく見てみましょう。\u003c/p\u003e\n\u003cp\u003e次のコードは、前述したコードをベースに \u003ccode\u003e@layer\u003c/code\u003e を追加したものです。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e utilities\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e utilities\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.shiny\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e page\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token id\"\u003e#btn\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.base\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ecrimson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny base nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebtn\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eshiny\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e１つ目のボタンはレイヤーがない場合には最後に宣言されている \u003ccode\u003e.nus3\u003c/code\u003e の \u003ccode\u003ewhite\u003c/code\u003e が適用されていましたが、優先度の高い utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e の \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e２つ目のボタンはレイヤーがない場合には ID セレクターの \u003ccode\u003e#btn\u003c/code\u003e のスタイルが適用されていましたが、この場合も utilities レイヤーに定義した \u003ccode\u003e.shiny\u003c/code\u003e のほうが優先度が高いため、 \u003ccode\u003egold\u003c/code\u003e が適用されます。\u003c/p\u003e\n\u003cp\u003e次のサンプルページを開いて、DevTools で対象の要素をみると Cascade Layers が適用されているのがわかります。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://c1r38o.csb.app/\"\u003eサンプルページ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/frontend-expert/image/css-cascade-layers/devtools.png\" alt=\"DevToolsで確認すると実際にCascade Layersが適用されている\" width=\"337\" height=\"400\" \u003e\u003c/p\u003e\n\u003cp\u003eレイヤーの適用順が utilities \u003e page \u003e base になってるのがわかります。\u003c/p\u003e\n\u003cp\u003eこのように、Cascade Layers を使うことで、詳細度ではなくレイヤーでスタイルをコントロールできるようになります。\u003c/p\u003e\n\u003ch3\u003eCascade Layers 内で\u003ccode\u003e!important\u003c/code\u003eを使った際のスタイルの優先順位\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e!important\u003c/code\u003eを使っていない場合、Cascade Layers で定義したレイヤー外のスタイルが優先して適用されます。\u003c/p\u003e\n\u003cp\u003eこれはカスケード順が、レイヤー内 \u0026#x3C; レイヤー外 の順に高くなっているからです。\u003c/p\u003e\n\u003cp\u003e次のコードでは、レイヤー外のスタイルが適用され、ボタンの背景色が\u003ccode\u003ewhite\u003c/code\u003eになります。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003ewhiteになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし、\u003ccode\u003e!important\u003c/code\u003eを使ったスタイルの場合、このカスケード順が変わるので注意が必要です。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* このスタイルが適用される */\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ewhite\u003c/span\u003e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003enus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003egoldになる\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eCSS フレームワークにも Cascade Layers は使える\u003c/h2\u003e\n\u003cp\u003eBootstrap や Materialize CSS、Bulma といった CSS フレームワークにも Cascade Layers を使ってレイヤーを定義できます。\u003c/p\u003e\n\u003cp\u003eCSS フレームワークの一つである\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eを使って試してみましょう。\u003c/p\u003e\n\u003cp\u003e本来、次のようなクラスをボタンに付与すると、Bulma で元から定義されている\u003ccode\u003e.button.is-primary\u003c/code\u003eが、後に追加した\u003ccode\u003e.button-nus3\u003c/code\u003eより詳細度が高くなり、\u003ccode\u003e.button-nus3\u003c/code\u003eのスタイルは適用されません。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ebutton is-primary button-nus3\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eボタン\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* styles/page.cssで定義されているスタイル */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.button-nus3\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003egold\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eしかし次のように Cascade Layers を使い、\u003ca href=\"https://bulma.io/\"\u003eBulma\u003c/a\u003eの CSS を\u003ccode\u003ebase\u003c/code\u003eのレイヤーにしつつ、画面特有のスタイルを\u003ccode\u003estyles/page.css\u003c/code\u003eに定義することで、詳細度の影響を気にすることなく Bulma のスタイルを上書きすることができます。\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@layer\u003c/span\u003e base\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e page\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@import\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"styles/page.css\"\u003c/span\u003e \u003cspan class=\"token function\"\u003elayer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e対象ブラウザのサポート状況は考慮する必要がありますが、CSS の記述量が増えることが想定されるプロジェクトには、Cascade Layers をベースにした設計を検討してみてはいかがでしょうか。\u003c/p\u003e\n\u003ch2\u003e参考リンクなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.w3.org/TR/css-cascade-5/\"\u003ehttps://www.w3.org/TR/css-cascade-5/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@layer\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/CSS/@layer\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.chrome.com/blog/cascade-layers/\"\u003ehttps://developer.chrome.com/blog/cascade-layers/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nus3/p-css-cascade-layers\"\u003eサンプル実装したリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"主要ブラウザで使える！CSS Cascade Layers で新しいCSS設計の手法を考える","author":"nus3","editor":["nakajmg"],"createdAt":"2022-03-22","summary":"CSS Cascade Layersを使ったスタイルの管理方法について紹介します","tags":["CSS"],"updatedAt":"2022-03-22"}}],"tag":"CSS"},"__N_SSG":true},"page":"/tags/[tag]","query":{"tag":"CSS"},"buildId":"PYIg9mdCVMJk_wK0W0u8t","assetPrefix":"/frontend-expert","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>