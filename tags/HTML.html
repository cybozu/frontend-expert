<!DOCTYPE html><html lang="ja"><head><title>HTML | サイボウズ フロントエンドエキスパートチーム</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><link rel="icon" type="image/png" sizes="32x32" href="/frontend-expert/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/frontend-expert/icons/favicon-16x16.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="HTML | サイボウズ フロントエンドエキスパートチーム"/><meta name="twitter:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta name="twitter:image " content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><meta property="og:type" content="article"/><meta property="og:title" content="HTML | サイボウズ フロントエンドエキスパートチーム"/><meta property="og:site_name" content="サイボウズ フロントエンドエキスパートチーム"/><meta property="og:description" content="サイボウズ フロントエンドエキスパートチームのウェブサイトです"/><meta property="og:image" content="https://cybozu.github.io/frontend-expert/ogp/ogp.jpg"/><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/frontend-expert/feeds/atom.xml"/><meta name="next-head-count" content="16"/><link rel="preload" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" as="style"/><link rel="stylesheet" href="/frontend-expert/_next/static/css/d15332f741e09aa2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend-expert/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/frontend-expert/_next/static/chunks/webpack-b0f44a7ac00bf3cb.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/framework-742985a85518e1e1.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/main-242b1a0e32bf923c.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/_app-ff35bec35d2bc313.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/247-c193c27d2f31cb66.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/836-a8ade638b2eac21f.js" defer=""></script><script src="/frontend-expert/_next/static/chunks/pages/tags/%5Btag%5D-30bc45de8d6c8183.js" defer=""></script><script src="/frontend-expert/_next/static/iynSChS7iaz43C6uR7NMp/_buildManifest.js" defer=""></script><script src="/frontend-expert/_next/static/iynSChS7iaz43C6uR7NMp/_ssgManifest.js" defer=""></script><script src="/frontend-expert/_next/static/iynSChS7iaz43C6uR7NMp/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css ruypru">.css-ruypru{width:100%;}.css-ruypru .main{max-width:100%;background-color:white;}.css-ruypru .main .content{margin:0 auto;max-width:var(--content-width);box-sizing:border-box;padding:1rem 1rem 1.5rem;min-height:400px;}</style><div class="css-ruypru"><style data-emotion="css 14l5li6">.css-14l5li6{padding:1.2rem 0 1rem;background-color:var(--primary-color);}.css-14l5li6 .content{max-width:var(--content-width);margin:0 auto;padding:0 1rem;box-sizing:border-box;}.css-14l5li6 h1{font-size:1.6rem;}.css-14l5li6 .navigation ul{margin:0;list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-14l5li6 .navigation ul li{padding:0.2rem 0;font-size:1rem;}.css-14l5li6 .navigation ul li:not(:last-child)::after{content:"/";margin:0 0.4rem;color:var(--light-font-color);}.css-14l5li6 a{color:var(--light-font-color);}</style><header class="css-14l5li6"><div class="content"><h1><a href="/frontend-expert"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27200%27%20height=%2778%27/%3e"/></span><img alt="Frontend Expert Team Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Frontend Expert Team Logo" src="/frontend-expert/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></h1><nav class="navigation"><ul><li><a href="/frontend-expert/members">Members</a></li><li><a href="/frontend-expert/posts">Posts</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/list/front_end_expert.html" target="_blank" rel="noopener noreferrer">Recruiting</a></li></ul></nav></div></header><main class="main"><div class="content"><h2>HTML</h2><style data-emotion="css 3x8wln">.css-3x8wln .item{font-size:1.1rem;padding:12px 4px 8px;}.css-3x8wln .item+.item{margin-top:8px;border-top:1px solid #ebebeb;}.css-3x8wln .title{font-size:1.2em;}.css-3x8wln .tags{margin-top:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-gap:8px;}.css-3x8wln .tag{font-size:0.5em;border:1px solid;padding:2px 4px;border-radius:2px;color:currentColor;}.css-3x8wln .date{font-size:0.8em;}.css-3x8wln .author{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-gap:8px;padding-top:8px;}.css-3x8wln .author img{border-radius:4px;}</style><div class="css-3x8wln"><div class="item"><a href="/frontend-expert/posts/why-is-import-meta-url-a-string"><div class="title">なぜ import.meta.url は URL オブジェクトではなく文字列なのか</div><div class="author"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:30px;height:30px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="sosukesuzuki" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="sosukesuzuki" src="/frontend-expert//member-icons/sosukesuzuki.jpg" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="date">2022-07-26</span></div><div class="tags"><span class="tag">ECMAScript</span><span class="tag">HTML</span><span class="tag">URL</span></div></a></div></div></div></main><style data-emotion="css 1n88omd">.css-1n88omd{padding:2.4rem 0;background-color:var(--primary-color);color:white;}.css-1n88omd .content{max-width:var(--content-width);padding:0 1.2rem;box-sizing:border-box;margin:0 auto;}.css-1n88omd a{color:white;}.css-1n88omd ul{list-style:none;margin-bottom:2.5rem;}.css-1n88omd ul li{font-size:1.2rem;margin-bottom:0.5rem;}.css-1n88omd small{font-size:1rem;}</style><footer class="css-1n88omd"><div class="content"><ul><li><a href="https://cybozu.co.jp/">サイボウズ 企業情報</a></li><li><a href="https://www.cybozu.com/jp/">cybozu.com</a></li><li><a href="https://blog.cybozu.io/">サイボウズエンジニアのブログ Cybozu Inside Out</a></li><li><a href="https://tech.cybozu.io/">Cybozu Tech</a></li><li><a href="https://cybozu.co.jp/company/job/recruitment/">採用情報</a></li></ul><small>Copyright © Cybozu, Inc.</small></div></footer></div>;<!-- --></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"type":"markdown","href":"/posts/why-is-import-meta-url-a-string","slug":"why-is-import-meta-url-a-string","content":"\u003cp\u003e数多くの Node.js ライブラリの作者として知られる Sindre Sorhus 氏が次のようなツイートをしていた。\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eWhy is `import.meta.url` a string and not a `URL` instance?\u003c/p\u003e\u0026mdash; Sindre Sorhus 💙💛 (@sindresorhus) \u003ca href=\"https://twitter.com/sindresorhus/status/1551202763383644161?ref_src=twsrc%5Etfw\"\u003eJuly 24, 2022\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\u003cp\u003eこれを見て私も理由が気になったので調査してみた。\u003c/p\u003e\n\u003ch2\u003e先にまとめ\u003c/h2\u003e\n\u003cp\u003eURL の仕様にそうすべきと書いてあるから。\u003c/p\u003e\n\u003ch2\u003e普通に考えると？\u003c/h2\u003e\n\u003cp\u003eまず最初に思いつくであろうものが「\u003ccode\u003eimport.meta.url\u003c/code\u003eはECMAScriptの仕様だが、\u003ccode\u003eURL\u003c/code\u003eオブジェクトはHTMLの仕様に含まれるため、仕様間のそういった参照はできない」という理由である。\u003c/p\u003e\n\u003cp\u003e実際 Twitter 上ではそのように考えている人もいた。\u003c/p\u003e\n\u003cp\u003eしかし、それは誤りである。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tc39.es/ecma262/#sec-meta-properties-runtime-semantics-evaluation\"\u003eECMAScriptの\u003ccode\u003eimport.meta\u003c/code\u003eの Runtime Semantics\u003c/a\u003e を見れば明らかだが、ECMAScript の仕様の範囲内では \u003ccode\u003eimport.meta\u003c/code\u003e はオブジェクトであることくらいしか定められていない。どのようなプロパティが提供されるかは各ホストに委ねられている。\u003c/p\u003e\n\u003cp\u003eたとえば HTML や Node.js などの主要なホストでは、(ECMAScriptの立場から見れば偶然)同じ \u003ccode\u003eimport.meta.url\u003c/code\u003e というプロパティが実装されているということになる。\nつまり、\u003ccode\u003eimport.meta.url\u003c/code\u003e は ECMAScript には含まれていない。\u003c/p\u003e\n\u003cp\u003e最近では Vite などのモジュールバンドラーが \u003ccode\u003eimport.meta\u003c/code\u003e に独自のプロパティを実装しているが、それも ECMAScript の仕様としてはなんの問題もない。\u003c/p\u003e\n\u003cp\u003eもちろん、\u003ca href=\"https://html.spec.whatwg.org/multipage/webappapis.html#hostgetimportmetaproperties\"\u003eHTML の \u003ccode\u003eimport.meta.url\u003c/code\u003e は HTML の仕様に定めらている。\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003e実際には\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/tc39/proposal-import-meta\"\u003ehttps://github.com/tc39/proposal-import-meta\u003c/a\u003e に起票された issue に答えが書いてあった。\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"hatena-link\"\u003e\u003ciframe class=\"hatena-link-frame\" src=\"https://hatenablog-parts.com/embed?url=https://github.com/tc39/proposal-import-meta/issues/13\" style=\"border: none;\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eこの issue はズバリ「\u003ccode\u003eimport.meta.url\u003c/code\u003e は文字列ではなく \u003ccode\u003eURL\u003c/code\u003e オブジェクトであるべきでは？」という趣旨のものだ。\u003c/p\u003e\n\u003cp\u003eそれに対して Domenic Denicola 氏が \u003ca href=\"https://url.spec.whatwg.org/#url-apis-elsewhere\"\u003eWHATWG の URL の仕様を参照して\u003c/a\u003e回答している。\u003c/p\u003e\n\u003cp\u003e参照された URL の仕様を読むと次のように書かれている。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA standard that exposes URLs, should expose the URL as a string (by serializing an internal URL). A standard should not expose a URL using a URL object. URL objects are meant for URL manipulation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e要約すると「\u003ccode\u003eURL\u003c/code\u003e オブジェクトは URL を操作するためのものなので、標準が URL を公開するときは \u003ccode\u003eURL\u003c/code\u003e オブジェクトではなく文字列として公開するべきである。」ということである。\u003c/p\u003e\n\u003cp\u003eつまり、\u003ccode\u003eimport.meta.url\u003c/code\u003e が文字列として提供されている理由は、\u003cstrong\u003eURL の仕様に「URL を提供するときは \u003ccode\u003eURL\u003c/code\u003e オブジェクトではなく文字列として提供するべき」と記述されているから\u003c/strong\u003eということになる。\u003c/p\u003e\n\u003ch2\u003e最後に\u003c/h2\u003e\n\u003cp\u003eなぜ URL の仕様にそのような記述があるのか、という根本的な理由はわからなかった。\u003c/p\u003e\n\u003cp\u003e仕様によれば\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eURL objects are meant for URL manipulation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eとのことなので、単純に用途と異なるからということなのだろうが、直感的には「別に \u003ccode\u003eURL\u003c/code\u003e オブジェクトとして提供されていてもいいんじゃなかろうか」とも思う。\u003c/p\u003e\n\u003cp\u003eより詳しい背景を知っている人がいたら教えてほしい。\u003c/p\u003e\n\u003ch2\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTC39\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-import-meta\"\u003etc39/proposal-import-meta: import.meta proposal for JavaScript\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-import-meta/issues/13\"\u003eIssues · tc39/proposal-import-meta\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWHATWG\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://url.spec.whatwg.org/\"\u003eURL Standard\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://html.spec.whatwg.org/\"\u003eHTML Standard\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","metaData":{"title":"なぜ import.meta.url は URL オブジェクトではなく文字列なのか","author":"sosukesuzuki","createdAt":"2022-07-26","summary":"なぜ import.meta.url は URL オブジェクトではなく文字列なのか","tags":["ECMAScript","HTML","URL"],"updatedAt":"2022-07-26"}}],"tag":"HTML"},"__N_SSG":true},"page":"/tags/[tag]","query":{"tag":"HTML"},"buildId":"iynSChS7iaz43C6uR7NMp","assetPrefix":"/frontend-expert","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>